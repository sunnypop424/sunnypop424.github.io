{"version":3,"file":"static/js/299.51ce2a36.chunk.js","mappings":"uQAiBA,MAAMA,EAAc,CAAEC,KAAM,EAAGC,OAAQ,GAAIC,MAAO,GAAIC,QAAS,IACzDC,EAAkB,CACtBJ,KAAM,CAAC,IACPC,OAAQ,CAAC,GAAI,IACbC,MAAO,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,IAC5BC,QAAS,CAAC,GAAI,GAAI,GAAI,GAAI,GAAI,KAE1BE,EAAa,CAAEL,KAAM,eAAMC,OAAQ,eAAMC,MAAO,eAAMC,QAAS,gBAC/DG,EAAS,CAAC,OAAQ,SAAU,QAAS,WACrCC,EAAgB,CACpBC,IAAK,qBACLC,IAAK,4BACLC,KAAM,4BACNC,MAAO,qBACPC,QAAS,yCACTC,QAAS,0CAELC,EAAU,CAAC,MAAO,MAAO,OAAQ,QAAS,UAAW,WACrDC,EAAY,CAChBC,OAAQ,IAAIC,IAAI,CAAC,MAAO,MAAO,SAC/BC,QAAS,IAAID,IAAI,CAAC,QAAS,UAAW,aAElCE,EAAkB,CAAEX,IAAK,EAAGC,IAAK,EAAGC,KAAM,EAAGC,MAAO,EAAGC,QAAS,EAAGC,QAAS,GAC5EO,EAAkB,CACtB,CAAEC,MAAO,sBAAQC,MAAO,uBACxB,CAAED,MAAO,sBAAQC,MAAO,uBACxB,CAAED,MAAO,sBAAQC,MAAO,wBAGpBC,EAAiB,CACrBC,MAAO,eACPC,MAAO,gBAEHC,EAAS,uBAETC,EAAa,CAAC,sBAAQ,sBAAQ,uBAKpC,MAAMC,EAAMA,IAAMC,KAAKC,SAASC,SAAS,IAAIC,MAAM,EAAG,GACtD,SAASC,EAAgBC,GACvB,MAAMC,EAAO,IAAKhB,GAClB,OAAKe,GACLE,OAAOC,KAAKF,GAAMG,QAASC,IACzB,MAAMC,EAAMN,EAAEK,GACRE,EAAqB,kBAARD,EAAmBA,EAAME,OAAOF,GACnDL,EAAKI,GAAKG,OAAOC,SAASF,IAAQA,GAAO,EAAIA,EAAMtB,EAAgBoB,KAEvCJ,GANfA,CAOjB,CACA,SAASS,EAAgBC,EAAGC,EAAMZ,GAAI,IAADa,EAAAC,EACnC,GAAY,MAARF,EAAc,OAAO,EACzB,MAAMT,EAAgB,WAATS,EAAoB/B,EAAUC,OAASD,EAAUG,QAG9D,OAFWmB,EAAKY,IAAIJ,EAAEK,KAAOL,EAAEM,KAAe,QAAZJ,EAAIb,EAAEW,EAAEK,YAAI,IAAAH,EAAAA,EAAI,GAAK,IAC5CV,EAAKY,IAAIJ,EAAEO,KAAOP,EAAEQ,KAAe,QAAZL,EAAId,EAAEW,EAAEO,YAAI,IAAAJ,EAAAA,EAAI,GAAK,EAEzD,CACA,SAAUM,EAAaC,EAAKhB,GAC1B,MAAMiB,EAAID,EAAIE,OAAQ,GAAIlB,EAAIiB,EAAG,OACjC,MAAME,EAAMC,MAAMC,KAAK,CAAEH,OAAQlB,GAAK,CAACsB,EAAGC,IAAMA,GAChD,OAAa,OACLJ,EAAIK,IAAID,GAAKP,EAAIO,IACvB,IAAIE,EAAIzB,EAAI,EAAG,KAAOyB,GAAK,GAAKN,EAAIM,KAAOR,EAAIjB,EAAIyB,GAAGA,IAAK,GAAIA,EAAI,EAAG,MAAON,EAAIM,KAAM,IAAK,IAAIC,EAAID,EAAI,EAAGC,EAAI1B,EAAG0B,IAAKP,EAAIO,GAAKP,EAAIO,EAAI,GAAK,CAC/I,CACF,CACA,SAASC,EAAcC,EAAOC,GAE5B,OADWhE,EAAgB+D,GACjBE,OAAOC,GAAKF,GAAcE,EACtC,CACA,SAASC,EAAWC,EAAOL,EAAOrB,EAAM2B,GACtC,MAAMC,EAAYF,EAAMG,OAAO,CAACC,EAAG/B,KAAC,IAAAgC,EAAA,OAAKD,GAAY,QAAXC,EAAKhC,EAAEiC,YAAI,IAAAD,EAAAA,EAAI,IAAK,GACxDT,EAAaI,EAAMG,OAAO,CAACC,EAAG/B,KAAC,IAAAkC,EAAA,OAAKH,GAAa,QAAZG,EAAKlC,EAAEmC,aAAK,IAAAD,EAAAA,EAAI,IAAK,GAC1DE,EAAMf,EAAcC,EAAOC,GAC3Bc,EAAUV,EAAMG,OAAO,CAACC,EAAG/B,IAAM+B,EAAIhC,EAAgBC,EAAGC,EAAM2B,GAAU,GAE9E,MAAO,CAAEC,YAAWN,aAAYa,MAAKC,UAASC,MADlB,IAAbF,EAAIxB,OAAqC,IAAbW,EAA8C,IAArB,IAAQM,GAAmBQ,EAAUV,EAAMf,OAEjH,CAoCA,SAAS2B,EAA0BC,EAAOC,EAAMxC,EAAM2B,GAA8B,IAArBc,EAAYC,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,IAC5E,MAAME,EAAIzD,EAAgBwC,GAEpBkB,EAASxB,GAAUtC,KAAK+D,OADRzB,IAAU/D,EAAgB+D,GACX0B,CAAa1B,IAC5C2B,EAAUC,IAAE,IAAAC,EAAA,OAAQ,OAAFD,QAAE,IAAFA,GAAO,QAALC,EAAFD,EAAId,WAAG,IAAAe,GAAPA,EAASvC,OAAS5B,KAAKoE,OAAOF,EAAGd,KAAO,GAE1DiB,EAAY,CAAEC,KAAM,GAAIzB,UAAW,EAAGN,WAAY,EAAGa,IAAK,GAAIC,QAAS,EAAGC,MAAO,GAGjF3D,EAAQ6D,EAAMtB,IAAI,CAACF,EAAGC,IAAMA,GAC5BsC,EAAcf,EAAMtB,IAAI,CAACsC,EAAGvC,IAAOuC,EAAEC,WAAaxC,GAAK,GAAIO,OAAOP,IAAY,IAAPA,GAEvEyC,EAAgBA,CAACC,EAAMC,KAC3B,MAAMlD,EA/CV,SAA6B+B,EAAMnB,EAAOrB,EAAM2B,EAASiC,EAAcJ,GACrE,MAAMK,EAAS5G,EAAYoE,GACrBuB,EAAIzD,EAAgBwC,GACpBmC,EAAa/E,KAAK+D,OAAOxF,EAAgB+D,IACzC0C,EAAqB,OAAZH,QAAY,IAAZA,EAAAA,EAAgBE,EACzBE,EAAaR,GAA8B,MAAhBI,EAE3BK,EAAM,GACNC,EAAUnF,KAAK+D,IAAI,EAAGN,EAAK7B,QACjC,IAAK,IAAIlB,EAAI,EAAGA,GAAKyE,EAASzE,IAC5B,GAAU,IAANA,EACJ,IAAK,MAAMiC,KAASlB,EAAagC,EAAM/C,GAAI,CACzC,MAAMmC,EAAYF,EAAMG,OAAO,CAACC,EAAG/B,IAAM+B,GAAK/B,EAAEiC,MAAQ,GAAI,GAC5D,GAAIJ,EAAYiC,EAAQ,SACxB,MAAM,WAAEvC,EAAU,IAAEa,EAAG,QAAEC,EAAO,MAAEC,GAAUZ,EAAWC,EAAOL,EAAOrB,EAAM4C,GAC3EqB,EAAIE,KAAK,CAAEd,KAAM3B,EAAOE,YAAWN,aAAYa,MAAKC,UAASC,SAC/D,MANe4B,EAAIE,KAAK,CAAEd,KAAM,GAAIzB,UAAW,EAAGN,WAAY,EAAGa,IAAK,GAAIC,QAAS,EAAGC,MAAO,IAS/F,IAAI+B,EASJ,OAVAH,EAAII,KAAK,CAACC,EAAGC,IAAMA,EAAElC,MAAQiC,EAAEjC,OAG7B+B,EADEJ,EACSC,EAAI1C,OAAO0B,IACpB,MAAMuB,EAASzF,KAAKoE,IAAI,KAAMF,EAAGd,KACjC,OAAOc,EAAGI,KAAK1C,OAAS,GAAK6D,IAAiB,OAANT,QAAM,IAANA,EAAAA,EAAU,KAGzCE,EAAI1C,OAAO0B,GAAMA,EAAGI,KAAK1C,OAAS,GAAKsC,EAAGd,IAAIxB,OAAS,GAE5C,IAApByD,EAASzD,OACJ,CAAC,CAAE0C,KAAM,GAAIzB,UAAW,EAAGN,WAAY,EAAGa,IAAK,GAAIC,QAAS,EAAGC,MAAO,IAExE+B,CACT,CAegBK,CAAoBd,EAASD,EAAKrC,MAAOrB,EAAM4C,OAAGD,GAAW,GACtEpB,OAAO0B,GAAMA,EAAGI,KAAK1C,OAAS,GAAKsC,EAAGd,IAAIxB,OAAS,GAQtD,OAPAF,EAAI4D,KAAK,CAACC,EAAGC,KACX,MAAMG,EAAK1B,EAAOsB,GAAIK,EAAK3B,EAAOuB,GAClC,OAAIG,IAAOC,EAAWA,EAAKD,EACvBJ,EAAEhD,aAAeiD,EAAEjD,WAAmBiD,EAAEjD,WAAagD,EAAEhD,WACvDgD,EAAElC,UAAYmC,EAAEnC,QAAgBmC,EAAEnC,QAAUkC,EAAElC,QAC3CkC,EAAE1C,UAAY2C,EAAE3C,YAElBnB,EAAIvB,MAAM,EAAGH,KAAKoE,IAAIV,EAAc,OAGvCmC,EAAgBlG,EAAMuC,IAAID,GAAKyC,EAAclB,EAAMvB,GAAIwB,IAkB7D,SAASqC,EAASC,GAAqC,IAAzBC,EAAUrC,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,IAAIvE,IACzC6G,EAAO,KACX,MAAMC,EAAO,IAAI9G,IAsGjB,OApGA,SAAS+G,EAAUC,EAAKC,EAAUC,EAAWC,EAAaC,EAAYC,EAAYC,EAAQC,GAAQ,IAADC,EAC/F,GAAIR,IAAQzG,EAAMiC,OAAQ,CAExB,IAAK,MAAMC,KAAOkE,EAAY,CAAC,IAADc,EAC5B,MAAM7B,EAAiC,QAA3B6B,EAAIrD,EAAM3B,GAAKgD,oBAAY,IAAAgC,EAAAA,EAAI/C,EAAMN,EAAM3B,GAAKS,OAE5D,GADU2B,EAAOoC,EAASxE,IAClBmD,EAAQ,MAClB,CACA,MAAM8B,EAAO,CACXC,MAAOV,EAASnE,IAAI8E,GAAKA,GACzBC,OAAQX,EACRY,SAAUX,EACVY,QAASX,EACTnD,QAASoD,EACTC,OAAQA,EAAOvG,QACfwG,MAAOA,EAAMxG,SAGf,YAtCN,SAAoBiH,EAAGC,GACrB,IAAKA,EAAG,OAAO,EACf,GAAID,EAAEH,SAAWI,EAAEJ,OAAQ,OAAOG,EAAEH,OAASI,EAAEJ,OAC/C,IAAK,IAAIhF,EAAI,EAAGA,EAAImF,EAAEV,OAAO9E,OAAQK,IACnC,GAAImF,EAAEV,OAAOzE,KAAOoF,EAAEX,OAAOzE,GAAI,OAAOmF,EAAEV,OAAOzE,GAAKoF,EAAEX,OAAOzE,GAEjE,GAAImF,EAAEF,WAAaG,EAAEH,SAAU,OAAOE,EAAEF,SAAWG,EAAEH,SACrD,IAAK,IAAIjF,EAAI,EAAGA,EAAImF,EAAET,MAAM/E,OAAQK,IAClC,GAAImF,EAAET,MAAM1E,KAAOoF,EAAEV,MAAM1E,GAAI,OAAOmF,EAAET,MAAM1E,GAAKoF,EAAEV,MAAM1E,GAE7D,OAAImF,EAAE/D,UAAYgE,EAAEhE,QAAgB+D,EAAE/D,QAAUgE,EAAEhE,QAC9C+D,EAAED,UAAYE,EAAEF,SAAgBC,EAAED,QAAUE,EAAEF,OAEpD,CAwBUG,CAAWR,EAAMb,KAAOA,EAAOa,GAErC,CAEA,MAAMS,EAAU5H,EAAMyG,GAChBoB,EAAQzB,EAAW3E,IAAImG,GACvBvC,EAASwC,EAAoC,QAA/BZ,EAAIpD,EAAM+D,GAAS1C,oBAAY,IAAA+B,EAAAA,EAAI9C,EAAMN,EAAM+D,GAASjF,QAAWmF,IAGvF,GAAIzB,EAAW5E,IAAImG,GAWjB,YAVApB,EACEC,EAAM,EACNC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,GAKJ,MAAMe,EAAW7B,EAAcO,GAG/B,IAAK,MAAMuB,KAAQD,EAAU,CAC3B,MAAMjF,EAAIwB,EAAO0D,GACjB,GAAIH,GAAS/E,EAAIuC,EAAQ,SAGzB,IAAI4C,GAAQ,EACZ,IAAK,MAAM5G,KAAK2G,EAAKrD,KAAQ,GAAI4B,EAAK9E,IAAIJ,EAAE6G,IAAK,CAAED,GAAQ,EAAM,KAAO,CACxE,GAAIA,EAAO,SAEXD,EAAKrD,KAAK7D,QAAQO,GAAKkF,EAAKtH,IAAIoC,EAAE6G,KAClC,MAAMC,EAAOzB,EAASkB,GACtBlB,EAASkB,GAAWI,EAEpBjB,EAAON,GAAO3D,EACdkE,EAAMP,GAAQuB,EAAKpF,WAEnB4D,EACEC,EAAM,EACNC,EACAC,EAAc7D,EACd8D,EAAcoB,EAAKpF,WACnBiE,EAAcmB,EAAK9E,UACnB4D,EAAckB,EAAKtE,QACnBqD,EACAC,GAIFgB,EAAKrD,KAAK7D,QAAQO,GAAKkF,EAAK6B,OAAO/G,EAAE6G,KACrCxB,EAASkB,GAAWO,EACpBpB,EAAON,GAAO,EACdO,EAAMP,GAAQ,CAChB,CAGKoB,GACHrB,EACEC,EAAM,EACNC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAGN,CAEAR,CACE,EACA3C,EAAMtB,IAAI,IAAMmC,GAChB,EAAG,EAAG,EAAG,EACTvC,MAAMnC,EAAMiC,QAAQoG,KAAK,GACzBlG,MAAMnC,EAAMiC,QAAQoG,KAAK,IAGpB/B,CACT,CAGA,MAAMgC,EAAkB,IAAI7I,IAAImF,GAC1B2D,EAAWpC,EAASmC,GAC1B,GAAIC,EACF,MAAO,CAAEnB,MAAOmB,EAASnB,OAO3B,GAAIpH,EAAMiC,OAAS,EAAG,CACpB,MAAMuG,EAAYxI,EAAMA,EAAMiC,OAAS,GAEjCwG,EAAiBtC,EADK,IAAI1G,IAAI,IAAI6I,GAAiBzF,OAAOP,GAAKA,IAAMkG,IACtB,IAAI/I,IAAI,CAAC+I,KAC9D,GAAIC,EAAgB,CAGlB,MAAO,CAAErB,MADUqB,EAAerB,MAAM7E,IAAI,CAACC,EAAGF,IAAOA,IAAMkG,EAAY9D,EAAalC,GAAKkC,GAE7F,CACF,CAIA,MAAMgE,EAAqB,IAAIjJ,IAC/B,IAAK,MAAMyC,KAAO0C,EAAa,CAAC,IAAD+D,EAC7B,MAAMtD,EAAiC,QAA3BsD,EAAI9E,EAAM3B,GAAKgD,oBAAY,IAAAyD,EAAAA,EAAIxE,EAAMN,EAAM3B,GAAKS,OACtD8D,EAAMzG,EAAM4I,QAAQ1G,IACLgE,EAAcO,IAAQ,IAAIoC,KAAKtE,GAAMD,EAAOC,IAAOc,IACtDqD,EAAmBzJ,IAAIiD,EAC3C,CAGA,MACM4G,EAAc3C,EADO,IAAI1G,IAAImF,EAAY/B,OAAOP,IAAMoG,EAAmBjH,IAAIa,MAGnF,GAAIwG,EAAa,CAGf,MAAO,CAAE1B,MADU0B,EAAY1B,MAAM7E,IAAI,CAACC,EAAGF,IAAOoG,EAAmBjH,IAAIa,GAAKoC,EAAalC,GAAKkC,GAEpG,CAGA,MAAO,CAAE0C,MAAOvD,EAAMtB,IAAI,IAAMmC,GAClC,CAKA,SAASqE,EAAmBZ,EAAM7G,GAChC,MAAM0H,EAAO,IAAKb,IAEO,WAAT7G,EAAoB/B,EAAUG,QAAUH,EAAUC,QAC1DsB,QAASC,IACfiI,EAAKjI,GAAK,IAOZ,OAJexB,EAAU+B,GAClBR,QAASC,IACdiI,EAAKjI,GAAK,IAELiI,CACT,CACA,SAASC,IACP,IACE,MAAMjI,EAAMkI,aAAaC,QAAQjJ,GACjC,OAAKc,EACEoI,KAAKC,MAAMrI,GADD,IAEnB,CAAE,MAAOsI,GAEP,OADAC,QAAQC,KAAK,uBAAwBF,GAC9B,IACT,CACF,CASA,MAAMG,EAAiC,qBAAbC,SAA2BA,SAASC,KAAO,KACrE,SAASC,EAAoBC,GAAoC,IAAnC,YAAEC,EAAW,MAAEC,EAAK,SAAEC,GAAUH,EAC5D,OACEI,EAAAA,EAAAA,KAACC,EAAAA,GAAS,CAACJ,YAAaA,EAAaC,MAAOA,EAAMC,SAC/CA,CAACG,EAAUC,KAEV,MAAMC,EACgB,oBAAbL,EAA0BA,EAASG,EAAUC,GAAYJ,EAClE,OAAOI,EAASE,YAAcb,GAC1Bc,EAAAA,EAAAA,cAAaF,EAAUZ,GACvBY,IAIZ,CAqBA,SAASG,EAAQC,GAAsD,IAArD,MAAE5K,EAAK,MAAE6K,EAAK,SAAEC,EAAQ,YAAEC,EAAW,UAAEC,GAAWJ,EAClE,MAAOK,EAAMC,IAAWC,EAAAA,EAAAA,WAAS,GAC3BC,GAASC,EAAAA,EAAAA,QAAO,MAChBC,GAAUD,EAAAA,EAAAA,QAAO,MACjBE,GAAUF,EAAAA,EAAAA,QAAO,CAAEG,IAAK,EAAGC,KAAM,EAAGC,MAAO,KAC1C,CAAEC,IAAaR,EAAAA,EAAAA,UAAS,IAE/BS,EAAAA,EAAAA,WAAU,KACR,MAAMC,EAAIA,IAAMX,GAAQ,GAExB,OADAY,OAAOC,iBAAiB,sBAAuBF,GACxC,IAAMC,OAAOE,oBAAoB,sBAAuBH,IAC9D,IA9BL,SAA2BI,EAAMC,GAC/B,MAAMC,EAAYC,EAAAA,QAChB,IAAO9J,MAAM+J,QAAQJ,GAAQA,EAAO,CAACA,GAErC,CAACA,IAGGK,EAAaF,EAAAA,OAAaF,GAChCE,EAAAA,UAAgB,KAAQE,EAAWC,QAAUL,GAAY,CAACA,IAC1DE,EAAAA,UAAgB,KACd,MAAMI,EAAY/C,IAAO,IAADgD,EAClBN,EAAUnD,KAAK0D,IAAM,OAADA,QAAC,IAADA,OAAC,EAADA,EAAGH,UAAWG,EAAEH,QAAQI,SAASlD,EAAEmD,UACzC,QAAlBH,EAAAH,EAAWC,eAAO,IAAAE,GAAlBA,EAAAI,KAAAP,EAAqB7C,IAIvB,OADAI,SAASkC,iBAAiB,QAASS,GAAU,GACtC,IAAM3C,SAASmC,oBAAoB,QAASQ,GAAU,IAC5D,CAACL,GACN,CAcEW,CAAkB,CAAC1B,EAAQE,GAAU,IAAMJ,GAAQ,KAEnD6B,EAAAA,EAAAA,iBAAgB,KACd,IAAK9B,IAASG,EAAOmB,QAAS,OAC9B,MAAMS,EAAO5B,EAAOmB,QAAQU,wBAC5B1B,EAAQgB,QAAU,CAChBf,IAAKwB,EAAKE,OAAS,EACnBzB,KAAMuB,EAAKvB,KACXC,MAAOsB,EAAKtB,OAEdC,EAAWwB,GAAMA,EAAI,GACrB,MAAMC,EAAWA,KAAO,IAADC,EACrB,MAAMX,EAAkB,QAAjBW,EAAGjC,EAAOmB,eAAO,IAAAc,OAAA,EAAdA,EAAgBJ,wBACrBP,IACLnB,EAAQgB,QAAU,CAChBf,IAAKkB,EAAEQ,OAAS,EAChBzB,KAAMiB,EAAEjB,KACRC,MAAOgB,EAAEhB,OAEXC,EAAWwB,GAAMA,EAAI,KAIvB,OAFArB,OAAOC,iBAAiB,SAAUqB,EAAU,CAAEE,SAAS,IACvDxB,OAAOC,iBAAiB,SAAUqB,GAC3B,KACLtB,OAAOE,oBAAoB,SAAUoB,GACrCtB,OAAOE,oBAAoB,SAAUoB,KAEtC,CAACnC,IACJ,MAAMsC,EAAW1C,EAAM2C,KAAM/K,GAAMA,EAAEzC,QAAUA,GACzCyN,EAAOxC,GACXb,EAAAA,EAAAA,KAACsD,EAAAA,EAAe,CAAAvD,UACdC,EAAAA,EAAAA,KAACuD,EAAAA,EAAOC,GAAE,CACRC,IAAKvC,EAELwC,QAAS,CAAEC,QAAS,EAAGC,GAAI,GAC3BC,QAAS,CAAEF,QAAS,EAAGC,EAAG,GAC1BE,KAAM,CAAEH,QAAS,EAAGC,GAAI,GACxBG,WAAY,CAAEC,SAAU,KACxBC,MAAO,CACLC,SAAU,QACV9C,IAAKD,EAAQgB,QAAQf,IACrBC,KAAMF,EAAQgB,QAAQd,KACtBC,MAAOH,EAAQgB,QAAQb,MACvB6C,OAAQ,MAEVvD,UAAU,8DAA6Db,SAEtEU,EAAMnI,IAAK8L,IACVpE,EAAAA,EAAAA,KAAA,MAAAD,UACEC,EAAAA,EAAAA,KAAA,UACEqE,KAAK,SACLC,QAASA,KACHF,EAAGG,WACP7D,EAAS0D,EAAGxO,OACZkL,GAAQ,KAEV,kBAAesD,EAAGG,eAAkBvK,EACpC4G,UAAW,sCAAsCwD,EAAGG,SAAW,gCAAkC,sBAC3FH,EAAGxO,QAAUA,EAAQ,cAAgB,KAAKmK,UAEhDC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,iBAAgBb,SAAEqE,EAAGvO,WAZhC2O,OAAOJ,EAAGxO,UAfjB,UAiCN,KACJ,OACE6O,EAAAA,EAAAA,MAAA,OAAKhB,IAAKzC,EAAQJ,UAAW,oBAAoBA,GAAa,KAAKb,SAAA,EACjE0E,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,IAAMxD,EAASiC,IAAOA,GAC/BnC,UAAU,mLAAkLb,SAAA,EAE5LC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAC/BoD,EAAWA,EAAStN,MAAQ8K,GAAe,kBAE9CX,EAAAA,EAAAA,KAAA,QAAMY,UAAU,oCAAmCb,SAChDc,GAAOb,EAAAA,EAAAA,KAAC0E,EAAAA,EAAS,CAACC,KAAM,MAAS3E,EAAAA,EAAAA,KAAC4E,EAAAA,EAAW,CAACD,KAAM,UAGxD9D,IAAQP,EAAAA,EAAAA,cAAa+C,EAAM5D,SAASC,QAG3C,CAWA,SAASmF,EAAUC,GAAuB,IAAtB,OAAEC,EAAM,QAAEC,GAASF,EACrC,OACE9E,EAAAA,EAAAA,KAAA,OAAKY,UAAU,mFAAkFb,UAC/FC,EAAAA,EAAAA,KAACsD,EAAAA,EAAe,CAAAvD,SACbgF,EAAOzM,IAAIO,IACV4L,EAAAA,EAAAA,MAAClB,EAAAA,EAAO0B,IAAG,CAAYvB,QAAS,CAAEC,QAAS,EAAGuB,MAAO,KAAQrB,QAAS,CAAEF,QAAS,EAAGuB,MAAO,GAAKpB,KAAM,CAAEH,QAAS,EAAGuB,MAAO,KAAQnB,WAAY,CAAEM,KAAM,SAAUc,UAAW,IAAKC,QAAS,IAAMxE,UAAU,6LAA4Lb,SAAA,EACpYC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,iBAAgBb,SAAElH,EAAEwM,OACnCrF,EAAAA,EAAAA,KAAA,UAAQY,UAAU,yEAAyE0D,QAASA,IAAMU,EAAQnM,EAAEoF,IAAK,aAAW,eAAI8B,SAAC,mBAF1HlH,EAAEoF,QAQ7B,CACA,SAASqH,EAAWC,GAUhB,IAViB,MACnB3P,EAAK,SACL8K,EAAQ,IACRvG,EAAG,IACHK,EAAG,KACHgL,EAAO,EAAC,WACRC,GAAa,EAAK,WAClBC,GAAa,EAAI,UACjB9E,EAAY,GAAE,WACd+E,EAAa,CAAC,GACfJ,EACC,MAAMK,EAAS7C,GAAa,OAANA,QAAoB/I,IAAN+I,EAAkB,GAAKyB,OAAOzB,IAC3D8C,EAAOC,GAAY9D,EAAAA,SAAe4D,EAAMhQ,IAC/CoM,EAAAA,UAAgB,KAAQ8D,EAASF,EAAMhQ,KAAY,CAACA,IACpD,MAMMmQ,EAAmB5M,IACvB,GAAU,KAANA,EAAU,OAAOuM,EAAiB,OAAHvL,QAAG,IAAHA,EAAAA,EAAO,EAAK,KAC/C,IAAIpC,EAAId,OAAOkC,GACf,OAAKlC,OAAOC,SAASa,IACrBA,EAAI0N,EAAa1N,EAAI3B,KAAK4P,MAAMjO,GAVnBA,KACb,IAAIqF,EAAIrF,EAGR,OAFW,MAAPoC,GAAeiD,EAAIjD,IAAKiD,EAAIjD,GACrB,MAAPK,GAAe4C,EAAI5C,IAAK4C,EAAI5C,GACzB4C,GAOA6I,CAAMlO,IAFmB2N,EAAiB,OAAHvL,QAAG,IAAHA,EAAAA,EAAO,EAAK,MAM5D,OACE6F,EAAAA,EAAAA,KAAA,SACEqE,KAAK,SACL6B,UAAWT,EAAa,UAAY,UACpCD,KAAMA,EACNrL,IAAKA,EACLK,IAAKA,EACL5E,MAAOiQ,EACPnF,SAAWrB,IACT,MAAM0D,EAAI1D,EAAEmD,OAAO5M,MACnB,GAAU,KAANmN,EAGF,OAFA+C,EAAS,SACD,OAARpF,QAAQ,IAARA,GAAAA,EAAW,OAIboF,EAAS/C,GACT,MAAM/L,EAAMC,OAAO8L,GACf9L,OAAOC,SAASF,GACV,OAAR0J,QAAQ,IAARA,GAAAA,EAAW+E,EAAazO,EAAMZ,KAAK4P,MAAMhP,IAEjC,OAAR0J,QAAQ,IAARA,GAAAA,EAAW,OAGfyF,OAAQA,KACN,MAAMpO,EAAIgO,EAAgBF,GAC1BC,EAAc,MAAL/N,EAAY,GAAKyM,OAAOzM,IACzB,OAAR2I,QAAQ,IAARA,GAAAA,EAAW3I,IAEbqO,QA9BiB/G,GAAMA,EAAEgH,cAAcC,OA+BvC1F,UAAWA,KACP+E,GAGV,CAEe,SAASY,KACtB/E,EAAAA,EAAAA,WAAU,KAAQ/B,SAAS+G,MAAQ,gFAAuB,IAE1D,MAAOC,EAAUC,IAAe3F,EAAAA,EAAAA,UAC9B,SAAA4F,EAAAC,EAAA,OAAkC,QAAlCD,EAAwB,QAAxBC,EAAO5H,WAAiB,IAAA4H,OAAA,EAAjBA,EAAmBH,gBAAQ,IAAAE,EAAAA,EAAI,WAGjCE,EAAYC,IAAiB/F,EAAAA,EAAAA,UAAS,KAAO,IAADgG,EACjD,MAAMC,EAAShI,IACf,OAAyB,QAAzB+H,EAAa,OAANC,QAAM,IAANA,OAAM,EAANA,EAAQH,kBAAU,IAAAE,EAAAA,EAAI,CAAEhR,MAAO,GAAIC,MAAO,OAE5CiR,EAAWC,IAAgBnG,EAAAA,EAAAA,UAAS,KAAO,IAADoG,EAC/C,MAAMH,EAAShI,IACf,OAAwB,QAAxBmI,EAAa,OAANH,QAAM,IAANA,OAAM,EAANA,EAAQC,iBAAS,IAAAE,EAAAA,EAAI,CAAEpR,MAAO,GAAIC,MAAO,OAG3CqB,EAAM+P,IAAWrG,EAAAA,EAAAA,UAAiC,OAClD/H,EAASqO,IAActG,EAAAA,EAAAA,UAAS,IAAKrL,KACrC4R,EAAiBC,IAAsBxG,EAAAA,EAAAA,UAAS,OAChDyG,EAAgBC,IAAqB1G,EAAAA,EAAAA,UAAS,OAC/C,OAAEgE,EAAM,KAAEvJ,EAAI,OAAEkM,GA7GxB,WACE,MAAO3C,EAAQ4C,IAAa5G,EAAAA,EAAAA,UAAS,IAOrC,MAAO,CAAEgE,SAAQvJ,KANH6J,IACZ,MAAMpH,EAAK9H,IACXwR,EAAU9O,GAAK,IAAIA,EAAG,CAAEoF,KAAIoH,SAC5BuC,WAAW,IAAMD,EAAU9O,GAAKA,EAAED,OAAOwE,GAAKA,EAAEa,KAAOA,IAAM,OAGxCyJ,OADPzJ,GAAO0J,EAAU9O,GAAKA,EAAED,OAAOwE,GAAKA,EAAEa,KAAOA,IAE/D,CAoGmC4J,IAE1BC,EAAaC,IAAkBhH,EAAAA,EAAAA,UAAS,IACxCiH,EAAWC,IAAgBlH,EAAAA,EAAAA,WAAS,IACpCmH,EAAOC,KAAYpH,EAAAA,EAAAA,WAAS,IAC5BqH,GAAeC,KAAoBtH,EAAAA,EAAAA,UAAS,IAE7CnH,GAAQiN,EAAWJ,GACnB6B,GAAOrB,EAAUR,GAEjB8B,GAAYC,IAChB1B,EAAe5I,IACb,MAAMa,EAA0B,oBAAZyJ,EAAyBA,EAAQtK,EAAKuI,IAAa+B,EAEvE,OADAL,IAAS,GACF,IAAKjK,EAAM,CAACuI,GAAW1H,MAG5B0J,GAAWD,IACftB,EAAchJ,IACZ,MAAMa,EAA0B,oBAAZyJ,EAAyBA,EAAQtK,EAAKuI,IAAa+B,EAEvE,OADAL,IAAS,GACF,IAAKjK,EAAM,CAACuI,GAAW1H,OAGlCyC,EAAAA,EAAAA,WAAU,KAAQ2G,IAAS,IAAU,CAAC9Q,EAAM2B,EAASyN,KAcrDjF,EAAAA,EAAAA,WAAU,KACR,GAAoB,IAAhBsG,EAAmB,OACvB,IAAIY,GAAY,EAChBT,GAAa,GAEb,MAAMhK,EAAK2J,WAAW,KACpB,IAEE,MAAM9N,EACJwO,GAAKtQ,OAAS,GAAK,IACnBsQ,GAAKtQ,OAAS,GAAK,IACnBsQ,GAAKtQ,OAAS,GAAK,IAAM,KACrB,MAAEmF,GAAUxD,EAA0BC,GAAO0O,GAAMjR,EAAM2B,EAASc,GACnE4O,IACHL,GAAiBlL,GAAS,IAC1BgL,IAAS,GAEb,CAAC,QACMO,GAAWT,GAAa,EAC/B,GACC,GACH,MAAO,KAAQS,GAAY,EAAMC,aAAa1K,KAG7C,CAAC6J,IACJ,MAUMc,GAAYA,CAAC3K,EAAI4K,IAAUJ,GAAQ1F,GAAKA,EAAEzK,IAAIlB,GAAKA,EAAE6G,KAAOA,EAAK,IAAK7G,KAAMyR,GAAUzR,IAiBtF0R,GAAaA,CAAC7K,EAAI4K,IAAUN,GAASQ,IACzC,GAAI,SAAUF,EAAO,CAEnB,GADYE,EAAGnK,KAAKhE,GAAKA,EAAEqD,KAAOA,GAAMrD,EAAEoO,OAASH,EAAMG,MAGvD,OADAxN,EAAK,GAAGqN,EAAMG,mFACPD,CAEX,CACA,OAAOA,EAAGzQ,IAAIsC,GAAKA,EAAEqD,KAAOA,EAAK,IAAKrD,KAAMiO,GAAUjO,MAGjDqO,GAAUC,KAAenI,EAAAA,EAAAA,WAAS,GAmBnCoI,GAAiB,+FACjBC,GAAe,4CACfC,GAAO,iCACPC,GAAO,8DACPC,GAAW,mCAEXC,GAAoBvR,GAAQA,EAAM,EAClCwR,GAAkBA,CAACxR,EAAKyR,IAAUA,EAAQzR,EA+BhD,OA7BAuJ,EAAAA,EAAAA,WAAU,MACR,WACE,IAAK,IAADmI,EACF,MAAMlT,EAAID,EAAgB,CAAEzB,IAAK,EAAGC,IAAK,IAAKC,MAAO,IACrDqK,QAAQsK,OAAiB,IAAVnT,EAAE1B,KAAuB,IAAV0B,EAAEzB,KAAwB,IAAXyB,EAAExB,KAAY,0BAC3D,MAAM4U,EAAM,CAAE5L,GAAI,KAAM5E,KAAM,EAAGE,MAAO,EAAG9B,IAAK,MAAOC,IAAK,EAAGC,IAAK,QAASC,IAAK,GAClF0H,QAAQsK,OAAOzS,EAAgB0S,EAAK,SAAUpT,KAAO,EAAIA,EAAE1B,IAAK,iCAChEuK,QAAQsK,OAAOzS,EAAgB0S,EAAK,UAAWpT,KAAO,GAAY,QAAXkT,EAAIlT,EAAEvB,aAAK,IAAAyU,EAAAA,EAAI,GAAI,kCAC1ErK,QAAQsK,OAAOnR,EAAc,QAAS,IAAIqR,SAAS,KAA4C,IAArCrR,EAAc,QAAS,GAAGT,OAAc,wBAClG,MAAM+R,EAAKjR,EAAW,CAAC+Q,GAAM,QAAS,SAAUpT,GAC1CuT,EAAKlR,EAAW,CAAC+Q,EAAK,IAAKA,EAAK5L,GAAI,KAAM5E,KAAM,EAAGE,MAAO,KAAO,QAAS,SAAU9C,GAC1F6I,QAAQsK,OAAOI,EAAGtQ,OAASqQ,EAAGrQ,MAAO,kCACrC4F,QAAQ2K,IAAI,2BACd,CAAE,MAAO5K,GACPC,QAAQC,KAAK,yCAAqCF,EACpD,CACF,CACA6K,IACC,KACH1I,EAAAA,EAAAA,WAAU,MA9YZ,SAAuB2I,GACrB,IACElL,aAAamL,QAAQnU,EAAQkJ,KAAKkL,UAAUF,GAC9C,CAAE,MAAO9K,GACPC,QAAQC,KAAK,qBAAsBF,EACrC,CACF,CAyYIiL,CAAc,CACZ7D,WACAI,aACAI,YAEA5P,OACA2B,aAED,CAACyN,EAAUI,EAAYI,EAAW5P,EAAM2B,KAEzCyL,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wCAAwCqD,MAAO,CAC5DsG,gBAAiB,4CACjBC,qBAAsB,SACtBzK,SAAA,EAEAC,EAAAA,EAAAA,KAAA,SAAAD,SAAQ,+VAQRC,EAAAA,EAAAA,KAAA,SAAAD,SAAQ,4BACR0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,2CAA0Cb,SAAA,EAEvDC,EAAAA,EAAAA,KAAA,WAASY,UAAU,eAAcb,UAC/B0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oDAAmDb,SAAA,EAChEC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,+GAA8Gb,SAAC,wFAI7H0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oCAAmCb,SAAA,EAEhDC,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IAAMoC,EAAY,SAC3B9F,UAAW,8EAA0F,UAAb6F,EAAuB,WAAa,eAC5HD,MAAM,wCAASzG,SAEdjK,EAAeC,SAElBiK,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IAAMoC,EAAY,SAC3B9F,UAAW,8EAA0F,UAAb6F,EAAuB,WAAa,eAC5HD,MAAM,wCAASzG,SAEdjK,EAAeE,iBAMxByO,EAAAA,EAAAA,MAAA,WAAS7D,UAAW,GAAGyI,uBAAyBJ,GAAW,GAAK,kBAAkBlJ,SAAA,EAChF0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,mCAAkCb,SAAA,EAC/C0E,EAAAA,EAAAA,MAAA,MAAI7D,UAAWwI,GAAarJ,SAAA,CAAEjK,EAAe2Q,GAAU,iCACvDzG,EAAAA,EAAAA,KAAA,OAAKY,UAAU,oDAAmDb,UAChE0E,EAAAA,EAAAA,MAAA,UAAQ7D,UAAU,2IAA2I0D,QAnIzJmG,IAAMlC,GAASQ,IAC7B,GAAIA,EAAG/Q,QAAU,EAAqC,OAAhCwD,EAAK,qGAAkCuN,EAC7D,MACM2B,EAnnBV,SAA+BC,GAC7B,IAAK,MAAM5S,KAAK7B,EAAY,IAAKyU,EAAcnT,IAAIO,GAAI,OAAOA,EAC9D,OAAO,IACT,CAgnBqB6S,CADA,IAAIpV,IAAIuT,EAAGzQ,IAAIsC,GAAKA,EAAEoO,QAEvC,IAAK0B,EAA4C,OAAhClP,EAAK,qGAAkCuN,EACxD,MAAM9K,EAAK9H,IAEX,OADAoR,EAAmBtJ,GACZ,CACL,CAAEA,KAAI+K,KAAM0B,EAAUhS,MAAO,QAASuC,kBAAcjB,EAAWa,YAAY,MACxEkO,KA0HoL,aAAW,4BAAOhJ,SAAA,EAACC,EAAAA,EAAAA,KAAC6K,EAAAA,EAAI,CAAClG,KAAM,MAAM3E,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAAC,wCAG3P0E,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,wCAAuCb,SAAA,CAAC,oGAAqBC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,0IAC7E0E,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,wCAAuCb,SAAA,CAAC,0EAAeC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,0IACvE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,OAAMb,SAAA,EACnBC,EAAAA,EAAAA,KAAC8K,EAAAA,GAAe,CAACC,YA5GPA,KAClBC,sBAAsB,IAAM9B,IAAY,IAExC,MAAM+B,EAAM,IAAIC,MAAM,uBACtBxJ,OAAOyJ,cAAcF,IAwG8BG,UAtGlCC,IACjBL,sBAAsB,IAAM9B,IAAY,IACnCmC,EAAOC,aACZ/C,GAASrK,IACP,MAAMa,EAAO7G,MAAMC,KAAK+F,IACjBqN,GAASxM,EAAKyM,OAAOH,EAAOI,OAAO3L,MAAO,GAEjD,OADAf,EAAKyM,OAAOH,EAAOC,YAAYxL,MAAO,EAAGyL,GAClCxM,KA+F+DgB,UAC9DC,EAAAA,EAAAA,KAAC0L,EAAAA,GAAS,CAACC,YAAY,kBAAkBC,yBAAyB,EAAK7L,SACnEG,IACAuE,EAAAA,EAAAA,MAAA,OAAKhB,IAAKvD,EAAS2L,YAAc3L,EAAS4L,eAAgBlL,UAAU,sBAAqBb,SAAA,CACtFnG,GAAMtB,IAAI,CAACsC,EAAG3C,KACb,MAAMiD,EAAS5G,EAAYsG,EAAElC,OACvBqT,EAAc,CAAC,CAAEnW,MAAO,GAAIC,MAAO,iCAAcmW,OACrDrX,EAAgBiG,EAAElC,OAAOJ,IAAIyK,IAAC,CAAOnN,MAAO4O,OAAOzB,GAAIlN,MAAO,GAAGkN,sBAE7DkJ,EAAa,IAAIzW,IAAIoE,GAAMhB,OAAOwE,GAAKA,EAAEa,KAAOrD,EAAEqD,IAAI3F,IAAI8E,GAAKA,EAAE4L,OACjEkD,EAAgBvW,EAAgB2C,IAAI8L,IAAE,IACvCA,EACHG,SAAU0H,EAAWzU,IAAI4M,EAAGxO,UAExBuF,EAAa/E,KAAK+D,OAAOxF,EAAgBiG,EAAElC,QACjD,OACEsH,EAAAA,EAAAA,KAACL,EAAoB,CAAYE,YAAajF,EAAEqD,GAAI6B,MAAO7H,EAAI8H,SAC3DoM,IAAI,IAAAC,EAAA,OACJ3H,EAAAA,EAAAA,MAAA,OAAKhB,IAAK0I,EAAKN,YAAcM,EAAKE,kBAAoBF,EAAKG,gBAAiB1L,UAAW,gJAA+IhG,EAAEqD,KAAOqJ,EAAkB,gBAAkB,IAAMrD,MAAOkI,EAAKE,eAAepI,MAAMlE,SAAA,EAExT0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oIAAmIb,SAAA,CAAC,IAAEyJ,GAAiBvR,OACtKwM,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6CAA4Cb,SAAA,EACzDC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,+BAC5BC,EAAAA,EAAAA,KAACO,EAAQ,CAACK,UAAU,iBAAiBhL,MAAOgF,EAAEoO,KAAMtI,SAAW6L,GAAQzD,GAAWlO,EAAEqD,GAAI,CAAE+K,KAAMuD,IAAQ9L,MAAOyL,EAAevL,YAAY,2BAE5I8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,+CAA8Cb,SAAA,EAC3DC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,+BAC5BC,EAAAA,EAAAA,KAACO,EAAQ,CAACK,UAAU,iBAAiBhL,MAAOgF,EAAElC,MAAOgI,SAAW6L,GAAQzD,GAAWlO,EAAEqD,GAAI,CAAEvF,MAAM,IAAmC+H,MAAO5L,EAAOyD,IAAIlB,IAAC,CAAOxB,MAAOwB,EAAGvB,MAAOjB,EAAWwC,MAAQuJ,YAAY,kCAEhN8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,iCAAgCb,SAAA,EAC7CC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,qCAC5BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,kEAAiEb,UAACC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,6BAA4Bb,SAAE7E,UAEjIuJ,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,iCAAgCb,SAAA,EAC7CC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,+BAC5BC,EAAAA,EAAAA,KAACO,EAAQ,CAACK,UAAU,iBAAiBhL,MAAO4O,OAAqB,QAAf4H,EAACxR,EAAEK,oBAAY,IAAAmR,EAAAA,EAAI,IAAK1L,SAAW6L,IAAmBzD,GAAWlO,EAAEqD,GAAlBsO,EAAsB,CAAEtR,aAAchE,OAAOsV,GAAM1R,YAAY,GAA+B,CAAEI,kBAAcjB,EAAWa,YAAY,KAAa4F,MAAOsL,EAAapL,YAAY,qBAEvR8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,iCAAgCb,SAAA,EAC7C0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAAA,SAAO/B,GAAI,OAAOrD,EAAEqD,KAAMoG,KAAK,WAAWzD,UAAU,iBAAiB4L,QAAS5R,EAAEC,WAAY6F,SAAWrB,GAAMyJ,GAAWlO,EAAEqD,GAAI,CAAEpD,WAAYwE,EAAEmD,OAAOgK,aACrJxM,EAAAA,EAAAA,KAAA,SAAOyM,QAAS,OAAO7R,EAAEqD,KAAM2C,UAAU,UAASb,SAAC,+CAErD0E,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,6BAA4Bb,SAAA,CAAC,0EAAeC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,oBAAoB,8BAAM6D,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,eAAcb,SAAA,CAAE5E,EAAW,OAAK,gFAGhJsJ,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sEAAqEb,SAAA,EAClFC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sBACf6D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,qCAAoCb,SAAA,EACjDC,EAAAA,EAAAA,KAAA,UAAQY,UAAU,6EAA6E0D,QAASA,KAAMoI,OA1O1H5M,EA0OqI7H,EA1O3HsQ,GAASrK,IACrC,GAAI4B,GAAS,EAAG,OAAO5B,EACvB,MAAMa,EAAO,IAAIb,GAEjB,OADCa,EAAKe,EAAQ,GAAIf,EAAKe,IAAU,CAACf,EAAKe,GAAQf,EAAKe,EAAQ,IACrDf,IAJWe,OA0O2I,aAAW,eAAIC,UAACC,EAAAA,EAAAA,KAAC0E,EAAAA,EAAS,CAACC,KAAM,QAChK3E,EAAAA,EAAAA,KAAA,UAAQY,UAAU,6EAA6E0D,QAASA,KAAMqI,OArOxH7M,EAqOqI7H,EArO3HsQ,GAASrK,IACvC,GAAI4B,GAAS5B,EAAKlG,OAAS,EAAG,OAAOkG,EACrC,MAAMa,EAAO,IAAIb,GAEjB,OADCa,EAAKe,EAAQ,GAAIf,EAAKe,IAAU,CAACf,EAAKe,GAAQf,EAAKe,EAAQ,IACrDf,IAJae,OAqO2I,aAAW,qBAAKC,UAACC,EAAAA,EAAAA,KAAC4E,EAAAA,EAAW,CAACD,KAAM,WAEvKF,EAAAA,EAAAA,MAAA,UAAQ7D,UAAU,4HAA4H0D,QAASA,KAAMsI,OAhLvK3O,EAgLkLrD,EAAEqD,GA/KtMsK,GAASQ,GAAMA,EAAG/Q,QAAU,EAAI+Q,EAAKA,EAAGnQ,OAAOgC,GAAKA,EAAEqD,KAAOA,SACzDqJ,IAAoBrJ,GAAIsJ,EAAmB,OAF7BtJ,OAgLyLsG,SAAU3K,GAAM5B,QAAU,EAAG,aAAW,4BAAO+H,SAAA,EAACC,EAAAA,EAAAA,KAAC6M,EAAAA,EAAM,CAAClI,KAAM,MAAM3E,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAAC,6BAnCnQnF,EAAEqD,MA0ChCiC,EAASS,mBAKA,IAAjB/G,GAAM5B,SAAgBgI,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wCAAuCb,SAAC,uKAIlF0E,EAAAA,EAAAA,MAAA,WAAS7D,UAAW,GAAGyI,iBAAmBJ,GAAW,GAAK,kBAAkBlJ,SAAA,EAC1E0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wCAAuCb,SAAA,EACpD0E,EAAAA,EAAAA,MAAA,MAAI7D,UAAWwI,GAAarJ,SAAA,CAAEjK,EAAe2Q,GAAU,2BACvDhC,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,uCAAsCb,SAAA,EACnD0E,EAAAA,EAAAA,MAAA,UAAQ7D,UAAU,8HAA8H0D,QA1N7IwI,KACb,MAAM7O,EAAK9H,IACXsS,GAAQ1F,GAAK,CAAC,CAAE9E,KAAI5E,KAAM,KAAME,MAAO,KAAM9B,IAAK,MAAOC,IAAK,EAAGC,IAAK,MAAOC,IAAK,MAAQmL,IAC1F0E,EAAkBxJ,IAuNyJ,aAAW,sBAAM8B,SAAA,EAACC,EAAAA,EAAAA,KAAC6K,EAAAA,EAAI,CAAClG,KAAM,MAAM3E,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAAC,6BACxO0E,EAAAA,EAAAA,MAAA,UAAQ7D,UAAU,8HAA8H0D,QAASA,IAAMmE,GAAQ,IAAK,aAAW,4BAAO1I,SAAA,EAACC,EAAAA,EAAAA,KAAC6M,EAAAA,EAAM,CAAClI,KAAM,MAAM3E,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAAC,yCAG1P0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sBAAqBb,SAAA,CACjCuI,GAAKhQ,IAAI,CAAClB,EAAGa,KACZwM,EAAAA,EAAAA,MAAA,OAAgB7D,UAAW,2JAA0JxJ,EAAE6G,KAAOuJ,EAAiB,gBAAkB,IAAKzH,SAAA,EACpO0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oHAAmHb,SAAA,CAAC,IAAE0J,GAAgBxR,EAAKqQ,GAAKtQ,YAE/JyM,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oEAAmEb,SAAA,EAChF0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sDAAqDb,SAAA,EAClEC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,qCAC5BC,EAAAA,EAAAA,KAACsF,EAAW,CACV1P,MAAOwB,EAAEiC,KACTqH,SAAWqC,GAAM6F,GAAUxR,EAAE6G,GAAI,CAAE5E,KAAM0J,IACzC5I,IAAK,EACLK,IAAK,EACLgL,KAAM,EACNC,YAAY,EACZ7E,UAAW,GAAGuI,oBACdxD,WAAY,CAAEa,MAAO,qBAAO7F,YAAa,4BAG7C8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sDAAqDb,SAAA,EAClEC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,mDAC5BC,EAAAA,EAAAA,KAACsF,EAAW,CACV1P,MAAOwB,EAAEmC,MACTmH,SAAWqC,GAAM6F,GAAUxR,EAAE6G,GAAI,CAAE1E,MAAOwJ,IAC1C5I,IAAK,EACLK,IAAK,EACLgL,KAAM,EACNC,YAAY,EACZ7E,UAAW,GAAGuI,oBACdxD,WAAY,CAAEa,MAAO,qBAAO7F,YAAa,+BAK/C8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6DAA4Db,SAAA,EACzE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,8BAA6Bb,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,oBAC5BC,EAAAA,EAAAA,KAACO,EAAQ,CAACK,UAAU,iBAAiBhL,MAAOwB,EAAEK,IAAKiJ,SAAW6L,GAAQ3D,GAAUxR,EAAE6G,GAAI,CAAExG,IAAI,IAAmCgJ,MAAOpL,EAAQiD,IAAIxB,IAAC,CAAOlB,MAAOkB,EAAGjB,MAAOf,EAAcgC,MAAQ6J,YAAY,kCAE/M8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sBAAqBb,SAAA,EAClCC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,kBAC5BC,EAAAA,EAAAA,KAACsF,EAAW,CACV1P,MAAOwB,EAAEM,IACTgJ,SAAWqC,GAAM6F,GAAUxR,EAAE6G,GAAI,CAAEvG,IAAKqL,IACxC5I,IAAK,EACLK,IAAK,EACLgL,KAAM,EACNC,YAAY,EACZ7E,UAAU,8GACV+E,WAAY,CAAEhF,YAAa,cAKjC8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6DAA4Db,SAAA,EACzE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,8BAA6Bb,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,oBAC5BC,EAAAA,EAAAA,KAACO,EAAQ,CAACK,UAAU,iBAAiBhL,MAAOwB,EAAEO,IAAK+I,SAAW6L,GAAQ3D,GAAUxR,EAAE6G,GAAI,CAAEtG,IAAI,IAAmC8I,MAAOpL,EAAQiD,IAAIxB,IAAC,CAAOlB,MAAOkB,EAAGjB,MAAOf,EAAcgC,MAAQ6J,YAAY,kCAE/M8D,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sBAAqBb,SAAA,EAClCC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,kBAC5BC,EAAAA,EAAAA,KAACsF,EAAW,CACV1P,MAAOwB,EAAEQ,IACT8I,SAAWqC,GAAM6F,GAAUxR,EAAE6G,GAAI,CAAErG,IAAKmL,IACxC5I,IAAK,EACLK,IAAK,EACLgL,KAAM,EACNC,YAAY,EACZ7E,UAAU,8GACV+E,WAAY,CAAEhF,YAAa,cAIjCX,EAAAA,EAAAA,KAAA,OAAKY,UAAU,4FAA2Fb,UACxG0E,EAAAA,EAAAA,MAAA,UAAQ7D,UAAU,4HAA4H0D,QAASA,KAAMyI,OAnS1J9O,EAmSoK7G,EAAE6G,GAlSvLwK,GAAQ1F,GAAKA,EAAEnK,OAAOxB,GAAKA,EAAE6G,KAAOA,SAChCuJ,IAAmBvJ,GAAIwJ,EAAkB,OAF5BxJ,OAmS2K,aAAW,sBAAM8B,SAAA,EAACC,EAAAA,EAAAA,KAAC6M,EAAAA,EAAM,CAAClI,KAAM,MAAM3E,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAAC,yBAxEjP3I,EAAE6G,KA4EG,IAAhBqK,GAAKtQ,SAAgBgI,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wCAAuCb,SAAC,wDAIjF0E,EAAAA,EAAAA,MAAA,WAAS7D,UAAW,GAAGyI,iBAAmBJ,GAAW,GAAK,kBAAkBlJ,SAAA,EAC1E0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,mCAAkCb,SAAA,EAC/CC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,iDAC7B0E,EAAAA,EAAAA,MAAA,UAAQ7D,UAAU,wJAAwJ0D,QApT/J0I,IAAM3F,EAAW,IAAK3R,IAoTgK,aAAW,wCAASqK,SAAA,EAACC,EAAAA,EAAAA,KAACiN,EAAAA,EAAS,CAACtI,KAAM,MAAM3E,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAAC,kDAElR0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,uCAAuCb,SAAA,EACrDC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,wBAAuBb,SAAC,qCACxC0E,EAAAA,EAAAA,MAAA,SAAO7D,UAAU,iCAAgCb,SAAA,EAC/CC,EAAAA,EAAAA,KAAA,SACEqE,KAAK,QACL2E,KAAK,OACLwD,QAAkB,WAATnV,EACTqJ,SAAUA,KACR0G,EAAQ,UACRC,EAAY5Q,GAAMqI,EAAmBrI,EAAG,YAE1CmK,UAAU,mBACV,mBAGJ6D,EAAAA,EAAAA,MAAA,SAAO7D,UAAU,iCAAgCb,SAAA,EAC/CC,EAAAA,EAAAA,KAAA,SACEqE,KAAK,QACL2E,KAAK,OACLwD,QAAkB,YAATnV,EACTqJ,SAAUA,KACR0G,EAAQ,WACRC,EAAY5Q,GAAMqI,EAAmBrI,EAAG,aAE1CmK,UAAU,mBACV,4BAINZ,EAAAA,EAAAA,KAAA,OAAKY,UAAU,OAAMb,UACnBC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gEAA+Db,SAC3E1K,EAAQiD,IAAKxB,IACZ2N,EAAAA,EAAAA,MAAA,OAAa7D,UAAU,uEAAsEb,SAAA,EAC3FC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAEjL,EAAcgC,MAC3CkJ,EAAAA,EAAAA,KAACsF,EAAW,CACV1P,MAAOoD,EAAQlC,GACf4J,SAAWqC,GAAMsE,EAAY5Q,IAAC,IAAWA,EAAG,CAACK,GAAKiM,KAClD5I,IAAK,EACLK,IAAK,EACLgL,KAAM,KACNC,YAAY,EACZ7E,UAAU,0GATJ9J,YAiB1B2N,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,kDAAiDb,SAAA,EAE5DmI,IACFzD,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,qCAAoCb,SAAA,CAAC,wDACpCC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6BAAQ,yFAG1BmI,IAAUF,IACTvD,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,yHAAwHb,SAAA,CAAC,yEACzHC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6BAAQ,2FAI3BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sDAAqDb,UAGlEC,EAAAA,EAAAA,KAAA,UACEqE,KAAK,SACLC,QAASA,IAAMyD,EAAehF,GAAKA,EAAI,GACvCwB,SAAUyD,EACVpH,UAAU,sJAAqJb,SAE9JiI,EAAY,4BAAU,mCAMrBvD,EAAAA,EAAAA,MAAA,WAAS7D,UAAW,GAAGyI,iBAAmBJ,GAAW,GAAK,kBAAkBlJ,SAAA,EAC1EC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,kBACvC0E,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,6BAA4Bb,SAAA,CAAC,4CAAUC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,mBAAQ,sEAC5DiI,IAAahI,EAAAA,EAAAA,KAAA,KAAGY,UAAU,6BAA4Bb,SAAC,yDACtDiI,GAA6B,IAAhBF,IACbrD,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,6BAA4Bb,SAAA,CAAC,2EAAgBC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6BAAQ,2DAErEiI,GAAaE,GAASJ,EAAc,IACpCrD,EAAAA,EAAAA,MAAA,KAAG7D,UAAU,4BAA2Bb,SAAA,CAAC,4FAAkBC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6BAAQ,2FAEhEC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,iBAAgBb,SAC5BnG,GAAMtB,IAAI,CAACsC,EAAGvC,KACb,MAAM6C,EAAS5G,EAAYsG,EAAElC,OACvBqF,EAAoB,OAAbqK,SAAa,IAAbA,QAAa,EAAbA,GAAgB/P,GACvB6U,KAAenP,GAAQA,EAAKrD,MAAQqD,EAAKrD,KAAK1C,OAAS,GACvDmD,EAAa/E,KAAK+D,OAAOxF,EAAgBiG,EAAElC,QACjD,OACE+L,EAAAA,EAAAA,MAAA,OAAgB7D,UAAU,iCAAgCb,SAAA,EACxD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oDAAmDb,SAAA,EAChE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,CACrCnF,EAAEoO,KAAK,KAACvE,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,wBAAuBb,SAAA,CAAC,IAAEnL,EAAWgG,EAAElC,OAAO,UAExEwU,IACCzI,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,+DAA8Db,SAAA,EAC3E0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAW0I,GAAKvJ,SAAA,CAAC,8BAAMC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,gBAAeb,SAAEyE,OAAOzG,EAAK9E,aAAkB,oBAAM+G,EAAAA,EAAAA,KAAA,QAAAD,SAAOyE,OAAOtJ,KAAe,MAAEuJ,EAAAA,EAAAA,MAAA,QAAA1E,SAAA,CAAM,sBAAKyE,OAAOtJ,EAAS6C,EAAK9E,cAAkB,QAClLwL,EAAAA,EAAAA,MAAA,OAAK7D,UAAW0I,GAAKvJ,SAAA,CAAC,8BAAMC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,gBAAeb,SAAEyE,OAAOzG,EAAKpF,iBACxE,MACC,MAAMkD,EAASkC,EAAKvE,IAAIxB,OAAS5B,KAAKoE,OAAOuD,EAAKvE,KAAO,KACzD,OACEiL,EAAAA,EAAAA,MAAA,OAAK7D,UAAW0I,GAAKvJ,SAAA,CAAC,8BACdC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,gBAAeb,SAAY,MAAVlE,EAAiB2I,OAAO3I,GAAU,mBAG9E,EAPA,IAQD4I,EAAAA,EAAAA,MAAA,OAAK7D,UAAW0I,GAAKvJ,SAAA,CAAC,qCACpBC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,gBAAeb,SACnB,WAAT1I,EAAoB,eAAgB,YAATA,EAAqB,eAAO,qCAE1D2I,EAAAA,EAAAA,KAAA,QAAMY,UAAU,6BAA4Bb,SAAEyE,OAAOzG,EAAKtE,QAAQ0T,QAAQ,eAIhFD,GAKAzI,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EAEEC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,uCAAsCb,UACnD0E,EAAAA,EAAAA,MAAA,SAAO7D,UAAU,qBAAoBb,SAAA,EACnCC,EAAAA,EAAAA,KAAA,SAAAD,UACE0E,EAAAA,EAAAA,MAAA,MAAI7D,UAAU,0BAAyBb,SAAA,EACrCC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAC,kBAC1BC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAC,wBAC1BC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAC,wBAC1BC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAC,mBAC1BC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAC,mBAC1BC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAC,6BAG9BC,EAAAA,EAAAA,KAAA,SAAAD,SACGhC,EAAKrD,KAAKpC,IAAIlB,IAAM,IAADiW,EAAAC,EAClB,MAAMC,EAAKjF,GAAKkF,UAAUpQ,GAAKA,EAAEa,KAAO7G,EAAE6G,IACpCwP,EAAOhE,GAAgB8D,EAAIjF,GAAKtQ,QACtC,OACEyM,EAAAA,EAAAA,MAAA,MAAe7D,UAAU,WAAUb,SAAA,EACjC0E,EAAAA,EAAAA,MAAA,MAAI7D,UAAU,YAAWb,SAAA,CAAC,IAAEyE,OAAOiJ,OACnCzN,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAEyE,OAAa,QAAP6I,EAACjW,EAAEiC,YAAI,IAAAgU,EAAAA,EAAI,MAC5CrN,EAAAA,EAAAA,KAAA,MAAIY,UAAU,YAAWb,SAAEyE,OAAc,QAAR8I,EAAClW,EAAEmC,aAAK,IAAA+T,EAAAA,EAAI,MAC7C7I,EAAAA,EAAAA,MAAA,MAAI7D,UAAU,YAAWb,SAAA,CAAEjL,EAAcsC,EAAEK,KAAK,IAAE+M,OAAOpN,EAAEM,SAC3D+M,EAAAA,EAAAA,MAAA,MAAI7D,UAAU,YAAWb,SAAA,CAAEjL,EAAcsC,EAAEO,KAAK,IAAE6M,OAAOpN,EAAEQ,SAC3DoI,EAAAA,EAAAA,KAAA,MAAIY,UAAU,yBAAwBb,SAAEyE,OAAOrN,EAAgBC,EAAGC,EAAMb,EAAgBwC,IAAUmU,QAAQ,QANnG/V,EAAE6G,cAcrB+B,EAAAA,EAAAA,KAAA,OAAKY,UAAU,2BAA0Bb,SACtChC,EAAKrD,KAAKpC,IAAIlB,IACb,MAAMmW,EAAKjF,GAAKkF,UAAUpQ,GAAKA,EAAEa,KAAO7G,EAAE6G,IACpCwP,EAAOhE,GAAgB8D,EAAIjF,GAAKtQ,QACtC,OACEyM,EAAAA,EAAAA,MAAA,OAAgB7D,UAAU,iCAAgCb,SAAA,EACxD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,4CAA2Cb,SAAA,EACxD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,cAAab,SAAA,CAAC,IAAEyE,OAAOiJ,OACtChJ,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,uBAAsBb,SAAA,CAAC,sBAAKyE,OAAOrN,EAAgBC,EAAGC,EAAMb,EAAgBwC,IAAUmU,QAAQ,WAE/G1I,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,gDAA+Cb,SAAA,EAC5DC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gBAAeb,SAAC,wBAC/BC,EAAAA,EAAAA,KAAA,OAAAD,SAAMyE,OAAOpN,EAAEiC,SACf2G,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gBAAeb,SAAC,wBAC/BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,eAAcb,SAAEyE,OAAOpN,EAAEmC,UACxCyG,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gBAAeb,SAAC,mBAC/B0E,EAAAA,EAAAA,MAAA,OAAA1E,SAAA,CAAMjL,EAAcsC,EAAEK,KAAK,IAAE+M,OAAOpN,EAAEM,SACtCsI,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gBAAeb,SAAC,mBAC/B0E,EAAAA,EAAAA,MAAA,OAAA1E,SAAA,CAAMjL,EAAcsC,EAAEO,KAAK,IAAE6M,OAAOpN,EAAEQ,aAbhCR,EAAE6G,YA1CpBwG,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6BAA4Bb,SAAA,CAAC,oOAC2B,MAAlBnF,EAAEK,aAAuB,mBAASE,qCAAuB,GAAG,SA3B3GP,EAAEqD,eA+FtB+B,EAAAA,EAAAA,KAAC6E,EAAU,CAACE,OAAQA,EAAQC,QAAS0C,KACrC1H,EAAAA,EAAAA,KAAA,OAAKY,UAAU,OAAMb,UACnBC,EAAAA,EAAAA,KAAC0N,EAAAA,EAAU,QAInB,C,iDC9oCA,MAAMC,GAAiB,EACjBC,GAAkB,EAIxB,SAASC,EAAOC,GACd,IAAIrM,EAAI,WACR,IAAK,IAAIpJ,EAAI,EAAGA,EAAIyV,EAAI9V,OAAQK,IAC9BoJ,GAAKqM,EAAIC,WAAW1V,GACpBoJ,EAAIrL,KAAK4X,KAAKvM,EAAG,UAEnB,OAAOA,IAAM,CACf,CACA,SAASwM,EAAsBC,GAE7B,OAAOL,EADM1O,KAAKkL,UAAU6D,KACL,CACzB,CACA,SAASC,EAAQC,GACf,IAAIjV,EAAIiV,IAAS,EACjB,OAAO,WAOL,OANAjV,GAAKA,GAAK,GACVA,KAAO,EACPA,GAAKA,IAAM,GACXA,KAAO,EACPA,GAAKA,GAAK,EACVA,KAAO,GACCA,IAAM,GAAK,UACrB,CACF,CAEA,MAAMkV,EAAc9V,KAAQtB,OAAOsB,GAAK,GAClC+V,GAAa/V,GAAMtB,OAAOsB,IAAM,EAIhCgW,GAAQ,CAAEC,WAAY,EAAGC,WAAY,GAAIC,UAAW,GAAIC,UAAW,GAAIC,YAAa,IACpFC,GAAY,CAChB,4BAAS,CAAEC,SAAU,EAAGC,OAAQ,CAAC,qBAAO,6BAAUtZ,QAAS,CAAC,qBAAO,2CACnE,4BAAS,CAAEqZ,SAAU,EAAGC,OAAQ,CAAC,qBAAO,6BAAUtZ,QAAS,CAAC,yCAAY,2CACxE,4BAAS,CAAEqZ,SAAU,GAAIC,OAAQ,CAAC,4BAAS,6BAAUtZ,QAAS,CAAC,qBAAO,2CACtE,4BAAS,CAAEqZ,SAAU,EAAGC,OAAQ,CAAC,qBAAO,6BAAUtZ,QAAS,CAAC,qBAAO,2CACnE,4BAAS,CAAEqZ,SAAU,EAAGC,OAAQ,CAAC,qBAAO,6BAAUtZ,QAAS,CAAC,yCAAY,2CACxE,4BAAS,CAAEqZ,SAAU,GAAIC,OAAQ,CAAC,4BAAS,6BAAUtZ,QAAS,CAAC,qBAAO,4CAElEuZ,GAAkB,CAAEC,eAAI,EAAGC,eAAI,EAAGC,eAAI,GACtCC,GAAsB,CAAEH,eAAI,EAAGC,eAAI,EAAGC,eAAI,GAC1CE,GAAW,EACXC,GAAW,EACXC,GAAmB,IAInBtJ,GAAQA,CAAClD,EAAGyM,EAAIC,IAAOrZ,KAAKoE,IAAIgV,EAAIpZ,KAAK+D,IAAIsV,EAAI1M,IAEvD,SAAS2M,GAAanX,GACpB,MAAM6E,EAAInG,OAAOsB,GACjB,OAAKtB,OAAOC,SAASkG,IAAMA,GAAK,EAAU,KACtCA,GAAK,EAAU,cACP,IAAJA,GAAS+P,QAAQ,GAAK,GAChC,CAEA,MAAMwC,GAAWpX,GAAMmX,GAAanX,GAC9BqX,GAAU7X,GAAMA,EAAE8X,iBAExB,SAASC,GAAeC,EAAcxX,GACpC,OAAKtB,OAAOC,SAAS6Y,IAAiBA,GAAgB,EAAU,GAC3D9Y,OAAOC,SAASqB,IAAMA,GAAK,EAAUsF,IACnCkS,EAAexX,CACxB,CAEA,MAAMyX,GAAOzX,GAAM,GAAGnC,KAAKoE,IAAI,EAAGpE,KAAK+D,IAAI,IAAK/D,KAAK6Z,MAAyB,KAAlBhZ,OAAOsB,IAAM,SAEzE,SAAS2X,GAAY3X,GACnB,OAAIA,GAAK,GAAa,CAAE1C,MAAO,eAAMsa,KAAM,qDACvC5X,GAAK,IAAa,CAAE1C,MAAO,eAAMsa,KAAM,+CACvC5X,GAAK,IAAa,CAAE1C,MAAO,eAAMsa,KAAM,kDACpC,CAAEta,MAAO,4BAASsa,KAAM,2CACjC,CAEA,SAASC,GAAaC,EAAWtY,GAC/B,GAAIA,GAAK,EAAG,OAAO,EAEnB,GAAkB,IAAdsY,EAAiB,OAAO,EAC5B,GAAIA,IAActY,EAAG,OAAO,EAC5B,OALwCgC,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,OAMzC,IAAK,UACH,OAAQsW,EAAY,IAAMtY,EAAI,GAChC,IAAK,WACH,OAAQsY,EAAY,KAAQtY,EAAI,GAElC,QACE,OAAOsY,EAAYtY,EAEzB,CACA,MAAMuY,IAAe,EAEfC,GAAc,CAClB,CAAE3a,MAAO,IAAMC,MAAO,8BACtB,CAAED,MAAO,IAAMC,MAAO,8BACtB,CAAED,MAAO,IAAOC,MAAO,+BACvB,CAAED,MAAO,IAAOC,MAAO,gCASzB,SAAS2a,GAAsBzY,GAAkB,IAAf0Y,EAAK1W,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,IACxC,OAAO,EAAI3D,KAAKsa,IAAID,EAAO,EAAI1Y,EACjC,CAEA,MAAM4Y,GAAmB5Y,GACnBA,GAAK,IAAe,KACpBA,GAAK,IAAe,KACpBA,GAAK,IAAc,KACnBA,GAAK,IAAc,KACnBA,GAAK,IAAa,KACf,KAEH6Y,GAAiB7Y,GACjBA,GAAK,IAAc,IACnBA,GAAK,IAAc,IACnBA,GAAK,IAAa,IACf,IAKT,SAAS8Y,GAAmBC,EAAQtU,GAClC,MAAMpF,EAAIyX,GAAUiC,GACpB,OAAK1Z,EACO,uBAARoF,EAAsBpF,EAAE2X,OAChB,uBAARvS,EAAsBpF,EAAE3B,QACrB,IAAI2B,EAAE2X,UAAW3X,EAAE3B,SAHX,EAIjB,CACA,MAAMsb,GAAc5X,GAAMA,EAAE6X,IAAM7X,EAAE8X,IAAM9X,EAAE+X,KAAO/X,EAAEgY,KACrD,SAASC,GAAQ1X,GACf,OAAIA,GAAS6U,GAAMK,YAAoB,eACnClV,GAAS6U,GAAMG,WAAahV,GAAS6U,GAAMI,UAAkB,eAC7DjV,GAAS6U,GAAMC,YAAc9U,GAAS6U,GAAME,WAAmB,eAC5D,2BACT,CACA,SAAS4C,GAAkB7U,EAAK8U,EAAQnY,EAAGN,EAAGiY,EAAQS,GACpD,MAAM7a,EAAOyC,EAAE6X,KAAOnY,EAAEmY,KAAO7X,EAAE8X,KAAOpY,EAAEoY,IAC1C,GAAY,8BAARzU,EAAiB,OAAO9F,EAG5B,MAAMmD,EAAOgX,GAAmBC,EAAQtU,GAClCgV,EAASC,GAAc,6BAAPA,EAChBC,EAAKF,EAAc,OAARD,QAAQ,IAARA,OAAQ,EAARA,EAAUI,OAAS,2BAAU9X,EAAKiQ,SAAiB,OAARyH,QAAQ,IAARA,OAAQ,EAARA,EAAUI,OAAiB,OAARJ,QAAQ,IAARA,OAAQ,EAARA,EAAUI,MAAQ,KAC3FC,EAAKJ,EAAc,OAARD,QAAQ,IAARA,OAAQ,EAARA,EAAUM,OAAS,2BAAUhY,EAAKiQ,SAAiB,OAARyH,QAAQ,IAARA,OAAQ,EAARA,EAAUM,OAAiB,OAARN,QAAQ,IAARA,OAAQ,EAARA,EAAUM,MAAQ,KAC3FC,EAAQA,CAACC,EAAUC,EAASC,EAAYC,IAC5CV,EAAMS,GAAepY,EAAKiQ,SAASiI,IAAaC,GAAWE,EACtDH,IAAaE,GAAcD,GAAWE,EAC7C,GAAe,YAAXZ,EAAsB,CAExB,MAAMa,EAAMT,IAAOI,EAAM3Y,EAAEwY,MAAOxY,EAAE+X,KAAMQ,EAAI7Y,EAAEqY,OAASY,EAAM3Y,EAAE0Y,MAAO1Y,EAAEgY,KAAMO,EAAI7Y,EAAEqY,OACtF,OAAOxa,KAAUyb,CACnB,CAEE,SAAKT,IAAOE,KACLlb,IACJob,EAAM3Y,EAAEwY,MAAOxY,EAAE+X,KAAMQ,EAAI7Y,EAAEqY,OAASY,EAAM3Y,EAAE0Y,MAAO1Y,EAAEgY,KAAMS,EAAI/Y,EAAEsY,OACnEW,EAAM3Y,EAAEwY,MAAOxY,EAAE+X,KAAMU,EAAI/Y,EAAEsY,OAASW,EAAM3Y,EAAE0Y,MAAO1Y,EAAEgY,KAAMO,EAAI7Y,EAAEqY,OAG1E,CAkCA,SAASkB,GAAmBrP,GAAK,OAAa,IAANA,CAAS,CACjD,SAASsP,GAAmBC,EAAOC,EAAc/V,EAAKsU,EAAQ0B,GAC5D,MAAMrZ,EAAImZ,EACJ7R,EAAQ,GACVtH,EAAE6X,IAAM,GAAGvQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,QAC5D0C,EAAE6X,KAAO,GAAGvQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,MAC7D0C,EAAE6X,KAAO,GAAGvQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,OAC7D0C,EAAE6X,KAAO,GAAGvQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,MAC7D2b,GAAmBjZ,EAAE6X,MAAMvQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,OAAQ,GAAKlc,EAAG,IAC7E0C,EAAE8X,IAAM,GAAGxQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,QAC5D0C,EAAE8X,KAAO,GAAGxQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,MAC7D0C,EAAE8X,KAAO,GAAGxQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,OAC7D0C,EAAE8X,KAAO,GAAGxQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,MAAO,GAAKlc,EAAG,MAC7D2b,GAAmBjZ,EAAE8X,MAAMxQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,MAAOC,OAAQ,GAAKlc,EAAG,IAC7E0C,EAAE+X,KAAO,GAAGzQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,QAC/D0C,EAAE+X,MAAQ,GAAGzQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,MAChE0C,EAAE+X,MAAQ,GAAGzQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,OAChE0C,EAAE+X,MAAQ,GAAGzQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,MAChE2b,GAAmBjZ,EAAE+X,OAAOzQ,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,OAAQ,GAAKlc,EAAG,IAChF0C,EAAEgY,KAAO,GAAG1Q,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,QAC/D0C,EAAEgY,MAAQ,GAAG1Q,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,MAChE0C,EAAEgY,MAAQ,GAAG1Q,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,OAChE0C,EAAEgY,MAAQ,GAAG1Q,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,MAAO,GAAKlc,EAAG,MAChE2b,GAAmBjZ,EAAEgY,OAAO1Q,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAASC,OAAQ,GAAKlc,EAAG,IACpF,MAAMmc,EAAQ/B,GAAmBC,EAAQ,6BACnC+B,EAAaD,EAAMha,OAAQb,GAAMA,IAAMoB,EAAE0Y,OAAS9Z,IAAMoB,EAAEwY,OAAO3Z,OAAS,EAC1E8a,EAAaF,EAAMha,OAAQb,GAAMA,IAAMoB,EAAEwY,OAAS5Z,IAAMoB,EAAE0Y,OAAO7Z,OAAS,EAUhF,OATI6a,GAAYpS,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,YAAcjc,EAAG,OACxDqc,GAAYrS,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,YAAcjc,EAAG,OACxD8b,EAAe,IACG,IAAhBC,GAAmB/R,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,OAAQK,IAAK,GAAKtc,EAAG,QAClD,IAAjB+b,GAAoB/R,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,OAAQK,KAAM,GAAKtc,EAAG,OACzEgK,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,cAAeM,OAAQ,GAAKvc,EAAG,MAC1DgK,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,cAAeM,OAAQ,GAAKvc,EAAG,OAE5DgK,EAAMjF,KAAK,CAAEiX,KAAM,CAAEC,KAAM,QAAUjc,EAAG,OACjCgK,CACT,CACA,SAASwS,GAAkBR,EAAMtZ,GAC/B,OAAQsZ,EAAKC,MACX,IAAK,MAAO,MAAO,oCAAUD,EAAKE,MAAQ,EAAI,IAAMF,EAAKE,MAAQ,MACjE,IAAK,MAAO,MAAO,uBAAOF,EAAKE,MAAQ,EAAI,IAAMF,EAAKE,MAAQ,MAC9D,IAAK,QAAS,MAAO,GAAGxZ,EAAEwY,aAAac,EAAKE,MAAQ,EAAI,IAAMF,EAAKE,MAAQ,OAC3E,IAAK,QAAS,MAAO,GAAGxZ,EAAE0Y,aAAaY,EAAKE,MAAQ,EAAI,IAAMF,EAAKE,MAAQ,OAC3E,IAAK,WAAY,MAAO,GAAGxZ,EAAEwY,kCAC7B,IAAK,WAAY,MAAO,GAAGxY,EAAE0Y,kCAC7B,IAAK,OAAQ,OAAoB,IAAbY,EAAKM,IAAY,+CAAmB,+CACxD,IAAK,OAAQ,MAAO,yCACpB,IAAK,cAAe,MAAO,2CAA4B,IAAhBN,EAAKO,OAAe,WAAQ,YACnE,QAAS,MAAO,GAEpB,CACA,SAASE,GAAYrd,EAAOsD,GAE1B,MAAMnC,EAAO6B,GAAOA,EAAEiR,SAAS,OAAS,EAAIqJ,SAASta,EAAEua,QAAQ,UAAW,IAAK,KAAO,EACtF,OAFAvd,EAAQA,EAAMwd,QAEJC,WAAW,mCAAkB,CAAEZ,KAAM,MAAOC,MAAO3b,EAAInB,IAC7DA,EAAMyd,WAAW,sBAAe,CAAEZ,KAAM,MAAOC,MAAO3b,EAAInB,IAC1DA,EAAMyd,WAAWna,EAAEwY,MAAQ,KAAa9b,EAAMiU,SAAS,gBAAQ,CAAE4I,KAAM,YAAe,CAAEA,KAAM,QAASC,MAAO3b,EAAInB,IAClHA,EAAMyd,WAAWna,EAAE0Y,MAAQ,KAAahc,EAAMiU,SAAS,gBAAQ,CAAE4I,KAAM,YAAe,CAAEA,KAAM,QAASC,MAAO3b,EAAInB,IAClHA,EAAMyd,WAAW,6BAAiB,CAAEZ,KAAM,OAAQK,IAAKld,EAAMiU,SAAS,SAAW,GAAK,GACtFjU,EAAMyd,WAAW,0CAAoB,CAAEZ,KAAM,QAC7C7c,EAAMyd,WAAW,0CAAoB,CAAEZ,KAAM,cAAeM,OAAQnd,EAAMiU,SAAS,MAAQ,EAAI,GAC5F,IACT,CACA,SAASyJ,GAAUzC,EAAQtU,EAAKrD,EAAGsZ,EAAMD,EAAagB,GACpD,MAAMC,EAAuB,oBAAVD,EAAuBA,EAAQpd,KAAKC,OACvD,IAAI0I,EAAO,IAAK5F,GAChB,MAAMua,EAAkBnE,KAAqC,IAAjBiD,EAAqB,EAAoB,IAAhBA,EAAoB,EAAI,GAC7F,IAAImB,EAAW,EACXC,EAAc,EAClB,MAAMhB,EAAQ/B,GAAmBC,EAAQ,6BACzC,OAAQ2B,EAAKC,MACX,IAAK,MAAO3T,EAAKiS,IAAM/K,GAAMlH,EAAKiS,IAAMyB,EAAKE,MAAO,EAAGrD,IAAW,MAClE,IAAK,MAAOvQ,EAAKkS,IAAMhL,GAAMlH,EAAKkS,IAAMwB,EAAKE,MAAO,EAAGrD,IAAW,MAClE,IAAK,QAASvQ,EAAKmS,KAAOjL,GAAMlH,EAAKmS,KAAOuB,EAAKE,MAAO,EAAGrD,IAAW,MACtE,IAAK,QAASvQ,EAAKoS,KAAOlL,GAAMlH,EAAKoS,KAAOsB,EAAKE,MAAO,EAAGrD,IAAW,MACtE,IAAK,WAAY,CACf,MAAMzV,EAAO+Y,EAAMha,OAAQb,GAAMA,IAAMgH,EAAK8S,OAAS9Z,IAAMgH,EAAK4S,OAChE,GAAI9X,EAAK7B,OAAQ,CACf,MAAM+F,EAAOlE,EAAKzD,KAAKyd,MAAMJ,IAAQ5Z,EAAK7B,SAC1C+G,EAAK4S,MAAQ5T,CACf,CACA,KACF,CACA,IAAK,WAAY,CACf,MAAMlE,EAAO+Y,EAAMha,OAAQb,GAAMA,IAAMgH,EAAK4S,OAAS5Z,IAAMgH,EAAK8S,OAChE,GAAIhY,EAAK7B,OAAQ,CACf,MAAM+F,EAAOlE,EAAKzD,KAAKyd,MAAMJ,IAAQ5Z,EAAK7B,SAC1C+G,EAAK8S,MAAQ9T,CACf,CACA,KACF,CACA,IAAK,OAAQ4V,EAAWlB,EAAKM,IAAK,MAClC,IAAK,OAEL,QAAS,MADT,IAAK,cAAea,GAAenB,EAAKO,OAG1C,MAAO,CAAEjU,OAAM2U,kBAAiBC,WAAUC,cAC5C,CAIA,MAAME,GAAa,CAAEC,YAAa,EAAGC,WAAY,EAAGC,UAAW,EAAGC,YAAa,EAAGnE,aAAc,GAEhG,SAASoE,GACPrD,EAAQtU,EAAK8U,EAAQ8C,EAAO5R,EAAQ6R,EAAQ9B,EAAc+B,EAAS9B,EAAa+B,EAAgBC,EAAmBpG,EAAMmD,GACxH,IADkIkD,EAAI1a,UAAA/B,OAAA,SAAAgC,IAAAD,UAAA,IAAAA,UAAA,IAAG,CAAC,EAE3I,MAAM,UACJ2a,EAAY,IAAK,QACjBC,EAAU,KAAK,MACfC,EAAQ,IAAI,UACZC,EAAYze,KAAK+D,IAAI,IAAOua,GAAU,UACtCI,EAAY,WAAU,cAEtBC,GAAgB,EAAI,cACpBC,GAAgB,EAAI,oBACpBC,EAAsB,IAAG,cACzBC,EAAgB,IAAM,UACtBC,EAAY,CAAC,MACXV,EAEEW,EAAgBjc,GA1JxB,SAA4BqD,EAAK8U,EAAQnY,EAAGN,EAAGiY,EAAQS,GAErD,IAAI8D,EAAMjf,KAAKoE,IAAI,EAAG3B,EAAEmY,IAAM7X,EAAE6X,KAAO5a,KAAKoE,IAAI,EAAG3B,EAAEoY,IAAM9X,EAAE8X,KAC7D,GAAY,8BAARzU,EAAiB,OAAO6Y,EAC5B,MAAMxb,EAAOgX,GAAmBC,EAAQtU,GAClCgV,EAASC,GAAc,6BAAPA,EAChBC,EAAKF,EAAc,OAARD,QAAQ,IAARA,OAAQ,EAARA,EAAUI,OAAS,2BAAU9X,EAAKiQ,SAAiB,OAARyH,QAAQ,IAARA,OAAQ,EAARA,EAAUI,OAAiB,OAARJ,QAAQ,IAARA,OAAQ,EAARA,EAAUI,MAAQ,KAC3FC,EAAKJ,EAAc,OAARD,QAAQ,IAARA,OAAQ,EAARA,EAAUM,OAAS,2BAAUhY,EAAKiQ,SAAiB,OAARyH,QAAQ,IAARA,OAAQ,EAARA,EAAUM,OAAiB,OAARN,QAAQ,IAARA,OAAQ,EAARA,EAAUM,MAAQ,KAC3FyD,EAAcA,CAACC,EAASC,EAAQvD,EAAYwD,IAC5CjE,EAAMS,IACWpY,EAAKiQ,SAASyL,GAAW,EAAI,GAC5Bnf,KAAKoE,IAAI,EAAGib,EAAYD,IAEtCD,IAAYtD,EAAa,EAAI,GAAK7b,KAAKoE,IAAI,EAAGib,EAAYD,GAEpE,GAAe,YAAXlE,EAAsB,CACxB,IAAKI,EAAI,OAAOza,OAAOye,kBAEvB,MAAMC,EAAKL,EAAYnc,EAAEwY,MAAOxY,EAAE+X,KAAMQ,EAAI7Y,EAAEqY,MACxC0E,EAAKN,EAAYnc,EAAE0Y,MAAO1Y,EAAEgY,KAAMO,EAAI7Y,EAAEqY,MAC9CmE,GAAOjf,KAAK+D,IAAIwb,EAAIC,EACtB,KAAO,CACL,IAAKlE,IAAOE,EAAI,OAAO3a,OAAOye,kBAE9B,MAAMG,EAAMP,EAAYnc,EAAEwY,MAAOxY,EAAE+X,KAAMQ,EAAI7Y,EAAEqY,MAAQoE,EAAYnc,EAAE0Y,MAAO1Y,EAAEgY,KAAMS,EAAI/Y,EAAEsY,MACpF2E,EAAMR,EAAYnc,EAAEwY,MAAOxY,EAAE+X,KAAMU,EAAI/Y,EAAEsY,MAAQmE,EAAYnc,EAAE0Y,MAAO1Y,EAAEgY,KAAMO,EAAI7Y,EAAEqY,MAC1FmE,GAAOjf,KAAK+D,IAAI0b,EAAKC,EACvB,CACA,OAAOT,CACT,CA6H8BU,CAAmBvZ,EAAK8U,EAAQnY,EAAGqJ,EAAQsO,EAAQS,GAEzEyE,EAAWC,IACf,MAAMC,EAAqBpe,IACzB,MAAMud,EAAMvd,EAAIoB,OAAO,CAACyC,EAAGC,IAAMD,EAAIC,EAAEnF,EAAG,GAC1C,IAAI6L,EAAI2T,IAASZ,EACjB,IAAK,IAAIhd,EAAI,EAAGA,EAAIP,EAAIE,OAAQK,IAAsB,GAAfiK,GAAKxK,EAAIO,GAAG5B,EAAO6L,GAAK,EAAG,OAAOjK,EACzE,OAAOP,EAAIE,OAAS,GAEtB,IAAImB,EAAI,IAAKib,GACT+B,EAAO,EACP9U,EAAOkR,EACP6D,EAAM9B,EACN+B,EAAW9B,EACX+B,EAAO9D,EACP+D,GAAQ,EACZ,GAAe,oBAAXlC,GACFhD,GAAkB7U,EAAK8U,EAAQnY,EAAGqJ,EAAQsO,EAAQS,GAAW,CAC7D,MACMna,EAAIga,GADIL,GAAW5X,IAEzB,MAAO,CACL4a,YAAa,EACbC,WAAkB,iBAAN5c,EAAa,EAAI,EAC7B6c,UAAiB,iBAAN7c,EAAa,EAAI,EAC5B8c,YAAmB,iBAAN9c,EAAa,EAAI,EAC9B2Y,aAAc,EAElB,CACA,KAAO1O,EAAO,GAAG,CACf,IAAInE,EAAO,GACX,GAAIqZ,GAAS/B,EAAkBxc,OAAS,EACtCkF,EAAOsX,EAAkBje,MAAM,EAAG,OAC7B,CACL,MAAMsD,EAAOwY,GAAmBlZ,EAAGkI,EAAM7E,EAAKsU,EAAQwF,GACtD,IAAKzc,EAAK7B,OAAQ,MAClB,MAAMwe,EAAO,IAAI3c,GACX9B,EAAI3B,KAAK+D,IAAI,EAAGqc,EAAKxe,QAC3B,IAAK,IAAIK,EAAI,EAAGA,EAAIN,EAAGM,IAAK,CAC1B,MAAMJ,EAAMie,EAAkBM,GAC9BtZ,EAAK1B,KAAKgb,EAAKve,GAAKwa,MACpB+D,EAAKhL,OAAOvT,EAAK,EACnB,CACF,CACA,GAAIqY,GAAc,CAChB,MAAMvS,EAAOb,EAAK9G,KAAKyd,MAAMoC,IAAS/Y,EAAKlF,SACrCye,EAAMlD,GAAUzC,EAAQtU,EAAKrD,EAAG4E,EAAMuY,EAAML,GAClD9c,EAAIsd,EAAI1X,KAAMoX,GAAQM,EAAI/C,gBAAiB4C,EAAOG,EAAI9C,SAAUyC,GAAOK,EAAI7C,YAAayC,GAAW,CACrG,KAAO,CACL,MAAMK,EAAY7F,GAAmBC,EAAQtU,GACvCmV,EAAQxY,EAAEwY,MAAOE,EAAQ1Y,EAAE0Y,MAC3BgB,EAAa6D,EAAU9X,KAAM7G,GAAMA,IAAM8Z,GAAS9Z,IAAM4Z,GACxDmB,EAAa4D,EAAU9X,KAAM7G,GAAMA,IAAM4Z,GAAS5Z,IAAM8Z,GACxD8E,EAASvB,EAAajc,GAC5B,IAAIkD,EAAO,KACX,IAAK,MAAMua,KAAM1Z,EAAM,CACrB,GAAgB,aAAZ0Z,EAAGlE,OAAwBG,EAAY,SAC3C,GAAgB,aAAZ+D,EAAGlE,OAAwBI,EAAY,SAC3C,MAAM2D,EAAMlD,GAAUzC,EAAQtU,EAAKrD,EAAGyd,EAAIN,EAAML,GAC1CY,EAAOF,EAASvB,EAAaqB,EAAI1X,QAClC1C,GAAQwa,EAAOxa,EAAKwa,QACvBxa,EAAO,CAAE0C,KAAM0X,EAAI1X,KAAMoX,KAAMM,EAAI/C,gBAAiBC,SAAU8C,EAAI9C,SAAUmD,IAAKL,EAAI7C,YAAaiD,QAEtG,CACA,GAAIxa,GAAQA,EAAKwa,MAAQ,GAAKR,GAAYD,EAAM,EAAG,CAAEA,GAAO,EAAGG,GAAQ,EAAO,QAAU,CACpFla,IAAQlD,EAAIkD,EAAK0C,KAAMoX,GAAQ9Z,EAAK8Z,KAAMG,EAAOja,EAAKsX,SAAUyC,GAAO/Z,EAAKya,IAAKT,GAAW,EAClG,CAEA,GADAhV,GAAQ,EAAGkV,GAAQ,EACJ,oBAAXlC,GAAgChD,GAAkB7U,EAAK8U,EAAQnY,EAAGqJ,EAAQsO,EAAQS,GAAW,KACnG,CACA,MACMna,EAAIga,GADIL,GAAW5X,IAEzB,MAAO,CACL4a,YAAa1C,GAAkB7U,EAAK8U,EAAQnY,EAAGqJ,EAAQsO,EAAQS,GAAY,EAAI,EAC/EyC,WAAkB,iBAAN5c,EAAa,EAAI,EAC7B6c,UAAiB,iBAAN7c,EAAa,EAAI,EAC5B8c,YAAmB,iBAAN9c,EAAa,EAAI,EAC9B2Y,aAAcoG,IAIlB,IAAIpe,EAAI,EACJgf,EAAU,EAAGC,EAAY,EAAGC,EAAW,EAAGC,EAAa,EAAGC,EAAU,EACpEC,EAAM,IAAKtD,GAAYuD,WAAY,EAAG/c,GAAI,CAAEgd,IAAK,EAAGC,KAAM,EAAGC,UAAW,IAExEC,EAAiB/C,EAEjBgD,GAAY,EAEhB,MAAMC,EAAQzf,MAAM+J,QAAQkT,IAAcA,EAAUnd,OAChD,IAAImd,GAAWzZ,KAAK,CAACC,EAAGC,IAAMD,EAAIC,GAClC,CAACsZ,GACC0C,EAAUD,EAAMA,EAAM3f,OAAS,GAC/B6f,EAAYC,GAAQH,EAAMvU,KAAKvK,GAAKA,EAAIif,IAAQA,EAChDC,EAAYJ,EAAM,GAClBK,EAAeA,CAACC,EAAUhgB,KAEfggB,IAAa,EAAM7hB,KAAK4X,KAAM/V,EAAM,IAAO,EAAG,cAAgB,KAC5D,EAEbigB,EAAWA,KACf,MAAM3f,EAAIwe,EAAU3gB,KAAKoE,IAAI,EAAGzC,GAChC,IAAIuC,EACJ,GAAU,IAAN/B,EAAS,CACX,MAAM4f,EAAK3H,GAAsBzY,GACjCuC,EAAK,CAAEgd,IAAK,EAAGC,KAAMY,EAAIX,UAAWW,EAAK,EAC3C,MAAO,GAAU,IAAN5f,EAAS,CAClB,MACM+e,EAAM,EADD9G,GAAsBzY,GAEjCuC,EAAK,CAAEgd,MAAKC,KAAM,EAAGC,WAAY,EAAIF,GAAO,EAC9C,KAAO,CACL,MAAM7gB,EA3UZ,SAAkB8B,EAAGR,GAAc,IAAXqgB,EAACre,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,KAC1B,MAAMse,EAAQ,EAAKD,EAAIA,EAAKrgB,EACtBugB,GAAU/f,EAAK6f,EAAIA,GAAM,EAAIrgB,IAAMsgB,EACnCE,EAAUH,EAAIC,EAASjiB,KAAKoiB,KAAMjgB,GAAK,EAAIA,GAAKR,EAAMqgB,EAAIA,GAAM,EAAIrgB,EAAIA,IAC9E,MAAO,CAAEuf,IAAKlhB,KAAKoE,IAAI,EAAG8d,EAASC,GAAShB,KAAMnhB,KAAK+D,IAAI,EAAGme,EAASC,GACzE,CAsUgBE,CAASlgB,EAAGR,GACtBuC,EAAK,CAAEgd,IAAK7gB,EAAE6gB,IAAKC,KAAM9gB,EAAE8gB,KAAMC,WAAY/gB,EAAE8gB,KAAO9gB,EAAE6gB,KAAO,EACjE,CAEA,OADAF,EAAI9c,GAAKA,EACFA,GAET,KAAOvC,EAAI0f,GAAgB,CAEzB,MAAMiB,EAAQ9D,EACd,IAAK,IAAIvc,EAAI,EAAGA,EAAIqgB,KAEd3gB,GAAK0f,GAFgBpf,IAAK,CAG9B,MAAMsgB,EAAYX,EAAa5J,IAAS,EAAGrW,EAAIM,GAGzCugB,EAAM5C,EADD7H,EAAQwK,IASnB,GAPA5B,GAAW6B,EAAI7E,YACfiD,GAAa4B,EAAI5E,WACjBiD,GAAY2B,EAAI3E,UAChBiD,GAAc0B,EAAI1E,YAClBiD,GAAWyB,EAAI7I,aACfhY,GAAK,EAEDgd,GAAiBhd,EAAI0f,EAAgB,CACvC,MAAMoB,EAAS1K,EAAQwK,GAEjBG,EAAM9C,EADD+C,IAAM,EAAIF,KAErB9B,GAAW+B,EAAI/E,YACfiD,GAAa8B,EAAI9E,WACjBiD,GAAY6B,EAAI7E,UAChBiD,GAAc4B,EAAI5E,YAClBiD,GAAW2B,EAAI/I,aACfhY,GAAK,CACP,CACF,CACA,MACMihB,EADKd,IACGV,WAAa,EAE3B,GAAIxC,GAAiBjd,GAAK8c,GAAyB,IAAZkC,GAAiBU,EAAiBG,EAAS,CAEhFH,EAAiBA,EAAiBM,EAAYA,EAAYF,EAASJ,GACnEC,GAAY,EACZ,QACF,CAOA,GAJE1C,GACAjd,GAAK8c,GACLkC,EAAU9B,GACVwC,EAAiBG,EACE,CAEnB,MAAM7Y,EAAO0Y,EAAiBM,EAAYA,EAAYF,EAASJ,GAC/DA,EAAiBrhB,KAAK+D,IAAIyd,EAAS7Y,GACnC,QACF,CAEA,IAAK2Y,GAAasB,GAAMrE,GAAW5c,GAAK8c,EAAW,KACrD,CASA,OARAuC,EAAIC,WAAatf,EACjBqf,EAAIrD,YAAc3D,GAAa2G,EAAShf,EAAG+c,GAC3CsC,EAAIpD,WAAa5D,GAAa4G,EAAWjf,EAAG+c,GAC5CsC,EAAInD,UAAY7D,GAAa6G,EAAUlf,EAAG+c,GAC1CsC,EAAIlD,YAAc9D,GAAa8G,EAAYnf,EAAG+c,GAC9CsC,EAAIrH,aAAeoH,EAAU/gB,KAAKoE,IAAI,EAAGzC,GAEzCqf,EAAI/G,UAAsB,EAAV0G,EACTK,CACT,CAEA,MAAM6B,GAAkB,CACtBC,OAAQ,2CACRC,MAAO,2CACPC,QAAS,4CAqCX,SAAS7Y,GAAQX,GAQb,IARc,MAChBhK,EAAK,MACL6K,EAAK,SACLC,EAAQ,YACRC,EAAW,UACXC,EAAS,SACT2D,EAAQ,SACR8U,GAAW,GACZzZ,EACC,MAAOiB,EAAMC,IAAWC,EAAAA,EAAAA,WAAS,GAC3BC,GAASC,EAAAA,EAAAA,QAAO,MAChBC,GAAUD,EAAAA,EAAAA,QAAO,MACjBE,GAAUF,EAAAA,EAAAA,QAAO,CAAEG,IAAK,EAAGC,KAAM,EAAGC,MAAO,KAC1C,CAAEC,IAAaR,EAAAA,EAAAA,UAAS,IAE/BS,EAAAA,EAAAA,WAAU,KACR,MAAMC,EAAIA,IAAMX,GAAQ,GAExB,OADAY,OAAOC,iBAAiB,sBAAuBF,GACxC,IAAMC,OAAOE,oBAAoB,sBAAuBH,IAC9D,IAhCL,SAA2BI,EAAMC,GAC/B,MAAMC,GAAYuX,EAAAA,EAAAA,SAAQ,IAAOphB,MAAM+J,QAAQJ,GAAQA,EAAO,CAACA,GAAQ,CAACA,IAClEK,GAAajB,EAAAA,EAAAA,QAAOa,IAC1BN,EAAAA,EAAAA,WAAU,KAAQU,EAAWC,QAAUL,GAAY,CAACA,KACpDN,EAAAA,EAAAA,WAAU,KACR,MAAMY,EAAY/C,IAAO,IAADgD,EAClBN,EAAUnD,KAAK0D,IAAM,OAADA,QAAC,IAADA,OAAC,EAADA,EAAGH,UAAWG,EAAEH,QAAQI,SAASlD,EAAEmD,UACzC,QAAlBH,EAAAH,EAAWC,eAAO,IAAAE,GAAlBA,EAAAI,KAAAP,EAAqB7C,IAGvB,OADAI,SAASkC,iBAAiB,QAASS,GAAU,GACtC,IAAM3C,SAASmC,oBAAoB,QAASQ,GAAU,IAC5D,CAACL,GACN,CAsBEW,CAAkB,CAAC1B,EAAQE,GAAU,IAAMJ,GAAQ,KAEnD6B,EAAAA,EAAAA,iBAAgB,KACd,IAAK9B,IAASG,EAAOmB,QAAS,OAC9B,MAAMS,EAAO5B,EAAOmB,QAAQU,wBAC5B1B,EAAQgB,QAAU,CAAEf,IAAKwB,EAAKE,OAAS,EAAGzB,KAAMuB,EAAKvB,KAAMC,MAAOsB,EAAKtB,OACvEC,EAAWwB,GAAMA,EAAI,GACrB,MAAMC,EAAWA,KAAO,IAADC,EACrB,MAAMX,EAAkB,QAAjBW,EAAGjC,EAAOmB,eAAO,IAAAc,OAAA,EAAdA,EAAgBJ,wBAA8BP,IACxDnB,EAAQgB,QAAU,CAAEf,IAAKkB,EAAEQ,OAAS,EAAGzB,KAAMiB,EAAEjB,KAAMC,MAAOgB,EAAEhB,OAC9DC,EAAWwB,GAAMA,EAAI,KAIvB,OAFArB,OAAOC,iBAAiB,SAAUqB,EAAU,CAAEE,SAAS,IACvDxB,OAAOC,iBAAiB,SAAUqB,GAC3B,KACLtB,OAAOE,oBAAoB,SAAUoB,GACrCtB,OAAOE,oBAAoB,SAAUoB,KAEtC,CAACnC,IAEJ,MAAMsC,EAAW1C,EAAM2C,KAAM/K,GAAMA,EAAEzC,QAAUA,GAEzCyN,EAAOxC,IAAS0D,GACpBvE,EAAAA,EAAAA,KAACsD,EAAAA,EAAe,CAAAvD,UACdC,EAAAA,EAAAA,KAACuD,EAAAA,EAAOC,GAAE,CACRC,IAAKvC,EAELwC,QAAS,CAAEC,QAAS,EAAGC,GAAI,EAAGsB,MAAO,KACrCrB,QAAS,CAAEF,QAAS,EAAGC,EAAG,EAAGsB,MAAO,GACpCpB,KAAM,CAAEH,QAAS,EAAGC,GAAI,EAAGsB,MAAO,KAClCnB,WAAY,CAAEC,SAAU,KACxBC,MAAO,CAAEC,SAAU,QAAS9C,IAAKD,EAAQgB,QAAQf,IAAKC,KAAMF,EAAQgB,QAAQd,KAAMC,MAAOH,EAAQgB,QAAQb,MAAO6C,OAAQ,MACxHvD,UAAW,yDAAwDyY,EAAW,SAAW,IAAKtZ,SAE7FU,EAAMnI,IAAK8L,IACVpE,EAAAA,EAAAA,KAAA,MAAAD,UACEC,EAAAA,EAAAA,KAAA,UACEqE,KAAK,SACLC,QAASA,KAAYF,EAAGG,WAAkB7D,EAAS0D,EAAGxO,OAAQkL,GAAQ,KACtE,kBAAesD,EAAGG,eAAkBvK,EACpC4G,UAAW,sCAAsCwD,EAAGG,SAAW,qBAAuB,sBAAsBH,EAAGxO,QAAUA,EAAQ,cAAgB,KAAKmK,UAEtJC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,iBAAgBb,SAAEqE,EAAGvO,WAPhC2O,OAAOJ,EAAGxO,UATjB,UAsBN,KAEJ,OACE6O,EAAAA,EAAAA,MAAA,OAAKhB,IAAKzC,EAAQJ,UAAW,oBAAoBA,GAAa,KAAKb,SAAA,EACjE0E,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,KAAOC,GAAYzD,EAASiC,IAAOA,GAC5CwB,SAAUA,EACV3D,UAAW,6KAA6KyY,EAAW,SAAW,MAAM9U,EAAW,qBAAuB,KAAKxE,SAAA,EAE3PC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mBAAkBb,SAAEoD,EAAWA,EAAStN,MAAQ8K,GAAe,kBAC/EX,EAAAA,EAAAA,KAAA,QAAMY,UAAU,oCAAmCb,SAAEc,GAAOb,EAAAA,EAAAA,KAAC0E,EAAAA,EAAS,CAACC,KAAM,MAAS3E,EAAAA,EAAAA,KAAC4E,EAAAA,EAAW,CAACD,KAAM,UAE1G9D,GAAQwC,IAGf,CAYA,SAASwB,GAAUrE,GAAuB,IAAtB,OAAEuE,EAAM,QAAEC,GAASxE,EACrC,MAMM+Y,EAAWpJ,IAAU,CACzBqJ,QAAS,6CACTC,KAAM,qCACNC,QAAS,yCACTC,MAAO,wCACPxJ,IAAS,0CACX,OACEnQ,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sGAAqGb,UAClHC,EAAAA,EAAAA,KAACsD,EAAAA,EAAe,CAAAvD,SACbgF,EAAOzM,IAAKO,IACX4L,SAAAA,EAAAA,MAAClB,EAAAA,EAAO0B,IAAG,CAETvB,QAAS,CAAEC,QAAS,EAAGuB,MAAO,KAC9BrB,QAAS,CAAEF,QAAS,EAAGuB,MAAO,GAC9BpB,KAAM,CAAEH,QAAS,EAAGuB,MAAO,KAC3BnB,WAAY,CAAEM,KAAM,SAAUc,UAAW,IAAKC,QAAS,IACvDxE,UAAW,+IAtBLuP,EAsB2JtX,EAAEsX,KAtBnJ,CACxBqJ,QAAS,uDACTC,KAAM,2CACNC,QAAS,iDACTC,MAAO,+CACPxJ,IAAS,mDAiB0KpQ,SAAA,EAE3KC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,iBAAgBb,SAAElH,EAAEwM,OACnCrF,EAAAA,EAAAA,KAAA,UACEY,UAAW,mCAAmC2Y,EAAQ1gB,EAAEsX,QACxD7L,QAASA,IAAMU,EAAQnM,EAAEoF,IACzB,aAAW,eAAI8B,SAChB,mBAZIlH,EAAEoF,IAjBDkS,WAqClB,CACA,SAAS7K,GAAWR,GAYhB,IAZiB,MACnBlP,EAAK,IACLgkB,EAAG,SACHlZ,EAAQ,IACRvG,EAAMkV,GAAQ,IACd7U,EAAM,GAAE,KACRgL,EAAO,EAAC,WACRC,GAAa,EAAK,WAClBC,GAAa,EAAI,UACjB9E,EAAY,GAAE,WACd+E,EAAa,CAAC,EAAC,SACfpB,GACDO,EACC,MAAMc,EAAS7C,GAAa,OAANA,QAAoB/I,IAAN+I,EAAkB,GAAKyB,OAAOzB,IAC3D8C,EAAOC,GAAY9D,EAAAA,SAAe4D,EAAMhQ,IAC/CoM,EAAAA,UAAgB,KAAQ8D,EAASF,EAAMhQ,KAAY,CAACA,IACpD,MAAMikB,EAAc9hB,IAClB,IAAIqF,EAAIrF,EAGR,OAFW,MAAPoC,GAAeiD,EAAIjD,IAAKiD,EAAIjD,GACrB,MAAPK,GAAe4C,EAAI5C,IAAK4C,EAAI5C,GACzB4C,GAYH0c,EAAgC,oBAAbpZ,EACnBqZ,EAAyB,oBAARH,EACvB,OACE5Z,EAAAA,EAAAA,KAAA,SACEqE,KAAK,SACL6B,UAAWT,EAAa,UAAY,UACpCD,KAAMA,EACNrL,IAAKA,EACLK,IAAKA,EACL+J,SAAUA,EACV3O,MAAOiQ,EACPnF,SAAWrB,IACT,MAAM0D,EAAI1D,EAAEmD,OAAO5M,MAEnB,GAAU,KAANmN,EAIF,OAHA+C,EAAS,SACLgU,GAAWpZ,EAAS,OAI1BoF,EAAS/C,GACT,MAAM/L,EAAMC,OAAO8L,GACnB,IAAK9L,OAAOC,SAASF,GAEnB,YADI8iB,GAAWpZ,EAAS,OAG1B,MAAM3I,EAAI0N,EAAazO,EAAMZ,KAAK4P,MAAMhP,GACpC8iB,EAEFpZ,EAAS3I,GACAgiB,GAETH,EAAIC,EAAW9hB,KAGnBoO,OAAQA,KACN,MAAMpO,EA9CaoB,KACvB,GAAU,KAANA,EAAU,OAAOuM,EAAiB,OAAHvL,QAAG,IAAHA,EAAAA,EAAO,EAAK,KAC/C,IAAIpC,EAAId,OAAOkC,GACf,OAAKlC,OAAOC,SAASa,IACrBA,EAAI0N,EAAa1N,EAAI3B,KAAK4P,MAAMjO,GACzB8hB,EAAW9hB,IAFc2N,EAAiB,OAAHvL,QAAG,IAAHA,EAAAA,EAAO,EAAK,MA2C5C4L,CAAgBF,GAC1BC,EAAc,MAAL/N,EAAY,GAAKyM,OAAOzM,IAC7B+hB,EACFpZ,EAAS3I,GACAgiB,GAETH,EAAS,MAAL7hB,EAAgB,OAAHoC,QAAG,IAAHA,EAAAA,EAAO,EAAKpC,IAGjCqO,QA/CiB/G,GAAMA,EAAEgH,cAAcC,OAgDvC1F,UAAW,gGAAgGA,OACvG+E,GAGV,CAIA,MAAMqU,GAASzU,IAAqD,IAApD,MAAE3P,EAAK,IAAEgkB,EAAG,QAAEK,EAAO,SAAE1V,EAAQ,YAAE5D,GAAa4E,EAC5D,MAAM9E,GAASwZ,GAAW,IAAI3hB,IAAK4hB,IAAC,IAAAC,EAAAC,EAAA,MACrB,kBAANF,EACH,CAAEtkB,MAAOskB,EAAGrkB,MAAOqkB,GACnB,CAAEtkB,MAAc,QAATukB,EAAED,EAAEtkB,aAAK,IAAAukB,EAAAA,EAAID,EAAGrkB,MAAc,QAATukB,EAAEF,EAAErkB,aAAK,IAAAukB,EAAAA,EAAI5V,OAAO0V,MAEtD,OACEla,EAAAA,EAAAA,KAACO,GAAQ,CACP3K,MAAOA,EACP8K,SAAUkZ,EACVnZ,MAAOA,EACP8D,WAAYA,EACZ3D,UAAU,mBACVD,YAAaA,GAAe,kBAOlC,SAAS0Z,GAAmBC,GAC1B,MAAMxiB,EAAMwiB,EAAO1hB,OAAO2hB,SAC1B,OAAO,IAAI/kB,IAAIsC,GAAK6M,OAAS7M,EAAIE,MACnC,CAIe,SAASwiB,KAAgB,IAADC,EACrC,MAAM,OAAE1V,EAAM,KAAEvJ,EAAI,OAAEkM,GAnKxB,WACE,MAAO3C,EAAQ4C,IAAa5G,EAAAA,EAAAA,UAAS,IAOrC,MAAO,CAAEgE,SAAQvJ,KANJ,SAAC6J,GAAwB,IAAnB8K,EAAIpW,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,OACxB,MAAMkE,EAAK7H,KAAKC,SAASC,SAAS,IAAIC,MAAM,EAAG,GAC/CoR,EAAW9O,GAAM,IAAIA,EAAG,CAAEoF,KAAIoH,MAAK8K,UACnCvI,WAAW,IAAMD,EAAW9O,GAAMA,EAAED,OAAQwE,GAAMA,EAAEa,KAAOA,IAAM,KACnE,EAEuByJ,OADPzJ,GAAO0J,EAAW9O,GAAMA,EAAED,OAAQwE,GAAMA,EAAEa,KAAOA,IAEnE,CA0JmC4J,IAC1BiJ,EAAQ4J,IAAa3Z,EAAAA,EAAAA,UAAS,8BAC9BvE,EAAKme,IAAU5Z,EAAAA,EAAAA,UAAS,8BACxB6Z,EAAQC,IAAa9Z,EAAAA,EAAAA,UAAS,iBAC9B+Z,EAAeC,IAAoBha,EAAAA,EAAAA,UAAS,WAC7Cia,GAAgB1B,EAAAA,EAAAA,SAAQ,IAAMzI,GAAmBC,EAAQ,6BAAU,CAACA,IACpEmK,GAAkB3B,EAAAA,EAAAA,SAAQ,IAAMzI,GAAmBC,EAAQ,6BAAU,CAACA,KACrEgH,EAAKoD,IAAUna,EAAAA,EAAAA,UAAS,CAAEiQ,IAAK3B,GAAU4B,IAAK5B,GAAUsC,MAAOqJ,EAAc,GAAI9J,KAAM7B,GAAUwC,MAAOmJ,EAAc,IAAMA,EAAc,GAAI7J,KAAM9B,MACpJ8L,EAAKC,IAAUra,EAAAA,EAAAA,UAAS,CAAEiQ,IAAK3B,GAAU4B,IAAK5B,GAAU6B,KAAM7B,GAAU8B,KAAM9B,MAC9EkC,EAAU8J,IAAeta,EAAAA,EAAAA,UAAS,CACvC4Q,MAAOd,GAAmBC,EAAQtU,GAAK,GACvCqV,MAAOhB,GAAmBC,EAAQtU,GAAK,IAAMqU,GAAmBC,EAAQtU,GAAK,MAExE8e,EAAaC,IAAkBxa,EAAAA,EAAAA,WAAS,IACxCya,EAAWC,IAAgB1a,EAAAA,EAAAA,WAAS,IACpC2a,EAAWC,IAAgB5a,EAAAA,EAAAA,WAAS,GAErC6a,EAAW9D,EAAInG,QAAUmG,EAAIjG,OAE5BgK,EAAWC,IAAgB/a,EAAAA,EAAAA,UAAS,KACrCgb,GAAc9a,EAAAA,EAAAA,SAAO,IAC3BO,EAAAA,EAAAA,WAAU,KACJua,EAAY5Z,UAChB4Z,EAAY5Z,SAAU,EACtB+Y,EAAO/hB,IAAC,IACHA,EACH6X,IAAK5a,KAAKoE,IAAIrB,EAAE6X,IAAK3B,IACrB4B,IAAK7a,KAAKoE,IAAIrB,EAAE8X,IAAK5B,IACrB6B,KAAM9a,KAAKoE,IAAIrB,EAAE+X,KAAM7B,IACvB8B,KAAM/a,KAAKoE,IAAIrB,EAAEgY,KAAM9B,OAEzB+L,EAAOviB,IAAC,IACHA,EACHmY,IAAK5a,KAAKoE,IAAI3B,EAAEmY,IAAK3B,IACrB4B,IAAK7a,KAAKoE,IAAI3B,EAAEoY,IAAK5B,IACrB6B,KAAM9a,KAAKoE,IAAI3B,EAAEqY,KAAM7B,IACvB8B,KAAM/a,KAAKoE,IAAI3B,EAAEsY,KAAM9B,SAExB,IACH,MAAO2M,EAAQC,IAAalb,EAAAA,EAAAA,UAAS,MACnCwR,aAAcvD,GAAgB4L,GAC9BtG,QAASlF,GAAoBwL,GAC7BvE,UAAU,EACV7D,YAAa,EACb2D,KAAM,EACN7D,MAAO,IAAKwF,OAEdtW,EAAAA,EAAAA,WAAU,KACRya,EAAWC,IAAC,IACPA,EACH3J,aAAcvD,GAAgB4L,GAC9BtG,QAASlF,GAAoBwL,GAC7BtI,MAAO,IAAKwF,GACZzB,UAAU,EACV7D,YAAa,EACb2D,KAAM,MAEP,CAACyE,EAAQ9C,IACZ,MAAOqE,EAAYC,IAAiBrb,EAAAA,EAAAA,UAAS,OACtCsb,EAAYC,IAAiBvb,EAAAA,EAAAA,UAAS,KAGtCwb,EAASC,IAAczb,EAAAA,EAAAA,UAAS,CAAE0b,KAAM,GAAIC,OAAQ,KAErDC,IAAeC,EAAAA,EAAAA,aAAY,MAC/BZ,OAAQ7c,KAAKC,MAAMD,KAAKkL,UAAU2R,IAClCG,WAAYA,EAAa,IAAKA,EAAYlC,QAAS,IAAIkC,EAAWlC,UAAa,KAC/EoC,eACE,CAACL,EAAQG,EAAYE,IACnBQ,IAAkBD,EAAAA,EAAAA,aAAaE,IACnCb,EAAUa,EAAKd,QACfI,EAAcU,EAAKX,YACnBG,EAAcQ,EAAKT,aAClB,IACGU,IAAcH,EAAAA,EAAAA,aAAY,KAC9BJ,EAAW/a,IACT,MAAMub,EAAW,IAAIvb,EAAEgb,KAAME,MAE7B,KAAOK,EAAShlB,OAjBE,IAiBsBglB,EAASC,QACjD,MAAO,CAAER,KAAMO,EAAUN,OAAQ,OAElC,CAACC,KACEO,GAAUX,EAAQE,KAAKzkB,OAAS,EAChCmlB,GAAUZ,EAAQG,OAAO1kB,OAAS,GAGjColB,GAAMC,KAAWtc,EAAAA,EAAAA,UAAS,IAC3Buc,GAASA,KACb,MAAMC,EAAI,IAAIC,KACRC,EAAO1lB,GAAMyM,OAAOzM,GAAG2lB,SAAS,EAAG,KACzC,MAAO,GAAGD,EAAIF,EAAEI,eAAeF,EAAIF,EAAEK,iBAAiBH,EAAIF,EAAEM,iBAExDC,IAASlB,EAAAA,EAAAA,aAAamB,IAE1BV,GAASnf,GAAS,CAChB,CAAED,GAAI7H,KAAKC,SAASC,SAAS,IAAIC,MAAM,GAAIynB,KAAMV,QAAaS,MAC3D7f,GACH3H,MAAM,EAZQ,OAaf,IACG0nB,IAAOrB,EAAAA,EAAAA,aAAY,KACvBJ,EAAW/a,IACT,GAAsB,IAAlBA,EAAEgb,KAAKzkB,OAAc,OAAOyJ,EAChC,MAAMvD,EAAOuD,EAAEgb,KAAKhb,EAAEgb,KAAKzkB,OAAS,GAC9BkmB,EAAUzc,EAAEgb,KAAKlmB,MAAM,GAAI,GAC3B4L,EAAUwa,KAIhB,OAFAE,GAAgB3e,GAChB4f,GAAO,CAAEzZ,KAAM,OAAQmC,MAAO,2BAAQ2X,OAAQ,iDACvC,CAAE1B,KAAMyB,EAASxB,OAAQ,CAACva,KAAYV,EAAEib,YAEhD,CAACG,GAAiBF,GAAcmB,KAC7BM,IAAOxB,EAAAA,EAAAA,aAAY,KACvBJ,EAAW/a,IACT,GAAwB,IAApBA,EAAEib,OAAO1kB,OAAc,OAAOyJ,EAClC,MAAM1C,EAAO0C,EAAEib,OAAO,GAChB2B,EAAa5c,EAAEib,OAAOnmB,MAAM,GAC5B4L,EAAUwa,KAIhB,OAFAE,GAAgB9d,GAChB+e,GAAO,CAAEzZ,KAAM,OAAQmC,MAAO,2BAAQ2X,OAAQ,0CACvC,CAAE1B,KAAM,IAAIhb,EAAEgb,KAAMta,GAAUua,OAAQ2B,MAE9C,CAACxB,GAAiBF,GAAcmB,MAEnCtc,EAAAA,EAAAA,WAAU,KACR,MAAM8c,EAASjf,KACCA,EAAEkf,SAAWlf,EAAEmf,UAED,MAAxBnf,EAAEof,IAAIC,gBACRrf,EAAEsf,iBACEtf,EAAEuf,SAAgBzB,IAASiB,KACpBlB,IAASe,OAIxB,OADAvc,OAAOC,iBAAiB,UAAW2c,GAC5B,IAAM5c,OAAOE,oBAAoB,UAAW0c,IAClD,CAACpB,GAASC,GAASc,GAAMG,KAE5B,MAAMS,GAAYA,CAAClI,EAAQmI,KACzB,MAAMC,EAAQ,GACRC,EAAS,SAACloB,GAAkB,IAAfjB,EAAKkE,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAGjD,EACrB6f,EAAO7f,KAAOgoB,EAAMhoB,IAAIioB,EAAMvjB,KAAK,GAAG3F,KAAS8gB,EAAO7f,WAAMgoB,EAAMhoB,KACxE,EAGA,GAFAkoB,EAAO,MAAO,gBACdA,EAAO,MAAO,sBACVrI,EAAOhF,QAAUmN,EAAMnN,OAASgF,EAAOzF,OAAS4N,EAAM5N,KAAM,CAC9D,MAAMlI,EAAO2N,EAAOhF,QAAUmN,EAAMnN,MAAQmN,EAAMnN,MAAQ,GAAGgF,EAAOhF,cAASmN,EAAMnN,QACnFoN,EAAMvjB,KAAK,KAAKwN,QAAW2N,EAAOzF,aAAQ4N,EAAM5N,OAClD,CACA,GAAIyF,EAAO9E,QAAUiN,EAAMjN,OAAS8E,EAAOxF,OAAS2N,EAAM3N,KAAM,CAC9D,MAAMnI,EAAO2N,EAAO9E,QAAUiN,EAAMjN,MAAQiN,EAAMjN,MAAQ,GAAG8E,EAAO9E,cAASiN,EAAMjN,QACnFkN,EAAMvjB,KAAK,KAAKwN,QAAW2N,EAAOxF,aAAQ2N,EAAM3N,OAClD,CACA,OAAO4N,EAAME,KAAK,YAGpBzd,EAAAA,EAAAA,WAAU,KACR,MAAM3H,EAAOgX,GAAmBC,EAAQtU,GACxC6e,EAAa6D,IACX,MAAMvjB,EAAI9B,EAAKiQ,SAASoV,EAAIvN,OAASuN,EAAIvN,MAAQ9X,EAAK,GAChDslB,EAAQtlB,EAAK,IAAMA,EAAK,GACxB+B,EAAI/B,EAAKiQ,SAASoV,EAAIrN,OAASqN,EAAIrN,MAASlW,IAAMwjB,EAAQtlB,EAAKuJ,KAAKrL,GAAKA,IAAM4D,IAAMA,EAAIwjB,EAC/F,MAAO,CAAExN,MAAOhW,EAAGkW,MAAOjW,MAE3B,CAACkV,EAAQtU,IACZ,MAAM4iB,IAAkB9F,EAAAA,EAAAA,SAAQ,KAC9B,MACMgB,EADQjI,GAAmB2J,EAAO1J,MAAO0J,EAAOzJ,aAAc/V,EAAKsU,EAAQkL,EAAOxJ,aACnEla,IAAK8L,GAAO6O,GAAkB7O,EAAGqO,KAAMuJ,EAAO1J,QACnE,OAAOpa,MAAMC,KAAK,IAAI3C,IAAI8kB,KACzB,CAAC0B,EAAO1J,MAAO0J,EAAOzJ,aAAcyJ,EAAOxJ,YAAahW,EAAKsU,IAC1DuO,IAAgB/F,EAAAA,EAAAA,SAAQ,KAC5B,MAAMgG,EAAO,CAAC,qCAAa,wBAAU,GAAGtD,EAAO1J,MAAMX,eAAgB,GAAGqK,EAAO1J,MAAMT,gBAC/E0N,EAAM,GACZ,IAAIC,EAAS,EACb,IAAK,MAAM/oB,KAAK6oB,EACd,GAAIF,GAAgBtV,SAASrT,KAAO8oB,EAAIzV,SAASrT,GAAI8oB,EAAI/jB,KAAK/E,OACzD,CACH,IADI,IAADgpB,EACID,EAASJ,GAAgBpnB,QAAUunB,EAAIzV,SAASsV,GAAgBI,KAAUA,IACjFD,EAAI/jB,KAA4B,QAAxBikB,EAACL,GAAgBI,UAAO,IAAAC,EAAAA,EAAIhpB,GACpC+oB,GACF,CAEF,KAAOD,EAAIvnB,OAAS,GAAG,CACrB,IADsB,IAAD0nB,EAAAC,EACdH,EAASJ,GAAgBpnB,QAAUunB,EAAIzV,SAASsV,GAAgBI,KAAUA,IACjFD,EAAI/jB,KAAoD,QAAhDkkB,EAA0B,QAA1BC,EAACP,GAAgBI,YAAS,IAAAG,EAAAA,EAAIP,GAAgB,UAAE,IAAAM,EAAAA,EAAI,yCAC9D,CACA,OAAOH,EAAIhpB,MAAM,EAAG,IACnB,CAAC6oB,GAAiBpD,EAAO1J,MAAMX,MAAOqK,EAAO1J,MAAMT,SAC/C+N,GAAWC,KAAgB9e,EAAAA,EAAAA,UAASse,KAC3C7d,EAAAA,EAAAA,WAAU,KACRqe,GAAc3hB,IACZ,MAAMa,EAAOb,EAAK5F,IAAI,CAACyK,EAAG1K,KAAC,IAAAynB,EAAAC,EAAA,OAAMX,GAAgBtV,SAAS/G,GAAKA,EAA4C,QAA3C+c,EAAqB,QAArBC,EAAGX,GAAgB/mB,UAAE,IAAA0nB,EAAAA,EAAIX,GAAgB,UAAE,IAAAU,EAAAA,EAAI/c,IACzGzG,EAAO,IAAI9G,IACjB,IAAK,IAAI6C,EAAI,EAAGA,EAAI0G,EAAK/G,OAAQK,IAAK,CACpC,IAAKiE,EAAK9E,IAAIuH,EAAK1G,IAAK,CAAEiE,EAAKtH,IAAI+J,EAAK1G,IAAK,QAAU,CACvD,MAAM2nB,EAAcZ,GAAgBhc,KAAM6c,IAAO3jB,EAAK9E,IAAIyoB,IACtDD,IAAejhB,EAAK1G,GAAK2nB,EAAa1jB,EAAKtH,IAAIgrB,GACrD,CACA,OAAOjhB,KAER,CAACqgB,KACJ,MAAOc,GAAYC,KAAiBpf,EAAAA,EAAAA,UAAS,OACtCqf,GAAWC,KAAgBtf,EAAAA,EAAAA,UAAS,OACpCuf,GAAaC,KAAkBxf,EAAAA,EAAAA,WAAS,GACzCyf,IAAWvf,EAAAA,EAAAA,QAAO,GAClBwf,IAAWxf,EAAAA,EAAAA,QAAO,MAElByf,IAASzf,EAAAA,EAAAA,QAAO,OACf0f,GAASC,KAAc7f,EAAAA,EAAAA,UAAS,OACvC4B,EAAAA,EAAAA,iBAAgB,KACd,MAAMke,EAASA,KACTH,GAAOve,SACTye,GAAWF,GAAOve,QAAQ2e,eAK9B,OAFAD,IACAnf,OAAOC,iBAAiB,SAAUkf,GAC3B,IAAMnf,OAAOE,oBAAoB,SAAUif,IAEjD,CAAC7E,EAAQ4D,GAAWQ,GAAWF,GAAY/D,EAAYT,EAAWJ,EAAaE,IAElF,MACMuF,GAAM,MACNC,IAA+BpE,EAAAA,EAAAA,aAAY,CAACtC,EAAQ2G,EAAUC,EAAOC,EAAWC,EAAUC,EAAOjT,KACrG,IAAIkT,EAAM,EAAGC,EAAM,EACnB,IAAK,MAAMC,KAAMlH,EAAQ,CACvB,MAAM1D,EAAK1D,GAAYsO,EAAIJ,EAAS9O,OAAQ,IAAKsE,EAAI,SACrD,GAAgB,aAAZA,EAAGlE,KAAqB,CAE1B,KADW7B,GAAmBoQ,EAAU,6BAASroB,OAAQb,GAAMA,IAAMqpB,EAAS9O,MAAMT,OAAS9Z,IAAMqpB,EAAS9O,MAAMX,OAAO3Z,OAAS,GACzH,QACX,CACA,GAAgB,aAAZ4e,EAAGlE,KAAqB,CAE1B,KADW7B,GAAmBoQ,EAAU,6BAASroB,OAAQb,GAAMA,IAAMqpB,EAAS9O,MAAMX,OAAS5Z,IAAMqpB,EAAS9O,MAAMT,OAAO7Z,OAAS,GACzH,QACX,CACA,MAAMye,EAAMlD,GAAU0N,EAAUC,EAAOE,EAAS9O,MAAOsE,EAAIwK,EAAS5O,YAAa,IAEvErE,EAAQC,EAAOP,EAAO2T,GAAtBrT,IAEJsT,EAAa,CACjBlP,aAAc6O,EAAS7O,aAAe,EACtC+B,QAAS8M,EAAS9M,QAAUmC,EAAI7C,YAChCyC,UAAU,EACV7D,YAAaiE,EAAI9C,SACjBwC,KAAMiL,EAASjL,KAAOM,EAAI/C,gBAC1BpB,MAAOmE,EAAI1X,MAgBbuiB,GAdUnN,GACR8M,EAAUC,EAAOC,EAAWM,EAAWnP,MAAO+O,EAAO,aACrDI,EAAWlP,aAAckP,EAAWnN,QAASmN,EAAWjP,YAAaiP,EAAWpL,SAAU,GAC1FjI,EAAOP,EAAO2T,GAAKjQ,EACnB,CACEmD,UAAWte,KAAK+D,IAAI,IAAM0hB,GAC1BhH,UAAWze,KAAK+D,IAAI,IAAM0hB,GAC1BlH,QAAS,KACTC,MAAO,IACPE,UAAW,WACXC,cAAepH,EACfqH,eAAe,IAGVjB,YAAawN,GAAO,CAC/B,CACA,OAAOA,EAAMD,EAAMC,EAAM,GACxB,CAAChQ,EAAUsK,IACd,SAAS6F,GAAmBtT,EAAM6S,EAAUC,EAAOE,GACjD,MAAM3N,EAAMtF,EAAQC,GAEdoI,EAAO,IADAnE,GAAmB+O,EAAS9O,MAAO8O,EAAS7O,aAAc2O,EAAOD,EAAUG,EAAS5O,cAE3F+M,EAAM,GACNrJ,EAAqBpe,IACzB,MAAMud,EAAMvd,EAAIoB,OAAO,CAACyC,EAAGC,IAAMD,EAAIC,EAAEnF,EAAG,GAC1C,IAAI6L,EAAImR,IAAQ4B,EAChB,IAAK,IAAIhd,EAAI,EAAGA,EAAIP,EAAIE,OAAQK,IAAsB,GAAfiK,GAAKxK,EAAIO,GAAG5B,EAAO6L,GAAK,EAAG,OAAOjK,EACzE,OAAOP,EAAIE,OAAS,GAEhBD,EAAI3B,KAAK+D,IAAI,EAAGqc,EAAKxe,QAC3B,IAAK,IAAIK,EAAI,EAAGA,EAAIN,EAAGM,IAAK,CAAE,MAAMJ,EAAMie,EAAkBM,GAAO+I,EAAI/jB,KAAKgb,EAAKve,GAAKwa,MAAO+D,EAAKhL,OAAOvT,EAAK,EAAI,CAClH,OAAOsnB,CACT,CACA,SAASoC,GAAcC,EAAOzoB,GAAK,OAAOyoB,EAAMtpB,IAAKse,GAAO3D,GAAkB2D,EAAIzd,GAAK,CACvF,MAAM0oB,IAAevI,EAAAA,EAAAA,SAAQ,KAC3B,IAAK0C,EAAO3F,SAAU,MAAO,CAAEyL,cAAc,EAAOC,OAAQ,uJAC5D,GAAI/F,EAAO1H,SAAW,EAAG,MAAO,CAAEwN,cAAc,EAAOC,OAAQ,0EAC/D,GAAI/F,EAAOzJ,cAAgB,EAAG,MAAO,CAAEuP,cAAc,EAAOC,OAAQ,+IACpE,MAAMZ,EAAoB,8BAAR3kB,EAAkB,UAAYse,EAC1CkH,EAAW/T,EAAsB,CAAE6C,SAAQtU,MAAKoe,SAAQoB,SAAQb,MAAKyE,aAAWuB,YAAWc,KAAM,cACjGC,EAAUlB,GAA6BpB,GAAW9O,EAAQtU,EAAK2kB,EAAWnF,EAAQb,EAAK6G,EAAW,GACxG,IAAIV,EAAM,EACV,IAAK,IAAIjpB,EAAI,EAAGA,EApEK,GAoEeA,IAAK,CACvC,MAAM+V,EAAO4T,EAAW,IAAW,GAAJ3pB,EACzB8pB,EAAoB,IAAKnG,EAAQ1H,QAAS0H,EAAO1H,QAAU,GAE3D8N,EAAYT,GADDD,GAAmBtT,EAAM0C,EAAQtU,EAAK2lB,GACbA,EAAkB7P,OAE5DgP,GADaN,GAA6BoB,EAAWtR,EAAQtU,EAAK2kB,EAAWgB,EAAmBhH,EAAK/M,EAAO,GAE9G,CACA,MAAMiU,EAAaf,EA5EE,GA6Ef3O,EAAQ0P,EAAaH,EACrBlS,EAAO5S,IAAW,IAAJA,GAAS+P,QAAQ,GAAK,IAC1C,OAAIwF,EAAQoO,GACH,CAAEe,cAAc,EAAMC,OAAQ,wHAA8B/R,EAAIkS,iEAA0BlS,EAAIqS,aAAiBrS,EAAI2C,QACjHA,GAASoO,GACX,CAAEe,cAAc,EAAOC,OAAQ,8HAA+B/R,EAAIkS,gEAAyBlS,EAAIqS,sCAAsBrS,GAAK2C,QAE1H,CAAEmP,cAAc,EAAOC,OAAQ,+DAAkB/R,EAAIkS,gDAAwBlS,EAAIqS,kBAAsB,IAAYlV,QAAQ,UAEnI,CAAC2D,EAAQtU,EAAKoe,EAAQoB,EAAQb,EAAKyE,GAAW9E,EAAekG,KA2HhE,SAASsB,KACP,IAAKnG,EAAY,OACjB,IAAKoG,GAAmE,YAAtD/mB,EAAK,iKAAqC,WAC5DuhB,KACA,MAAMrJ,EACJnE,KAA4C,IAAxByM,EAAOxJ,YAAqB,EAA2B,IAAvBwJ,EAAOxJ,YAAoB,EAAI,GAC/EmE,EAAS,IAAKqF,EAAO1J,OAC3B2J,EAAWC,IACT,MAAMnd,EAAO,IAAKmd,EAAE5J,OAGpB,MAFuB,MAAnB6J,EAAWqG,IAAazjB,EAAK4S,MAAQ0K,EACpCtd,EAAK8S,MAAQwK,EACX,CACL9J,aAAc2J,EAAE3J,aAAe,EAC/B+B,QAAS4H,EAAE5H,QACX+B,UAAU,EACV7D,YAAa0J,EAAE1J,YACf2D,KAAM+F,EAAE/F,KAAOzC,EACfpB,MAAOvT,KAGX,MAAM+f,EAAQ,IAAK9C,EAAO1J,SAA8B,MAAnB6J,EAAWqG,IAAc,CAAE7Q,MAAO0K,GAAe,CAAExK,MAAOwK,IAC/FyB,GAAO,CACLzZ,KAAM,SACNmC,MAAO,2CAAa2V,EAAWqG,eAAUnG,IACzC8B,OAAQU,GAAUlI,EAAQmI,GAC1B2D,KAAM,CAAEC,KAAMhP,KAEhB0I,EAAc,MACd5gB,EAAK,oFAAoB,UAC3B,CACA,SAASmnB,KACPvG,EAAc,MACd5gB,EAAK,wEAAkB,UACzB,EA1JAgG,EAAAA,EAAAA,WAAU,KACR,GAAsB,SAAlBsZ,GAAoC,8BAARte,EAAiB,OACjD,MAAM9F,EAAOma,GAAmBC,EAAQtU,GACxC6e,EAAand,IACX,MAAMvC,EAAIjF,EAAKoT,SAAS5L,EAAKyT,QAAyB,6BAAfzT,EAAKyT,MAAmBzT,EAAKyT,MAAQjb,EAAK,GAC3EksB,EAAalsB,EAAK0M,KAAMrL,GAAMA,IAAM4D,IAAMjF,EAAK,GAC/CkF,EAAIlF,EAAKoT,SAAS5L,EAAK2T,QAAyB,6BAAf3T,EAAK2T,OAAoB3T,EAAK2T,QAAUlW,EAAIuC,EAAK2T,MAAQ+Q,EAChG,MAAO,CAAEjR,MAAOhW,EAAGkW,MAAOjW,MAE3B,CAACkf,EAAehK,EAAQtU,KAE3BgF,EAAAA,EAAAA,WAAU,KACR,IAAKka,IAAcE,EAAqD,OAAzCuE,GAAc,WAAOE,GAAa,MACjE,GAAIhG,GAAmBuF,IAErB,OADAO,GAAc,WAAOE,GAAa,MAGpC,MAAM7L,EAAoBoL,GAAUtnB,IAAKkpB,GAAOtO,GAAYsO,EAAIxF,EAAO1J,QAAQ1Z,OAAQwE,KAAQA,GAEzF+jB,EAAoB,8BAAR3kB,EAAkB,UAAYse,EAC1CkH,EAAW/T,EAAsB,CAAE6C,SAAQtU,MAAKoe,SAAQoB,SAAQb,MAAK3G,oBAAmBqO,SAFrE,8BAARrmB,EAAkB,YAAcse,IAG3CgI,IAAUtC,GAASre,QA6BzB,OA5BAoe,IAAe,GAEXE,GAASte,SAASwG,aAAa8X,GAASte,SAC5Cse,GAASte,QAAUyF,WAAW,KAC5B,MAAMmb,EAAa,CACjBrO,UAAWmH,EACXhH,UAAWgH,EACXlH,QAAShE,GAAgBkL,GACzBjH,MAAOhE,GAAciL,GACrB/G,UAAW,WACXC,cAAepH,EACfqH,cAAepH,EACfqH,oBAAqB,IACrBE,UAAW,CAAC,MAER6N,EAAO7O,GACXrD,EAAQtU,EAAK2kB,EAAWnF,EAAO1J,MAAO6I,EAAK,kBAC3Ca,EAAOzJ,aAAcyJ,EAAO1H,QAAS0H,EAAOxJ,YAAawJ,EAAO3F,SAAU7B,EAAmBwN,EAAW,IAAKzQ,EAC7GwR,GAEIE,EAAM9O,GACVrD,EAAQtU,EAAK2kB,EAAWnF,EAAO1J,MAAO6I,EAAK,aAC3Ca,EAAOzJ,aAAcyJ,EAAO1H,QAAS0H,EAAOxJ,YAAawJ,EAAO3F,SAAU7B,EAAmBwN,EAAW,IAAKzQ,EAC7GwR,GAEED,IAAUtC,GAASre,UAAWge,GAAc6C,GAAO3C,GAAa4C,GAAM1C,IAAe,KACxF,GAEI,KACDE,GAASte,UACXwG,aAAa8X,GAASte,SACtBse,GAASte,QAAU,QAGtB,CAAC2O,EAAQtU,EAAKoe,EAAQgB,EAAUI,EAAQb,EAAKO,EAAWkE,GAAW9E,EAAevJ,EAAUsK,KAoG/Fra,EAAAA,EAAAA,WAAU,KAAQ/B,SAAS+G,MAAQ,gFAAuB,IAC1D,MAAM6C,GAAO,4CACPE,GAAW,mCACXH,GAAe,4CACfyZ,GAAmB,8BAARrmB,EAAkB,YAAcse,EAG3CoI,GAAkC,IAAvBlH,EAAOxJ,YAAoB,SAAkC,IAAxBwJ,EAAOxJ,YAAqB,QAAU,KACtF+P,GAAYjH,GAAeE,GAAaE,EACxCyH,GAAS9I,GAAmBuF,IAE5BwD,IAAe9J,EAAAA,EAAAA,SACnB,IAAMsC,IAAa0E,MAAiBF,IAAaF,KACjD,CAACtE,EAAU0E,GAAaF,GAAWF,KAE/BmD,IAAkBd,IAAaY,MAAYhH,GAAcH,EAAOzJ,cAAgB,EAChF+Q,IAAkBf,MAAepG,GAAcH,EAAOzJ,cAAgB,GAAKyJ,EAAO1H,SAAW,EAC7FiP,IAAetiB,EAAAA,EAAAA,SAAO,IAE5BO,EAAAA,EAAAA,WAAU,KACH+gB,KACHlF,GAAQ,IACRb,EAAW,CAAEC,KAAM,GAAIC,OAAQ,OAEhC,CAAC6F,MACJ/gB,EAAAA,EAAAA,WAAU,KACJ2hB,GACGI,GAAaphB,UAChB3G,EAAK,yGACL+nB,GAAaphB,SAAU,GAGzBohB,GAAaphB,SAAU,GAExB,CAACghB,GAAQ3nB,IACZ,MAAMgoB,IAAalK,EAAAA,EAAAA,SAAQ,KACzB,MAAM5iB,EAAOma,GAAmBC,EAAQtU,GACxC,MAAY,8BAARA,EAAwB9F,EACH,YAAlBokB,EAA8B,CAAC,8BAAWpkB,GAAQA,GACxD,CAACoa,EAAQtU,EAAKse,IACjB,OACErW,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wCAAwCqD,MAAO,CAAEsG,gBAAiB,4CAA6CC,qBAAsB,SAAUzK,SAAA,EAC5JC,EAAAA,EAAAA,KAAA,SAAAD,SAAQ,8LAKR0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,2CAA0Cb,SAAA,EACvDC,EAAAA,EAAAA,KAAA,WAASY,UAAU,eAAcb,UAC/B0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oDAAmDb,SAAA,EAChEC,EAAAA,EAAAA,KAAA,MAAIY,UAAU,+GAA8Gb,SAAC,qGAG7H0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,iDAAgDb,SAAA,EAC7DC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,yCAAwCb,SAAC,iDACzDC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gBAAeb,UAC5BC,EAAAA,EAAAA,KAACO,GAAQ,CACP3K,MAAOimB,EACPnb,SAAUob,EACVrb,MAAO8P,GACP5P,YAAY,mCACZ0Y,UAAU,eAQpB5U,EAAAA,EAAAA,MAAA,WAAS7D,UAAW,GAAGyI,WAAatJ,SAAA,EAClC0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,+BAE7BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,kCAAiCb,SAC7Cub,GACC7W,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EACEC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,yCAAwCb,SAAC,oDACzD0E,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,IAAMiX,GAAe,GAC9B3a,UAAU,gGAA+Fb,SAAA,EAEzGC,EAAAA,EAAAA,KAACyjB,EAAAA,EAAK,CAAC9e,KAAM,KAAM,kCAKvBF,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,IAAMiX,GAAe,GAC9B3a,UAAU,gGAA+Fb,SAAA,EAEzGC,EAAAA,EAAAA,KAAC0jB,EAAAA,EAAI,CAAC/e,KAAM,KAAM,oCAO1B3E,EAAAA,EAAAA,KAAA,OAAKY,UAAU,OAAMb,UACnB0E,EAAAA,EAAAA,MAAA,OACE7D,UAAU,2KAMrBb,SAAA,EAGW0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,qDAAoD0a,EAAc,aAAe,IAAKvb,SAAA,EACpGC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,yBAC5BC,EAAAA,EAAAA,KAACO,GAAQ,CACPK,UAAU,SACVhL,MAAOkb,EACPpQ,SAAWqC,GAAM2X,EAAU3X,GAC3BtC,MAAO9J,OAAOC,KAAKiY,IAAWvW,IAAKxB,IAAC,CAAQlB,MAAOkB,EAAGjB,MAAOiB,KAC7D6J,YAAY,sBACZ4D,SAAU+W,QAId7W,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,qDAAoD0a,EAAc,aAAe,IAAKvb,SAAA,EACpGC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,kBAC5BC,EAAAA,EAAAA,KAACO,GAAQ,CACPK,UAAU,SACVhL,MAAOglB,EACPla,SAAWqC,GAAM8X,EAAU9X,GAC3BtC,MAAO,CAAC,eAAM,eAAM,gBAAMnI,IAAKxB,IAAC,CAAQlB,MAAOkB,EAAGjB,MAAOiB,KACzD6J,YAAY,eACZ4D,SAAU+W,QAId7W,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0DAAyDb,SAAA,EACtEC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,sEAC5B0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0EAAyEb,SAAA,CAAC,8BACjFC,EAAAA,EAAAA,KAAA,KAAGY,UAAU,OAAMb,SAAEiP,GAAgB4L,KAAY,+CAAY,KACnE5a,EAAAA,EAAAA,KAAA,KAAGY,UAAU,OAAMb,SAAEqP,GAAoBwL,KAAY,wBAO/DnW,EAAAA,EAAAA,MAAA,WAAS7D,UAAWyI,GAAKtJ,SAAA,EACvB0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,4CAC7BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,kCAAiCb,SAC7Cyb,GACC/W,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EACEC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,yCAAwCb,SAAC,oDAGzD0E,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,IAAMmX,GAAa,GAC5B7a,UAAU,gGAA+Fb,SAAA,EAEzGC,EAAAA,EAAAA,KAACyjB,EAAAA,EAAK,CAAC9e,KAAM,KAAM,kCAKvBF,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,IAAMmX,GAAa,GAC5B7a,UAAU,gGAA+Fb,SAAA,EAEzGC,EAAAA,EAAAA,KAAC0jB,EAAAA,EAAI,CAAC/e,KAAM,KAAM,oCAO1B3E,EAAAA,EAAAA,KAAA,OAAKY,UAAU,OAAMb,UACnB0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,4KAM1Bb,SAAA,EAEa0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAqC4a,EAAY,aAAe,IAAKzb,SAAA,EACnFC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,qCAC5BC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOkiB,EAAI9G,IACX4I,IAAM7W,GAAMmY,EAAO,IAAKpD,EAAK9G,IAAK/K,GAAMlD,EAAGsM,GAAUC,MACrDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUiX,QAId/W,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAqC4a,EAAY,aAAe,IAAKzb,SAAA,EACnFC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,wBAC5BC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOkiB,EAAI7G,IACX2I,IAAM7W,GAAMmY,EAAO,IAAKpD,EAAK7G,IAAKhL,GAAMlD,EAAGsM,GAAUC,MACrDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUiX,QAId/W,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAqC4a,EAAY,aAAe,IAAKzb,SAAA,EACnFC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,oBAC5BC,EAAAA,EAAAA,KAACga,GAAM,CACLpkB,MAAOkiB,EAAInG,MACXiI,IAAM7W,GAAMmY,EAAO,IAAKpD,EAAKnG,MAAO5O,IACpCkX,QAASgB,EACT1W,SAAUiX,EACV7a,YAAa6a,EAAY,gCAASxhB,QAItCyK,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAqC4a,EAAY,aAAe,IAAKzb,SAAA,EACnFC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,iCAC5BC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOkiB,EAAI5G,KACX0I,IAAM7W,GAAMmY,EAAO,IAAKpD,EAAK5G,KAAMjL,GAAMlD,EAAGsM,GAAUC,MACtDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUiX,QAId/W,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAqC4a,EAAY,aAAe,IAAKzb,SAAA,EACnFC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,oBAC5BC,EAAAA,EAAAA,KAACga,GAAM,CACLpkB,MAAOkiB,EAAIjG,MACX+H,IAAM7W,GAAMmY,EAAO,IAAKpD,EAAKjG,MAAO9O,IACpCkX,QAASgB,EAAgBriB,OAAQb,GAAMA,IAAM+f,EAAInG,OACjDpN,SAAUiX,EACV7a,YAAa6a,EAAY,gCAASxhB,QAItCyK,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAqC4a,EAAY,aAAe,IAAKzb,SAAA,EACnFC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,iCAC5BC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOkiB,EAAI3G,KACXyI,IAAM7W,GAAMmY,EAAO,IAAKpD,EAAK3G,KAAMlL,GAAMlD,EAAGsM,GAAUC,MACtDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUiX,gBAOpB/W,EAAAA,EAAAA,MAAA,WAAS7D,UAAWyI,GAAKtJ,SAAA,EACvB0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,4CAE7BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,4CAA2Cb,SAEvD2b,GACCjX,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EACEC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,yCAAwCb,SAAC,oDACzD0E,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,IAAMqX,GAAa,GAC5B/a,UAAU,gGAA+Fb,SAAA,EAEzGC,EAAAA,EAAAA,KAACyjB,EAAAA,EAAK,CAAC9e,KAAM,KAAM,kCAKvBF,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACLC,QAASA,IAAMqX,GAAa,GAC5B/a,UAAU,gGAA+Fb,SAAA,EAEzGC,EAAAA,EAAAA,KAAC0jB,EAAAA,EAAI,CAAC/e,KAAM,KAAM,oCAM1BF,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,yCAAwC8a,GAAqB,8BAARlf,EAAkB,aAAe,IAAKuD,SAAA,EACzGC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,wBAAuBb,SAAC,4CACxC0E,EAAAA,EAAAA,MAAA,SAAO7D,UAAU,iCAAgCb,SAAA,EAC/CC,EAAAA,EAAAA,KAAA,SACEqE,KAAK,QACLmI,QAA2B,YAAlBsO,EACTpa,SAAUA,IAAMqa,EAAiB,WACjCxW,SAAUmX,GAAqB,8BAARlf,EACvBoE,UAAU,mBACV,2BAGJ6D,EAAAA,EAAAA,MAAA,SAAO7D,UAAU,iCAAgCb,SAAA,EAC/CC,EAAAA,EAAAA,KAAA,SACEqE,KAAK,QACLmI,QAA2B,SAAlBsO,EACTpa,SAAUA,IAAMqa,EAAiB,QACjCxW,SAAUmX,GAAqB,8BAARlf,EACvBoE,UAAU,mBACV,iBAKNZ,EAAAA,EAAAA,KAAA,OAAKY,UAAU,OAAMb,UACnB0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wKAM1Bb,SAAA,EAEa0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,mDAAkD8a,EAAY,aAAe,IAAK3b,SAAA,EAChGC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,4CAC5BC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOulB,EAAInK,IACX4I,IAAM7W,GAAMqY,EAAO,IAAKD,EAAKnK,IAAK/K,GAAMlD,EAAGsM,GAAUC,MACrDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUmX,QAIdjX,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,mDAAkD8a,EAAY,aAAe,IAAK3b,SAAA,EAChGC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,+BAC5BC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOulB,EAAIlK,IACX2I,IAAM7W,GAAMqY,EAAO,IAAKD,EAAKlK,IAAKhL,GAAMlD,EAAGsM,GAAUC,MACrDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUmX,QAIdjX,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,+DAA8D8a,EAAY,aAAe,IAAK3b,SAAA,EAC5GC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,+BAC5BC,EAAAA,EAAAA,KAACO,GAAQ,CACPK,UAAU,sBACVhL,MAAO4G,EACPkE,SAAWqC,GAAM4X,EAAO5X,GACxBtC,MAAO,CAAC,4BAAS,qBAAO,sBAAOnI,IAAIxB,IAAC,CAAOlB,MAAOkB,EAAGjB,MAAOiB,KAC5D6J,YAAY,4BACZ4D,SAAUmX,OAGb,MACC,MAAMiI,EAAkBjI,GAAqB,8BAARlf,EAC/BonB,EAAiBD,GAAqC,SAAlB7I,EACpC+I,EAASF,EAAkB,aAAe,GAC1CG,EAAUF,EAAiB,aAAe,GAChD,OACEnf,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EAEE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAqC8a,GAAqB,8BAARlf,EAAkB,aAAe,IAAKuD,SAAA,EACtGC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,iCAC5BC,EAAAA,EAAAA,KAACga,GAAM,CACLpkB,MAAO2b,EAASI,MAChBiI,IAAM7W,GAAMsY,EAAaxiB,IAAC,IAAWA,EAAG8Y,MAAO5O,KAC/CkX,QAA2B,SAAlBa,EACL0I,GAAW5qB,OAAQb,GAAMA,IAAMwZ,EAASM,OACxC2R,GACJjf,SAAUmX,GAAqB,8BAARlf,QAI3BiI,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,kDAAkDijB,IAAS9jB,SAAA,EACzEC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SA9W7B,qDA+WEC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOulB,EAAIjK,KACX0I,IAAM7W,GAAMqY,EAAO,IAAKD,EAAKjK,KAAMjL,GAAMlD,EAAGsM,GAAUC,MACtDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUof,QAIdlf,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,sCAAsC8a,GAAqB,8BAARlf,GAAqC,SAAlBse,EAA4B,aAAe,IAAK/a,SAAA,EACpIC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SAAC,iCAC5BC,EAAAA,EAAAA,KAACga,GAAM,CACLpkB,MAAO2b,EAASM,MAChB+H,IAAM7W,GAAMsY,EAAaxiB,IAAC,IAAWA,EAAGgZ,MAAO9O,KAC/CkX,QAA2B,SAAlBa,EACL0I,GAAW5qB,OAAQb,GAAMA,IAAMwZ,EAASI,OACxC6R,GACJjf,SAAUmX,GAAqB,8BAARlf,GAAqC,SAAlBse,QAI9CrW,EAAAA,EAAAA,MAAA,OAAK7D,UAAW,kDAAkDkjB,IAAU/jB,SAAA,EAC1EC,EAAAA,EAAAA,KAAA,SAAOY,UAAW2I,GAASxJ,SApY7B,qDAqYEC,EAAAA,EAAAA,KAACsF,GAAW,CACV1P,MAAOulB,EAAIhK,KACXyI,IAAM7W,GAAMqY,EAAO,IAAKD,EAAKhK,KAAMlL,GAAMlD,EAAGsM,GAAUC,MACtDnV,IAAKkV,GACL7U,IAAK8U,GACL/K,SAAUqf,SAKnB,EAvDA,YA2DPnf,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sDAAqDb,SAAA,EAElE0E,EAAAA,EAAAA,MAAA,WAAShB,IAAKid,GAAQ9f,UAAW,iBAAmByI,GAAKtJ,SAAA,EAEvD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,iDAC7BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,kCAAiCb,UAC9C0E,EAAAA,EAAAA,MAAA,UACEH,QAzchB,WACE+Y,GAAQ,IACRb,EAAW,CAAEC,KAAM,GAAIC,OAAQ,KAC/BT,EAAU,CAAE1J,aAAcvD,GAAgB4L,GAAStG,QAASlF,GAAoBwL,GAASvE,UAAU,EAAO7D,YAAa,EAAG2D,KAAM,EAAG7D,MAAO,IAAKwF,IACjJ,EAscgBlX,UAAU,gGAA+Fb,SAAA,EAEzGC,EAAAA,EAAAA,KAACiN,EAAAA,EAAS,CAACtI,KAAM,KAAM,6DAM7BF,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6BAA4Bb,SAAA,CAAC,6EACxBC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,+DAAiB,oDAExC0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,aAAYb,SAAA,EAEzB0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,iCAAgCb,SAAA,EAC7CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAC,sCAE5C0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,iCAAgCb,SAAA,EAC7C0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,yFAAwFb,SAAA,EACrGC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wBAAuBb,SAAC,qCACvCC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wBAAuBb,SAAEic,EAAO1J,MAAMtB,UAEvDvM,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,yFAAwFb,SAAA,EACrGC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wBAAuBb,SAAC,qDACvCC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wBAAuBb,SAAEic,EAAO1J,MAAMrB,UAGrDjR,EAAAA,EAAAA,KAAA,OAAKY,UAAU,yFAAwFb,SAChF,OAAV,OAAVoc,QAAU,IAAVA,OAAU,EAAVA,EAAYqG,MACX/d,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,SAAQb,UACrBC,EAAAA,EAAAA,KAACga,GAAM,CACLpkB,MAAOymB,EACPzC,IAAK0C,EACLrC,QAASkC,EAAWlC,aAGxBxV,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,yBAAwBb,SAAA,EACrCC,EAAAA,EAAAA,KAAA,UAAQsE,QAASge,GACf1hB,UAAU,yEAAwEb,SAAC,kBAGrFC,EAAAA,EAAAA,KAAA,UAAQsE,QAASqe,GACf/hB,UAAU,+DAA8Db,SAAC,wBAM/E0E,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wBAAuBb,SAAEic,EAAO1J,MAAMX,SACrDlN,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wBAAuBb,SAAA,CAAC,OAAKic,EAAO1J,MAAMpB,cAM/DlR,EAAAA,EAAAA,KAAA,OAAKY,UAAU,yFAAwFb,SAChF,OAAV,OAAVoc,QAAU,IAAVA,OAAU,EAAVA,EAAYqG,MACX/d,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,SAAQb,UACrBC,EAAAA,EAAAA,KAACga,GAAM,CACLpkB,MAAOymB,EACPzC,IAAK0C,EACLrC,QAASkC,EAAWlC,aAGxBxV,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,yBAAwBb,SAAA,EACrCC,EAAAA,EAAAA,KAAA,UAAQsE,QAASge,GACf1hB,UAAU,yEAAwEb,SAAC,kBAGrFC,EAAAA,EAAAA,KAAA,UAAQsE,QAASqe,GACf/hB,UAAU,+DAA8Db,SAAC,wBAM/E0E,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EACEC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wBAAuBb,SAAEic,EAAO1J,MAAMT,SACrDpN,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wBAAuBb,SAAA,CAAC,OAAKic,EAAO1J,MAAMnB,iBAOnE1M,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,uDAAsDb,SAAA,CAClEic,EAAOzJ,cAAgB,GACtBvS,EAAAA,EAAAA,KAAA,OAAKY,UAAU,qIAAoIb,SAAC,oEAIpJ0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,kDAAiDb,SAAA,EAC9D0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,8CAA6Cb,SAAA,CAAC,2CAClDC,EAAAA,EAAAA,KAAA,KAAGY,UAAU,OAAMb,SAAEic,EAAOzJ,mBAEvC9N,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,8CAA6Cb,SAAA,CAAC,2CAClDC,EAAAA,EAAAA,KAAA,KAAGY,UAAU,OAAMb,SAAEic,EAAO1H,cAEvC7P,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,8CAA6Cb,SAAA,CAAC,wDAC/CC,EAAAA,EAAAA,KAAA,KAAGY,UAAU,OAAMb,SAAEmjB,YAIvCze,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,8CAA6Cb,SAAA,CAAC,8BACrDC,EAAAA,EAAAA,KAAA,KAAGY,UAAU,OAAMb,SAAE6P,GAAOoM,EAAO7F,QAAU,eAKzD1R,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,sCAAqCb,SAAA,EAClDC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAC,gEAC5CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,wCAAuCb,SACnD6f,GAAUtnB,IAAI,CAACzC,EAAOoC,KACrBwM,EAAAA,EAAAA,MAAA,OAAe7D,UAAU,iDAAgDb,SAAA,EACvE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6BAA4Bb,SAAA,CAAC,gBAAI9H,EAAM,MACtDwM,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAACga,GAAM,CACLpkB,MAAOC,EACP+jB,IAAM7W,IACJ,MAAMghB,EAAK,IAAInE,IACfmE,EAAG9rB,GAAO8K,EACV8c,GAAakE,IAEf9J,QAASmF,MAEXpf,EAAAA,EAAAA,KAAA,UACEsE,QAASA,IApoBjC,SAAqB0f,GACnB,IAAKzB,GAA8E,YAAjE/mB,EAAK,qMAAgD,WAEvE,GADAuhB,MACKrB,EAAyC,YAA5BlgB,EAAK,uFACvB,GAAIwgB,EAAOzJ,cAAgB,EAAG,OAC9B,GAAI8H,GAAmBuF,IAA6C,YAA/BpkB,EAAK,yGAC1C,MAAM3F,EAAQ+pB,GAAUoE,GACxB,IAAK5E,GAAgBtV,SAASjU,GAA8C,YAApC2F,EAAK,6HAC7C,MAAMyoB,EAAS/Q,GAAYrd,EAAOmmB,EAAO1J,OACzC,IAAK2R,EAAkC,YAAxBzoB,EAAK,oEAEpB,GAAoB,aAAhByoB,EAAOvR,MAAuC,aAAhBuR,EAAOvR,KAAqB,CAC5D,MACM7Y,EADQgX,GAAmBC,EAAQ,6BACtBlY,OAAQb,GAAMA,IAAMikB,EAAO1J,MAAMX,OAAS5Z,IAAMikB,EAAO1J,MAAMT,OAChF,OAAIhY,EAAK7B,QAAU,OAAKwD,EAAK,oIAC7B4gB,EAAc,CAAEoG,IAAqB,aAAhByB,EAAOvR,KAAsB,IAAM,IAAKuH,QAASpgB,IACtEyiB,EAAcziB,EAAK,SACnB2B,EAAK,2NAAkD,QAEzD,CACA,GAAIwgB,EAAOzJ,cAAgB,EAEzB,YADA/W,EAAK,gHAA4B,WAGnC,MAAMmb,EAAS,IAAKqF,EAAO1J,OACrBmE,EAAMlD,GAAUzC,EAAQtU,EAAKwf,EAAO1J,MAAO2R,EAAQjI,EAAOxJ,aAC1D0R,EAAmBlI,EAAOzJ,aAAe,EAC/C0J,EAAWC,IAAC,CACV3J,aAAc2R,EACd5P,QAAS4H,EAAE5H,QAAUmC,EAAI7C,YACzByC,UAAU,EACV7D,YAAaiE,EAAI9C,SACjBwC,KAAM+F,EAAE/F,KAAOM,EAAI/C,gBACnBpB,MAAOmE,EAAI1X,QAEb+e,GAAO,CACLzZ,KAAM,QACNmC,MAAO,gBAAMwd,EAAU,mBAASnuB,IAChCsoB,OAAQU,GAAUlI,EAAQF,EAAI1X,MAC9B0jB,KAAM,CAAEC,KAAMjM,EAAI/C,gBAAiBnB,aAAc2R,EAAkBtQ,YAAa6C,EAAI7C,eAElFsQ,EAAmB,GACrB1oB,EAAK,6MAA8C,UAEvD,CAwlBuC2oB,CAAYlsB,GAC3B,gBAAeorB,GACfziB,UAAW,wOAETyiB,GAAiB,gCAAkC,kCACnDF,GAAS,gCAAkC,KAAKpjB,SACnD,sBAnBK9H,OA0BdwM,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,yCAAwCb,SAAA,EACrD0E,EAAAA,EAAAA,MAAA,UAAQH,QArmBxB,WACOie,GACDvG,EAAOzJ,cAAgB,EAAK/W,EAAK,0IAChCwgB,EAAO3F,SACR2F,EAAO1H,SAAW,EAAK9Y,EAAK,wFAChCuhB,KACAd,EAAWC,IAAC,IAAWA,EAAG5H,QAAS4H,EAAE5H,QAAU,KAC/CwJ,GAAO,CACLzZ,KAAM,SACNmC,MAAO,sDACP2X,OAAQ,uDAAenC,EAAO1H,QAAU,aAPlB9Y,EAAK,4IAFXA,EAAK,iKAAqC,UAW9D,EAylB2C+I,SAAU+e,GACnC1iB,UAAW,+BAA+B0iB,GAAiB,gCAAkC,6DAA6DvjB,SAAA,EAC1JC,EAAAA,EAAAA,KAACokB,EAAAA,EAAU,CAACzf,KAAM,KAAM,0CACdqX,EAAO1H,QAAQ,aAE3BtU,EAAAA,EAAAA,KAAA,QAAMY,UAAU,wBAAuBb,SACpCic,EAAOzJ,cAAgB,EACpB,4BACCyJ,EAAO3F,SAEN2F,EAAO1H,SAAW,EAChB,sDACCuN,GAAaC,aAAe,sDAAgB,4DAH/C,wEAMT9F,EAAO3F,UAAY2F,EAAO1H,QAAU,IACnCtU,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAE8hB,GAAaE,mBAMlEtd,EAAAA,EAAAA,MAAA,WACE7D,UAAW,GAAGyI,0BACdpF,MAAO0c,GAAU,CAAE0D,UAAW1D,SAAY3mB,EAAU+F,SAAA,EAEpD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,+BAC7B0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,kCAAiCb,SAAA,EAC9CC,EAAAA,EAAAA,KAAA,UACEsE,QAAS2Z,GACT1Z,UAAW2Y,GACXtc,UAAW,uCAAwCsc,GAA4C,4BAAlC,yEAC7D1W,MAAM,wCAAmBzG,UAEzBC,EAAAA,EAAAA,KAACskB,EAAAA,EAAK,CAAC3f,KAAM,QAEf3E,EAAAA,EAAAA,KAAA,UACEsE,QAAS8Z,GACT7Z,UAAW4Y,GACXvc,UAAW,+BAAgCuc,GAA4C,4BAAlC,yEACrD3W,MAAM,8CAAyBzG,UAE/BC,EAAAA,EAAAA,KAACukB,EAAAA,EAAK,CAAC5f,KAAM,aAIF,IAAhByY,GAAKplB,QACJgI,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAC,kDAE5CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,8CAA6Cb,SACzDqd,GAAK9kB,IAAK2nB,IACTxb,EAAAA,EAAAA,MAAA,OAAgB7D,UAAU,iCAAgCb,SAAA,EACxD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oCAAmCb,SAAA,EAChDC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sBAAqBb,SACjCkgB,EAAEzZ,SAELxG,EAAAA,EAAAA,KAAA,QAAMY,UAAU,4BAA2Bb,SAAEkgB,EAAEjC,UAEhDiC,EAAE9B,SACDne,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAEkgB,EAAE9B,SAEhD8B,EAAEwC,OACDhe,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wDAAuDb,SAAA,CACnE,SAAUkgB,EAAEwC,OACXhe,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,6CAA4Cb,SAAA,CAAC,gBACvD6P,GAAOqQ,EAAEwC,KAAKC,MAAM,QAG3B,iBAAkBzC,EAAEwC,OACnBhe,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,6CAA4Cb,SAAA,CAAC,6BACpDkgB,EAAEwC,KAAKlQ,aAAa,YAG9B,gBAAiB0N,EAAEwC,MAA+B,IAAvBxC,EAAEwC,KAAK7O,cACjCnP,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,6CAA4Cb,SAAA,CAAC,0CACjDkgB,EAAEwC,KAAK7O,YAAc,EAAI,IAAIqM,EAAEwC,KAAK7O,cAAgBqM,EAAEwC,KAAK7O,oBAxBrEqM,EAAEhiB,cAoCtBwG,EAAAA,EAAAA,MAAA,WAAS7D,UAAWyI,GAAKtJ,SAAA,EACvB0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,EACtCC,EAAAA,EAAAA,KAAA,MAAIY,UAAWwI,GAAarJ,SAAC,+BAC7BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,kCAAiCb,UAC9C0E,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,4EAA2Eb,SAAA,CAAC,eAC7E6P,GAAOxZ,KAAKoE,KAAa,OAAT4lB,SAAS,IAATA,QAAS,EAATA,GAAW/I,aAAc,GAAa,OAAV6I,SAAU,IAAVA,QAAU,EAAVA,GAAY7I,aAAc,IAAI,SAC7E,OAAT+I,SAAS,IAATA,IAAa,QAAJ3F,EAAT2F,GAAW9lB,UAAE,IAAAmgB,GAAbA,EAAejD,UACZ,UAAgC,IAAzB4I,GAAU9lB,GAAGkd,WAAiBrK,QAAQ,aAC7C,WAKTiW,IACC3e,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,iBAAgBb,SAAA,EAE7BC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAC,+FAC5CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,yBAAwBb,SACpC,IAAI7H,MAAM,IAAII,IAAI,CAACF,EAAGC,KACrB2H,EAAAA,EAAAA,KAAA,OAEEY,UAAU,iDADLvI,OAMX2H,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6CAA4Cb,SACxD,CAAC,EAAG,GAAGzH,IAAKxB,IACX2N,EAAAA,EAAAA,MAAA,OAAa7D,UAAU,iCAAgCb,SAAA,EACrDC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gDACfZ,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sDACfZ,EAAAA,EAAAA,KAAA,OAAKY,UAAU,uDACfZ,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sDAJP9J,UAUhB2N,EAAAA,EAAAA,MAAA2I,EAAAA,SAAA,CAAArN,SAAA,EAEE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6BAA4Bb,SAAA,EACzCC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAC,+FAC5CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,yBAAwBb,SACpC6f,GAAUtnB,IAAI,CAAC2nB,EAAG5nB,KACjB2H,EAAAA,EAAAA,KAAA,QAEEY,UAAU,oFAAmFb,SAE5FkgB,GAHI5nB,SAQZ+nB,IAAaF,KACZzb,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6CAA4Cb,SAAA,EAEzD0E,EAAAA,EAAAA,MAAClB,EAAAA,EAAO0B,IAAG,CACTvB,QAAS,CAAEC,QAAS,EAAGC,EAAG,GAC1BC,QAAS,CAAEF,QAAS,EAAGC,EAAG,GAC1BG,WAAY,CAAEC,SAAU,KACxBpD,UAAU,iCAAgCb,SAAA,EAE1C0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oCAAmCb,SAAA,EAChDC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gDAA+Cb,SAAC,4CAG/DC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,4DAA2Db,SAC3D,cAAb8iB,GACG,sDACa,YAAbA,GACE,iFACA,uFAGVpe,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,6CAA4Cb,SAAA,EAEzD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,qDAAoDb,SAAA,EACjE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oCAAmCb,SAAA,EAChD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wBAAuBb,SAAA,CAAC,yDACtB6P,GAAOsQ,GAAW7P,WAAW,YAAKT,GAAOsQ,GAAW7I,YAAY,cAC3E,+BACRrX,EAAAA,EAAAA,KAAA,OAAKY,UAAU,0BAAyBb,SACrC2P,GAAawQ,GAAWnM,YAAamM,GAAW5lB,OAEnD0F,EAAAA,EAAAA,KAAA,OAAKY,UAAU,2DAA0Db,UACvEC,EAAAA,EAAAA,KAACuD,EAAAA,EAAO0B,IAAG,CACTvB,QAAS,CAAEpC,MAAO,GAClBuC,QAAS,CAAEvC,MAAO,GAAGlL,KAAK6Z,MAA+B,IAAzBiQ,GAAWnM,iBAC3ChQ,WAAY,CAAEM,KAAM,SAAUc,UAAW,IAAKC,QAAS,IACvDxE,UAAU,0DAGb,MACC,MAAM4jB,EAAM1U,GAAeoQ,GAAWnQ,aAAcmQ,GAAWnM,aACzD0Q,EAAQvU,GAAYgQ,GAAWnM,aACrC,OACEtP,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,+DAA8Db,SAAA,EAC3E0E,EAAAA,EAAAA,MAAA,QAAA1E,SAAA,CAAM,yBACEC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6BAAQ,MAAEC,EAAAA,EAAAA,KAAA,KAAAD,SAAI9I,OAAOC,SAASstB,GAAO5U,GAAOxZ,KAAK6Z,MAAMuU,IAAQ,WAAQ,SAElF/f,EAAAA,EAAAA,MAAA,QAAM7D,UAAW,iCAAiC6jB,EAAMtU,OAAOpQ,SAAA,CAAC,6BACvD0kB,EAAM5uB,UAEfmK,EAAAA,EAAAA,KAAA,QAAMY,UAAU,4BAA2Bb,SAAC,4GAKjD,EAhBA,OAmBH0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,qDAAoDb,SAAA,EACjEC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,oCAAmCb,UAChD0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wBAAuBb,SAAA,CAAC,yDACtB6P,GAAOwQ,GAAU/P,WAAW,YAAKT,GAAOwQ,GAAU/I,YAAY,iBAGjFrX,EAAAA,EAAAA,KAAA,OAAKY,UAAU,0BAAyBb,SAAE4P,GAAQyQ,GAAUrM,gBAC5D/T,EAAAA,EAAAA,KAAA,OAAKY,UAAU,2DAA0Db,UACvEC,EAAAA,EAAAA,KAACuD,EAAAA,EAAO0B,IAAG,CACTvB,QAAS,CAAEpC,MAAO,GAClBuC,QAAS,CAAEvC,MAAO,GAAGlL,KAAK6Z,MAA8B,IAAxBmQ,GAAUrM,iBAC1ChQ,WAAY,CAAEM,KAAM,SAAUc,UAAW,IAAKC,QAAS,IACvDxE,UAAU,0DAGb,MACC,MAAM4jB,EAAM1U,GAAesQ,GAAUrQ,aAAcqQ,GAAUrM,aACvD0Q,EAAQvU,GAAYkQ,GAAUrM,aACpC,OACEtP,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,+DAA8Db,SAAA,EAC3E0E,EAAAA,EAAAA,MAAA,QAAA1E,SAAA,CAAM,yBACEC,EAAAA,EAAAA,KAAA,KAAAD,SAAG,6BAAQ,MAAEC,EAAAA,EAAAA,KAAA,KAAAD,SAAI9I,OAAOC,SAASstB,GAAO5U,GAAOxZ,KAAK6Z,MAAMuU,IAAQ,WAAQ,SAElF/f,EAAAA,EAAAA,MAAA,QAAM7D,UAAW,iCAAiC6jB,EAAMtU,OAAOpQ,SAAA,CAAC,6BACvD0kB,EAAM5uB,UAEfmK,EAAAA,EAAAA,KAAA,QAAMY,UAAU,4BAA2Bb,SAAC,4GAKjD,EAhBA,aAqBP0E,EAAAA,EAAAA,MAAClB,EAAAA,EAAO0B,IAAG,CACTvB,QAAS,CAAEC,QAAS,EAAGC,EAAG,GAC1BC,QAAS,CAAEF,QAAS,EAAGC,EAAG,GAC1BG,WAAY,CAAEC,SAAU,IAAK0gB,MAAO,KACpC9jB,UAAU,iCAAgCb,SAAA,EAE1CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,gDAA+Cb,SAAC,8BAG9D,MACC,IAAKqgB,GAAW,OAAO,KAEvB,MAAMuE,EAAS,CACb,CAAElG,IAAK,aAAczV,KAAM,sBAAazQ,EAAGtB,OAAOmpB,GAAUpM,YAAc,GAAI4Q,KAAM3L,GAAgBC,QACpG,CAAEuF,IAAK,YAAazV,KAAM,uBAAczQ,EAAGtB,OAAOmpB,GAAUnM,WAAa,GAAI2Q,KAAM3L,GAAgBE,OACnG,CAAEsF,IAAK,cAAezV,KAAM,qBAAYzQ,EAAGtB,OAAOmpB,GAAUlM,aAAe,GAAI0Q,KAAM3L,GAAgBG,UAEvG,OACEpZ,EAAAA,EAAAA,KAAA,OAAKY,UAAU,yBAAwBb,SACpC4kB,EAAOrsB,IAAIlB,IACVqN,EAAAA,EAAAA,MAAA,OAAA1E,SAAA,EACE0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,oCAAmCb,SAAA,EAChDC,EAAAA,EAAAA,KAAA,QAAMY,UAAU,gBAAeb,SAAE3I,EAAE4R,QACnCvE,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,0BAAyBb,SAAA,CAErCuO,GAAUlX,EAAEmB,KACXyH,EAAAA,EAAAA,KAAA,QAAMY,UAAU,8FAA6Fb,SAAC,kBAIhHC,EAAAA,EAAAA,KAAA,KAAAD,SAAI4P,GAAQvY,EAAEmB,YAGlByH,EAAAA,EAAAA,KAAA,OAAKY,UAAU,2DAA0Db,UACvEC,EAAAA,EAAAA,KAACuD,EAAAA,EAAO0B,IAAG,CACTvB,QAAS,CAAEpC,MAAO,GAClBuC,QAAS,CAAEvC,MAAOgN,GAAUlX,EAAEmB,GAAK,OAASyX,GAAI5Y,EAAEmB,IAClDwL,WAAY,CAAEM,KAAM,SAAUc,UAAW,IAAKC,QAAS,IACvDxE,UAAU,0BACVqD,MAAO,CAAEsG,gBAAiBnT,EAAEwtB,YAnBxBxtB,EAAEqnB,OA0BnB,EArCA,GAuCA,MACC,MAAM,MAAE1oB,EAAK,MAAE8uB,GAzjDrC,SAAwB5B,GAAoB,IAAf6B,EAAG/qB,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,KACjC,IAAKkpB,EAAK,MAAO,CAAEltB,MAAO,GAAI8uB,MAAO,IACrC,IAAI/sB,EAAM,CACR,CAAE2mB,IAAK,aAAc5oB,MAAO,eAAM0C,EAAGtB,OAAOgsB,EAAIjP,YAAc,GAAI4Q,KAAM3L,GAAgBC,QACxF,CAAEuF,IAAK,YAAa5oB,MAAO,eAAM0C,EAAGtB,OAAOgsB,EAAIhP,WAAa,GAAI2Q,KAAM3L,GAAgBE,OACtF,CAAEsF,IAAK,cAAe5oB,MAAO,eAAM0C,EAAGtB,OAAOgsB,EAAI/O,aAAe,GAAI0Q,KAAM3L,GAAgBG,UAI5F,GADAthB,EAAMA,EAAIc,OAAOwL,IAAOiK,EAAWjK,EAAG7L,KACjCT,EAAIE,OAAQ,MAAO,CAAEjC,MAAO,GAAI8uB,MAAO,IAC5C/sB,EAAI4D,KAAK,CAACC,EAAGC,IAAMA,EAAErD,EAAIoD,EAAEpD,GAC3B,MAAMssB,EAAQ,GACd,IAAK,IAAIxsB,EAAI,EAAGA,EAAIP,EAAIE,OAAS,EAAGK,IAAK,CACvC,MAAM0sB,EAAOjtB,EAAIO,GAAGE,EAAIT,EAAIO,EAAI,GAAGE,EACnCssB,EAAMrpB,KAAKpF,KAAK4uB,IAAID,IAASD,EAAM,IAAM,IAC3C,CACA,MAAO,CAAE/uB,MAAO+B,EAAK+sB,QACvB,CAwiD+CI,CAAe7E,IACxC,OAAKrqB,EAAMiC,QAETyM,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,8BAA6Bb,SAAA,EAC1CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,6BAA4Bb,SAAC,kDAC5CC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sCAAqCb,SACjDhK,EAAMuC,IAAI,CAAC8L,EAAInM,KACdwM,EAAAA,EAAAA,MAACzC,EAAAA,SAAc,CAAAjC,SAAA,EACb0E,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,kFAAiFb,SAAA,EAC/FC,EAAAA,EAAAA,KAAA,QACEY,UAAU,qDACVqD,MAAO,CAAEsG,gBAAiBnG,EAAGwgB,SAE/BngB,EAAAA,EAAAA,MAAA,QAAM7D,UAAU,UAASb,SAAA,CACtBqE,EAAGvO,MAAOyY,GAAUlK,EAAG7L,GAAK,kBAAU,SAG1CN,EAAMlC,EAAMiC,OAAS,IACpBgI,EAAAA,EAAAA,KAAA,QAAMY,UAAU,mCAAkCb,SAChC,MAAf8kB,EAAM5sB,GAAe,SAAM,aAZbmM,EAAGqa,WANN,IA0B3B,EA5BA,mBAoCfze,EAAAA,EAAAA,KAAC6E,GAAU,CAACE,OAAQA,EAAQC,QAAS0C,KACrC1H,EAAAA,EAAAA,KAAA,OAAKY,UAAU,OAAMb,UACnBC,EAAAA,EAAAA,KAAC0N,EAAAA,EAAU,QAInB,CCvkEA,SAASwX,KACP,MAAMC,EAnBR,WAAsC,IAAfC,EAAMrrB,UAAA/B,OAAA,QAAAgC,IAAAD,UAAA,GAAAA,UAAA,GAAG,IAC9B,MAAOsrB,EAAMC,GAAWtjB,EAAAA,UAAe,GAevC,OAdAA,EAAAA,UAAgB,KACd,MAAMgB,EAAWA,KACf,MAAMuiB,EAAM9lB,SAAS+lB,gBACfC,EAAeF,EAAIG,cAAgBH,EAAII,UAAYjkB,OAAOkkB,aAChEN,EAAQG,GAAgBL,IAK1B,OAHApiB,IACAtB,OAAOC,iBAAiB,SAAUqB,EAAU,CAAEE,SAAS,IACvDxB,OAAOC,iBAAiB,SAAUqB,GAC3B,KACLtB,OAAOE,oBAAoB,SAAUoB,GACrCtB,OAAOE,oBAAoB,SAAUoB,KAEtC,CAACoiB,IACGC,CACT,CAEkBQ,CAAc,KAC9B,OACE7lB,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sHAAqHb,UAClI0E,EAAAA,EAAAA,MAAA,UACEJ,KAAK,SACL,aAAW,sBACXC,QAASA,IAAM5C,OAAOokB,SAAS,CAAE1kB,IAAK,EAAG2kB,SAAU,WACnDnlB,UAAW,CACT,mHACA,+GACA,oCACAukB,EAAU,4BAA8B,+CACxClG,KAAK,KAAKlf,SAAA,EAEZC,EAAAA,EAAAA,KAAC0E,EAAAA,EAAS,CAACC,KAAM,MACjB3E,EAAAA,EAAAA,KAAA,QAAMY,UAAU,uCAAsCb,SAAC,YAI/D,CACe,SAASimB,KACtB,OACEvhB,EAAAA,EAAAA,MAACwhB,EAAAA,GAAU,CAACC,SAAS,QAAOnmB,SAAA,EAC1B0E,EAAAA,EAAAA,MAAA,OAAK7D,UAAU,wCAAuCb,SAAA,EAC5DC,EAAAA,EAAAA,KAAA,UAAQY,UAAU,0EAAyEb,UACzFC,EAAAA,EAAAA,KAAA,OAAKY,UAAU,sCAAqCb,UAClDC,EAAAA,EAAAA,KAAA,OAAK,aAAW,aAAYD,UAC1B0E,EAAAA,EAAAA,MAAA,MAAI7D,UAAU,gEAA+Db,SAAA,EAC3EC,EAAAA,EAAAA,KAAA,MAAAD,UACEC,EAAAA,EAAAA,KAACmmB,EAAAA,GAAO,CACNC,GAAG,OACHxlB,UAAWhB,IAAA,IAAC,SAAEymB,GAAUzmB,EAAA,MACtB,CACE,sDACA,oEACAymB,EACI,iCACA,kCACJpH,KAAK,MACRlf,SACF,wCAIHC,EAAAA,EAAAA,KAAA,MAAAD,UACEC,EAAAA,EAAAA,KAACmmB,EAAAA,GAAO,CACNC,GAAG,aACHxlB,UAAWJ,IAAA,IAAC,SAAE6lB,GAAU7lB,EAAA,MACtB,CACE,sDACA,oEACA6lB,EACI,iCACA,kCACJpH,KAAK,MACRlf,SACF,iDASHC,EAAAA,EAAAA,KAAA,QAAAD,UACE0E,EAAAA,EAAAA,MAAC6hB,EAAAA,GAAM,CAAAvmB,SAAA,EACLC,EAAAA,EAAAA,KAACumB,EAAAA,GAAK,CAACC,KAAK,OAAOC,SAASzmB,EAAAA,EAAAA,KAACwa,GAAY,OACzCxa,EAAAA,EAAAA,KAACumB,EAAAA,GAAK,CAACC,KAAK,aAAaC,SAASzmB,EAAAA,EAAAA,KAACuG,EAAgB,OAEnDvG,EAAAA,EAAAA,KAACumB,EAAAA,GAAK,CAACC,KAAK,IAAIC,SAASzmB,EAAAA,EAAAA,KAAC0mB,EAAAA,GAAQ,CAACN,GAAG,OAAOhT,SAAO,eAI1DpT,EAAAA,EAAAA,KAACklB,GAAM,MAGb,C,sDCrFA,QArBA,WACE,MAAMyB,GAAQ1lB,EAAAA,EAAAA,QAAO,MAkBrB,OAjBAO,EAAAA,EAAAA,WAAU,KACR,MAAMolB,EAAMnnB,SAASonB,cAAc,OACnCD,EAAIhmB,UAAY,gBAChBgmB,EAAI3iB,MAAM6iB,QAAU,OACpBF,EAAIG,aAAa,eAAgB,wBACjCH,EAAIG,aAAa,gBAAiB,OAClCH,EAAIG,aAAa,iBAAkB,MACnC,MAAMC,EAASvnB,SAASonB,cAAc,UACtCG,EAAO3iB,KAAO,kBACd2iB,EAAOC,OAAQ,EACfD,EAAOE,IAAM,wCACTP,EAAMxkB,UACRwkB,EAAMxkB,QAAQglB,UAAY,GAC1BR,EAAMxkB,QAAQilB,YAAYR,GAC1BD,EAAMxkB,QAAQilB,YAAYJ,KAE3B,KACIhnB,EAAAA,EAAAA,KAAA,OAAKyD,IAAKkjB,EAAO/lB,UAAU,yBACpC,C","sources":["components/LoACoreOptimizer.jsx","components/GemSimulator.jsx","CoreOnly.jsx","components/KakaoAdfit.jsx"],"sourcesContent":["// src/components/LoACoreOptimizer.jsx\r\nimport React, { useEffect, useState, useRef, useLayoutEffect } from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { Plus, Trash2, RotateCcw, ChevronUp, ChevronDown } from \"lucide-react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { DragDropContext, Droppable, Draggable } from \"@hello-pangea/dnd\";\r\nimport KakaoAdfit from \"./KakaoAdfit\";\r\nimport './LoACoreOptimizer.css';\r\n/* =============================== ( ) =============================== */\r\n/** @typedef {\"dealer\"|\"support\"} Role */\r\n/** @typedef {\"atk\"|\"add\"|\"boss\"|\"brand\"|\"allyDmg\"|\"allyAtk\"} OptionKey */\r\n/** @typedef {\"HERO\"|\"LEGEND\"|\"RELIC\"|\"ANCIENT\"} CoreGrade */\r\n/** @typedef {{id:string, will:number|null, point:number|null, o1k:OptionKey, o1v:number|null, o2k:OptionKey, o2v:number|null}} Gem */\r\n/** @typedef {{[k in OptionKey]: number}} Weights */\r\n/** @typedef {{ id:string, name:string, grade:CoreGrade, minThreshold?:number, enforceMin:boolean }} CoreDef */\r\n/** @typedef {{ list: Gem[], totalWill:number, totalPoint:number, thr:number[], roleSum:number, score:number }} ComboInfo */\r\n/* ===============================   =============================== */\r\nconst CORE_SUPPLY = { HERO: 7, LEGEND: 11, RELIC: 15, ANCIENT: 17 };\r\nconst CORE_THRESHOLDS = {\r\n  HERO: [10],\r\n  LEGEND: [10, 14],\r\n  RELIC: [10, 14, 17, 18, 19, 20],\r\n  ANCIENT: [10, 14, 17, 18, 19, 20],\r\n};\r\nconst CORE_LABEL = { HERO: \"\", LEGEND: \"\", RELIC: \"\", ANCIENT: \"\" };\r\nconst GRADES = [\"HERO\", \"LEGEND\", \"RELIC\", \"ANCIENT\"];\r\nconst OPTION_LABELS = {\r\n  atk: \"\",\r\n  add: \" \",\r\n  boss: \" \",\r\n  brand: \"\",\r\n  allyDmg: \"  \",\r\n  allyAtk: \"  \",\r\n};\r\nconst OPTIONS = [\"atk\", \"add\", \"boss\", \"brand\", \"allyDmg\", \"allyAtk\"];\r\nconst ROLE_KEYS = {\r\n  dealer: new Set([\"atk\", \"add\", \"boss\"]),\r\n  support: new Set([\"brand\", \"allyDmg\", \"allyAtk\"]),\r\n};\r\nconst DEFAULT_WEIGHTS = { atk: 1, add: 1, boss: 1, brand: 1, allyDmg: 1, allyAtk: 1 };\r\nconst CORE_NAME_ITEMS = [\r\n  { value: \" \", label: \" \" },\r\n  { value: \" \", label: \" \" },\r\n  { value: \" \", label: \" \" },\r\n];\r\n// :  / \r\nconst CATEGORY_LABEL = {\r\n  order: \"\",\r\n  chaos: \"\",\r\n};\r\nconst LS_KEY = \"LoA-CoreOptimizer-v2\"; //  \r\n/* =============================== / =============================== */\r\nconst CORE_ORDER = [\" \", \" \", \" \"];\r\nfunction nextAvailableCoreName(existingNames) {\r\n  for (const n of CORE_ORDER) if (!existingNames.has(n)) return n;\r\n  return null;\r\n}\r\nconst uid = () => Math.random().toString(36).slice(2, 9);\r\nfunction sanitizeWeights(w) {\r\n  const base = { ...DEFAULT_WEIGHTS };\r\n  if (!w) return base;\r\n  Object.keys(base).forEach((k) => {\r\n    const raw = w[k];\r\n    const num = typeof raw === 'number' ? raw : Number(raw);\r\n    base[k] = Number.isFinite(num) && num >= 0 ? num : DEFAULT_WEIGHTS[k];\r\n  });\r\n  return /** @type {Weights} */(base);\r\n}\r\nfunction scoreGemForRole(g, role, w) {\r\n  if (role == null) return 0; //     0(  )\r\n  const keys = role === \"dealer\" ? ROLE_KEYS.dealer : ROLE_KEYS.support;\r\n  const s1 = keys.has(g.o1k) ? g.o1v * (w[g.o1k] ?? 1) : 0;\r\n  const s2 = keys.has(g.o2k) ? g.o2v * (w[g.o2k] ?? 1) : 0;\r\n  return s1 + s2;\r\n}\r\nfunction* combinations(arr, k) {\r\n  const n = arr.length; if (k > n) return;\r\n  const idx = Array.from({ length: k }, (_, i) => i);\r\n  while (true) {\r\n    yield idx.map(i => arr[i]);\r\n    let p = k - 1; while (p >= 0 && idx[p] === n - k + p) p--; if (p < 0) break; idx[p]++; for (let j = p + 1; j < k; j++) idx[j] = idx[j - 1] + 1;\r\n  }\r\n}\r\nfunction thresholdsHit(grade, totalPoint) {\r\n  const th = CORE_THRESHOLDS[grade];\r\n  return th.filter(t => totalPoint >= t);\r\n}\r\nfunction scoreCombo(combo, grade, role, weights) {\r\n  const totalWill = combo.reduce((s, g) => s + ((g.will ?? 0)), 0);\r\n  const totalPoint = combo.reduce((s, g) => s + ((g.point ?? 0)), 0);\r\n  const thr = thresholdsHit(grade, totalPoint);\r\n  const roleSum = combo.reduce((s, g) => s + scoreGemForRole(g, role, weights), 0);\r\n  const score = (thr.length * 10_000_000) + (totalPoint * 10_000) + ((5_000 - totalWill) * 10) + roleSum - combo.length;\r\n  return { totalWill, totalPoint, thr, roleSum, score };\r\n}\r\n/*     ( :     ) */\r\nfunction enumerateCoreCombos(pool, grade, role, weights, minThreshold, enforceMin) {\r\n  const supply = CORE_SUPPLY[grade];\r\n  const W = sanitizeWeights(weights);\r\n  const minOfGrade = Math.min(...CORE_THRESHOLDS[grade]);\r\n  const effMin = minThreshold ?? minOfGrade;\r\n  const effEnforce = enforceMin || minThreshold == null;\r\n  /** @type {ComboInfo[]} */\r\n  const all = [];\r\n  const maxPick = Math.min(4, pool.length);\r\n  for (let k = 0; k <= maxPick; k++) {\r\n    if (k === 0) { all.push({ list: [], totalWill: 0, totalPoint: 0, thr: [], roleSum: 0, score: 0 }); continue; }\r\n    for (const combo of combinations(pool, k)) {\r\n      const totalWill = combo.reduce((s, g) => s + (g.will || 0), 0);\r\n      if (totalWill > supply) continue;\r\n      const { totalPoint, thr, roleSum, score } = scoreCombo(combo, grade, role, W);\r\n      all.push({ list: combo, totalWill, totalPoint, thr, roleSum, score });\r\n    }\r\n  }\r\n  all.sort((a, b) => b.score - a.score);\r\n  let filtered;\r\n  if (effEnforce) {\r\n    filtered = all.filter(ci => {\r\n      const maxThr = Math.max(0, ...ci.thr);\r\n      return ci.list.length > 0 && maxThr >= (effMin ?? 0);\r\n    });\r\n  } else {\r\n    filtered = all.filter(ci => ci.list.length > 0 && ci.thr.length > 0);\r\n  }\r\n  if (filtered.length === 0) {\r\n    return [{ list: [], totalWill: 0, totalPoint: 0, thr: [], roleSum: 0, score: 0 }];\r\n  }\r\n  return filtered;\r\n}\r\n/* =====   : thr  (1) +  (min) +   ===== */\r\nfunction optimizeRoundRobinTargets(cores, pool, role, weights, perCoreLimit = 300) {\r\n  const W = sanitizeWeights(weights);\r\n  const thresholdsOf = (grade) => CORE_THRESHOLDS[grade];\r\n  const minOf = (grade) => Math.min(...thresholdsOf(grade));\r\n  const thrMax = (ci) => (ci?.thr?.length ? Math.max(...ci.thr) : 0);\r\n\r\n  const emptyPick = { list: [], totalWill: 0, totalPoint: 0, thr: [], roleSum: 0, score: 0 };\r\n\r\n  //  ()\r\n  const order = cores.map((_, i) => i);\r\n  const enforcedIdx = cores.map((c, i) => (c.enforceMin ? i : -1)).filter(i => i !== -1);\r\n\r\n  const candidatesFor = (core, gemPool) => {\r\n    const arr = enumerateCoreCombos(gemPool, core.grade, role, W, undefined, false)\r\n      .filter(ci => ci.list.length > 0 && ci.thr.length > 0);\r\n    arr.sort((a, b) => {\r\n      const ta = thrMax(a), tb = thrMax(b);\r\n      if (ta !== tb) return tb - ta;\r\n      if (a.totalPoint !== b.totalPoint) return b.totalPoint - a.totalPoint;\r\n      if (a.roleSum !== b.roleSum) return b.roleSum - a.roleSum; //  \r\n      return a.totalWill - b.totalWill;    \r\n    });\r\n    return arr.slice(0, Math.max(perCoreLimit, 10000));\r\n  };\r\n\r\n  const allCandidates = order.map(i => candidatesFor(cores[i], pool));\r\n\r\n  function betterThan(A, B) {\r\n    if (!B) return true;\r\n    if (A.sumThr !== B.sumThr) return A.sumThr > B.sumThr;\r\n    for (let i = 0; i < A.thrVec.length; i++) {\r\n      if (A.thrVec[i] !== B.thrVec[i]) return A.thrVec[i] > B.thrVec[i];\r\n    }\r\n    if (A.sumPoint !== B.sumPoint) return A.sumPoint > B.sumPoint;\r\n    for (let i = 0; i < A.ptVec.length; i++) {\r\n      if (A.ptVec[i] !== B.ptVec[i]) return A.ptVec[i] > B.ptVec[i];\r\n    }\r\n    if (A.roleSum !== B.roleSum) return A.roleSum > B.roleSum; //     \r\n    if (A.sumWill !== B.sumWill) return A.sumWill < B.sumWill; //   \r\n    return false;\r\n  }\r\n\r\n  // ----  :  enforceSet    ----\r\n  function trySolve(enforceSet, blockedSet = new Set()) {\r\n    let best = null;\r\n    const used = new Set();\r\n\r\n    function backtrack(pos, picksAcc, sumThrAcc, sumPointAcc, sumWillAcc, roleSumAcc, thrVec, ptVec) {\r\n      if (pos === order.length) {\r\n        //    \r\n        for (const idx of enforceSet) {\r\n          const effMin = (cores[idx].minThreshold ?? minOf(cores[idx].grade));\r\n          const t = thrMax(picksAcc[idx]);\r\n          if (t < effMin) return;\r\n        }\r\n        const cand = {\r\n          picks: picksAcc.map(x => x),\r\n          sumThr: sumThrAcc,\r\n          sumPoint: sumPointAcc,\r\n          sumWill: sumWillAcc,\r\n          roleSum: roleSumAcc,\r\n          thrVec: thrVec.slice(),\r\n          ptVec: ptVec.slice(),\r\n        };\r\n        if (betterThan(cand, best)) best = cand;\r\n        return;\r\n      }\r\n\r\n      const coreIdx = order[pos];\r\n      const isEnf = enforceSet.has(coreIdx);\r\n      const effMin = isEnf ? (cores[coreIdx].minThreshold ?? minOf(cores[coreIdx].grade)) : -Infinity;\r\n\r\n      // ()      \r\n      if (blockedSet.has(coreIdx)) {\r\n        backtrack(\r\n          pos + 1,\r\n          picksAcc,\r\n          sumThrAcc,\r\n          sumPointAcc,\r\n          sumWillAcc,\r\n          roleSumAcc,\r\n          thrVec,\r\n          ptVec\r\n        );\r\n        return;\r\n      }\r\n\r\n      const candList = allCandidates[pos];\r\n\r\n      //  \r\n      for (const pick of candList) {\r\n        const t = thrMax(pick);\r\n        if (isEnf && t < effMin) continue;\r\n\r\n        //  \r\n        let clash = false;\r\n        for (const g of pick.list) { if (used.has(g.id)) { clash = true; break; } }\r\n        if (clash) continue;\r\n\r\n        pick.list.forEach(g => used.add(g.id));\r\n        const prev = picksAcc[coreIdx];\r\n        picksAcc[coreIdx] = pick;\r\n\r\n        thrVec[pos] = t;\r\n        ptVec[pos]  = pick.totalPoint;\r\n\r\n        backtrack(\r\n          pos + 1,\r\n          picksAcc,\r\n          sumThrAcc   + t,\r\n          sumPointAcc + pick.totalPoint,\r\n          sumWillAcc  + pick.totalWill,\r\n          roleSumAcc  + pick.roleSum,\r\n          thrVec,\r\n          ptVec\r\n        );\r\n\r\n        // \r\n        pick.list.forEach(g => used.delete(g.id));\r\n        picksAcc[coreIdx] = prev;\r\n        thrVec[pos] = 0;\r\n        ptVec[pos]  = 0;\r\n      }\r\n\r\n      //    \r\n      if (!isEnf) {\r\n        backtrack(\r\n          pos + 1,\r\n          picksAcc,\r\n          sumThrAcc,\r\n          sumPointAcc,\r\n          sumWillAcc,\r\n          roleSumAcc,\r\n          thrVec,\r\n          ptVec\r\n        );\r\n      }\r\n    }\r\n\r\n    backtrack(\r\n      0,\r\n      cores.map(() => emptyPick),\r\n      0, 0, 0, 0,\r\n      Array(order.length).fill(0),\r\n      Array(order.length).fill(0)\r\n    );\r\n\r\n    return best; // null()  \r\n  }\r\n\r\n  // 1)  (  )  \r\n  const enforcedSetFull = new Set(enforcedIdx);\r\n  const bestFull = trySolve(enforcedSetFull);\r\n  if (bestFull) {\r\n    return { picks: bestFull.picks };\r\n  }\r\n\r\n  \r\n  // 1.5) ()  :    \" \"  \r\n  //      -     : order[order.length - 1]\r\n  //      -   blocked ( empty),   \r\n  if (order.length > 0) {\r\n    const lowestIdx = order[order.length - 1];\r\n    const enforcedMinusLowest = new Set([...enforcedSetFull].filter(i => i !== lowestIdx));\r\n    const bestDropLowest = trySolve(enforcedMinusLowest, new Set([lowestIdx]));\r\n    if (bestDropLowest) {\r\n      //    emptyPick ,     \r\n      const finalPicks = bestDropLowest.picks.map((p, i) => (i === lowestIdx ? emptyPick : (p || emptyPick)));\r\n      return { picks: finalPicks };\r\n    }\r\n  }\r\n\r\n  // 2)  : \"     \" \r\n  //    (        1  )\r\n  const infeasibleEnforced = new Set();\r\n  for (const idx of enforcedIdx) {\r\n    const effMin = (cores[idx].minThreshold ?? minOf(cores[idx].grade));\r\n    const pos = order.indexOf(idx);\r\n    const hasFeasible = (allCandidates[pos] || []).some(ci => thrMax(ci) >= effMin);\r\n    if (!hasFeasible) infeasibleEnforced.add(idx);\r\n  }\r\n\r\n  // 3)     \r\n  const enforcedSetReduced = new Set(enforcedIdx.filter(i => !infeasibleEnforced.has(i)));\r\n  const bestReduced = trySolve(enforcedSetReduced);\r\n\r\n  if (bestReduced) {\r\n    // 4)   \"   \"  \r\n    const finalPicks = bestReduced.picks.map((p, i) => (infeasibleEnforced.has(i) ? emptyPick : (p || emptyPick)));\r\n    return { picks: finalPicks };\r\n  }\r\n\r\n  // 5)       :  empty ()\r\n  return { picks: cores.map(() => emptyPick) };\r\n}\r\n\r\n\r\n\r\n//        0 \r\nfunction maskWeightsForRole(prev, role) {\r\n  const next = { ...prev };\r\n  //    0\r\n  const zeroSet = role === \"dealer\" ? ROLE_KEYS.support : ROLE_KEYS.dealer;\r\n  zeroSet.forEach((k) => {\r\n    next[k] = 0;\r\n  });\r\n  //    1\r\n  const oneSet = ROLE_KEYS[role];\r\n  oneSet.forEach((k) => {\r\n    next[k] = 1;\r\n  });\r\n  return next;\r\n}\r\nfunction loadFromStorage() {\r\n  try {\r\n    const raw = localStorage.getItem(LS_KEY);\r\n    if (!raw) return null;\r\n    return JSON.parse(raw);\r\n  } catch (e) {\r\n    console.warn(\"loadFromStorage fail\", e);\r\n    return null;\r\n  }\r\n}\r\nfunction saveToStorage(data) {\r\n  try {\r\n    localStorage.setItem(LS_KEY, JSON.stringify(data));\r\n  } catch (e) {\r\n    console.warn(\"saveToStorage fail\", e);\r\n  }\r\n}\r\n/* =============================== Portal-aware Draggable =============================== */\r\nconst dragPortal = typeof document !== \"undefined\" ? document.body : null;\r\nfunction PortalAwareDraggable({ draggableId, index, children }) {\r\n  return (\r\n    <Draggable draggableId={draggableId} index={index}>\r\n      {(provided, snapshot) => {\r\n        //  function provided/snapshot  \" \" props  \r\n        const rendered =\r\n          typeof children === \"function\" ? children(provided, snapshot) : children;\r\n        return snapshot.isDragging && dragPortal\r\n          ? createPortal(rendered, dragPortal)\r\n          : rendered;\r\n      }}\r\n    </Draggable>\r\n  );\r\n}\r\n/* ===============================  UI / =============================== */\r\nfunction useOnClickOutside(refs, handler) {\r\n  const refsArray = React.useMemo(\r\n    () => (Array.isArray(refs) ? refs : [refs]),\r\n    // refs  ref    deps \r\n    [refs]\r\n  );\r\n  //  handler  ref \r\n  const handlerRef = React.useRef(handler);\r\n  React.useEffect(() => { handlerRef.current = handler; }, [handler]);\r\n  React.useEffect(() => {\r\n    const listener = (e) => {\r\n      if (refsArray.some(r => r?.current && r.current.contains(e.target))) return;\r\n      handlerRef.current?.(e);\r\n    };\r\n    // click ():  onClick  \r\n    document.addEventListener('click', listener, true);\r\n    return () => document.removeEventListener('click', listener, true);\r\n  }, [refsArray]);\r\n}\r\nfunction Dropdown({ value, items, onChange, placeholder, className }) {\r\n  const [open, setOpen] = useState(false);\r\n  const btnRef = useRef(null);\r\n  const menuRef = useRef(null);\r\n  const menuPos = useRef({ top: 0, left: 0, width: 0 });\r\n  const [, forceTick] = useState(0);   //   (   )\r\n  //  close-all-dropdowns   \r\n  useEffect(() => {\r\n    const h = () => setOpen(false);\r\n    window.addEventListener('close-all-dropdowns', h);\r\n    return () => window.removeEventListener('close-all-dropdowns', h);\r\n  }, []);\r\n  // /     (  )\r\n  useOnClickOutside([btnRef, menuRef], () => setOpen(false));\r\n  //          \r\n  useLayoutEffect(() => {\r\n    if (!open || !btnRef.current) return;\r\n    const rect = btnRef.current.getBoundingClientRect();\r\n    menuPos.current = {\r\n      top: rect.bottom + 4,\r\n      left: rect.left,\r\n      width: rect.width,\r\n    };\r\n    forceTick((v) => v + 1);\r\n    const onScroll = () => {\r\n      const r = btnRef.current?.getBoundingClientRect();\r\n      if (!r) return;\r\n      menuPos.current = {\r\n        top: r.bottom + 4,\r\n        left: r.left,\r\n        width: r.width,\r\n      };\r\n      forceTick((v) => v + 1);\r\n    };\r\n    window.addEventListener(\"scroll\", onScroll, { passive: true });\r\n    window.addEventListener(\"resize\", onScroll);\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", onScroll);\r\n      window.removeEventListener(\"resize\", onScroll);\r\n    };\r\n  }, [open]);\r\n  const selected = items.find((i) => i.value === value);\r\n  const menu = open ? (\r\n    <AnimatePresence>\r\n      <motion.ul\r\n        ref={menuRef}\r\n        key=\"menu\"\r\n        initial={{ opacity: 0, y: -4 }}\r\n        animate={{ opacity: 1, y: 0 }}\r\n        exit={{ opacity: 0, y: -4 }}\r\n        transition={{ duration: 0.12 }}\r\n        style={{\r\n          position: \"fixed\",\r\n          top: menuPos.current.top,\r\n          left: menuPos.current.left,\r\n          width: menuPos.current.width,\r\n          zIndex: 9999, // \r\n        }}\r\n        className=\"rounded-xl border bg-white shadow-lg overflow-auto max-h-60\"\r\n      >\r\n        {items.map((it) => (\r\n          <li key={String(it.value)}>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => {\r\n                if (it.disabled) return;         //    \r\n                onChange(it.value);\r\n                setOpen(false);\r\n              }}\r\n              aria-disabled={it.disabled ? true : undefined}\r\n              className={`w-full text-left px-3 py-2 text-sm ${it.disabled ? \"opacity-40 cursor-not-allowed\" : \"hover:bg-gray-50\"\r\n                } ${it.value === value ? \"bg-gray-100\" : \"\"}`}\r\n            >\r\n              <span className=\"block truncate\">{it.label}</span>\r\n            </button>\r\n          </li>\r\n        ))}\r\n      </motion.ul>\r\n    </AnimatePresence>\r\n  ) : null;\r\n  return (\r\n    <div ref={btnRef} className={`relative min-w-0 ${className || \"\"}`}>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => setOpen((v) => !v)}\r\n        className=\"min-w-0 h-10 w-full inline-flex items-center justify-between rounded-xl border px-3 bg-white hover:bg-gray-50 transition focus:outline-none focus:ring-2 focus:ring-[#a399f2]/50\"\r\n      >\r\n        <span className=\"truncate text-sm\">\r\n          {selected ? selected.label : placeholder || \"\"}\r\n        </span>\r\n        <span className=\"text-gray-500 text-sm select-none\">\r\n          {open ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\r\n        </span>\r\n      </button>\r\n      {open && createPortal(menu, document.body)}\r\n    </div>\r\n  );\r\n}\r\nfunction useToasts() {\r\n  const [toasts, setToasts] = useState([]);\r\n  const push = (msg) => {\r\n    const id = uid();\r\n    setToasts(t => [...t, { id, msg }]);\r\n    setTimeout(() => setToasts(t => t.filter(x => x.id !== id)), 2600);\r\n  };\r\n  const remove = (id) => setToasts(t => t.filter(x => x.id !== id));\r\n  return { toasts, push, remove };\r\n}\r\nfunction ToastStack({ toasts, onClose }) {\r\n  return (\r\n    <div className=\"fixed inset-0 z-[9999] flex items-center justify-center pointer-events-none px-4\">\r\n      <AnimatePresence>\r\n        {toasts.map(t => (\r\n          <motion.div key={t.id} initial={{ opacity: 0, scale: 0.98 }} animate={{ opacity: 1, scale: 1 }} exit={{ opacity: 0, scale: 0.98 }} transition={{ type: 'spring', stiffness: 380, damping: 28 }} className=\"pointer-events-auto overflow-hidden rounded-2xl border shadow-lg bg-amber-50/95 border-amber-200 text-amber-900 backdrop-blur px-4 py-3 flex items-center gap-3 min-w-[320px] max-w-[90vw]\">\r\n            <div className=\"text-sm flex-1\">{t.msg}</div>\r\n            <button className=\"text-sm font-medium text-amber-900/80 hover:text-amber-900 self-center\" onClick={() => onClose(t.id)} aria-label=\"\"></button>\r\n          </motion.div>\r\n        ))}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\nfunction NumberInput({\r\n  value,\r\n  onChange,          // (number|null)=>void\r\n  min,\r\n  max,\r\n  step = 1,\r\n  allowFloat = false,\r\n  zeroOnBlur = true, // blur   0(or min) \r\n  className = \"\",\r\n  inputProps = {},\r\n}) {\r\n  const toStr = (v) => (v === null || v === undefined ? \"\" : String(v));\r\n  const [inner, setInner] = React.useState(toStr(value));\r\n  React.useEffect(() => { setInner(toStr(value)); }, [value]);\r\n  const clamp = (n) => {\r\n    let x = n;\r\n    if (min != null && x < min) x = min;\r\n    if (max != null && x > max) x = max;\r\n    return x;\r\n  };\r\n  const normalizeOnBlur = (s) => {\r\n    if (s === \"\") return zeroOnBlur ? (min ?? 0) : null;\r\n    let n = Number(s);\r\n    if (!Number.isFinite(n)) return zeroOnBlur ? (min ?? 0) : null;\r\n    n = allowFloat ? n : Math.trunc(n);\r\n    return clamp(n);\r\n  };\r\n  //     ()\r\n  const handleWheel = (e) => e.currentTarget.blur();\r\n  return (\r\n    <input\r\n      type=\"number\"                     //  /  \r\n      inputMode={allowFloat ? \"decimal\" : \"numeric\"}\r\n      step={step}\r\n      min={min}\r\n      max={max}\r\n      value={inner}                     //  \"\"  (  )\r\n      onChange={(e) => {\r\n        const v = e.target.value;\r\n        if (v === \"\") {\r\n          setInner(\"\");\r\n          onChange?.(null);             //    null \r\n          return;\r\n        }\r\n        // number     (: \"1\", \"1.2\", \"1e2\")\r\n        setInner(v);\r\n        const num = Number(v);\r\n        if (Number.isFinite(num)) {\r\n          onChange?.(allowFloat ? num : Math.trunc(num)); //    ( null  )\r\n        } else {\r\n          onChange?.(null);\r\n        }\r\n      }}\r\n      onBlur={() => {\r\n        const n = normalizeOnBlur(inner);          // blur  /\r\n        setInner(n == null ? \"\" : String(n));\r\n        onChange?.(n);\r\n      }}\r\n      onWheel={handleWheel}\r\n      className={className}\r\n      {...inputProps}\r\n    />\r\n  );\r\n}\r\n/* ===============================   =============================== */\r\nexport default function LoACoreOptimizer() {\r\n  useEffect(() => { document.title = \"    \"; }, []);\r\n  // 3-1)  \r\n  const [category, setCategory] = useState/** @type {Category} */(\r\n    () => (loadFromStorage()?.category ?? \"order\")\r\n  );\r\n  // 3-2)  / \r\n  const [coresByCat, setCoresByCat] = useState(() => {\r\n    const loaded = loadFromStorage();\r\n    return loaded?.coresByCat ?? { order: [], chaos: [] };\r\n  });\r\n  const [gemsByCat, setGemsByCat] = useState(() => {\r\n    const loaded = loadFromStorage();\r\n    return loaded?.gemsByCat ?? { order: [], chaos: [] };\r\n  });\r\n  // ()   \r\n  const [role, setRole] = useState/** @type {Role|null} */(null);\r\n  const [weights, setWeights] = useState({ ...DEFAULT_WEIGHTS });\r\n  const [highlightCoreId, setHighlightCoreId] = useState(null);\r\n  const [highlightGemId, setHighlightGemId] = useState(null);\r\n  const { toasts, push, remove } = useToasts();\r\n  //   ( )\r\n  const [calcVersion, setCalcVersion] = useState(0);       // \"\"    +1\r\n  const [computing, setComputing] = useState(false);       //    \r\n  const [stale, setStale] = useState(true);                //   \r\n  const [priorityPicks, setPriorityPicks] = useState([]);  //    \r\n  //   / \r\n  const cores = coresByCat[category];\r\n  const gems = gemsByCat[category];\r\n  //    set  \r\n  const setCores = (updater) => {\r\n    setCoresByCat((prev) => {\r\n      const next = typeof updater === \"function\" ? updater(prev[category]) : updater;\r\n      setStale(true);\r\n      return { ...prev, [category]: next };\r\n    });\r\n  };\r\n  const setGems = (updater) => {\r\n    setGemsByCat((prev) => {\r\n      const next = typeof updater === \"function\" ? updater(prev[category]) : updater;\r\n      setStale(true);\r\n      return { ...prev, [category]: next };\r\n    });\r\n  };\r\n  useEffect(() => { setStale(true); }, [role, weights, category]);\r\n  const moveCoreUp = (index) => setCores(prev => {\r\n    if (index <= 0) return prev;\r\n    const next = [...prev];\r\n    [next[index - 1], next[index]] = [next[index], next[index - 1]];\r\n    return next;\r\n  });\r\n  const moveCoreDown = (index) => setCores(prev => {\r\n    if (index >= prev.length - 1) return prev;\r\n    const next = [...prev];\r\n    [next[index + 1], next[index]] = [next[index], next[index + 1]];\r\n    return next;\r\n  });\r\n  // \"\"   \r\n  useEffect(() => {\r\n    if (calcVersion === 0) return;  //   \r\n    let cancelled = false;\r\n    setComputing(true);\r\n    //   UI       \r\n    const id = setTimeout(() => {\r\n      try {\r\n        //   (  ,    300)\r\n        const perCoreLimit =\r\n          gems.length > 24 ? 120 :\r\n          gems.length > 16 ? 200 :\r\n          gems.length > 10 ? 260 : 300;\r\n        const { picks } = optimizeRoundRobinTargets(cores, gems, role, weights, perCoreLimit);\r\n        if (!cancelled) {\r\n          setPriorityPicks(picks || []);\r\n          setStale(false);\r\n        }\r\n      } finally {\r\n        if (!cancelled) setComputing(false);\r\n      }\r\n    }, 0);\r\n    return () => { cancelled = true; clearTimeout(id); };\r\n  //  : calcVersion  \r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [calcVersion]);\r\n  const resetWeights = () => setWeights({ ...DEFAULT_WEIGHTS });\r\n  const addGem = () => {\r\n    const id = uid();\r\n    setGems(v => [{ id, will: null, point: null, o1k: \"atk\", o1v: 0, o2k: \"add\", o2v: 0 }, ...v]);\r\n    setHighlightGemId(id);\r\n  };\r\n  const removeGem = (id) => {\r\n    setGems(v => v.filter(g => g.id !== id));\r\n    if (highlightGemId === id) setHighlightGemId(null);\r\n  };\r\n  const updateGem = (id, patch) => setGems(v => v.map(g => g.id === id ? { ...g, ...patch } : g));\r\n  const addCore = () => setCores(cs => {\r\n    if (cs.length >= 3) { push(\"  3   .\"); return cs; }\r\n    const existing = new Set(cs.map(c => c.name)); //  \r\n    const nextName = nextAvailableCoreName(existing);\r\n    if (!nextName) { push(\"//    .\"); return cs; }\r\n    const id = uid();\r\n    setHighlightCoreId(id);\r\n    return [\r\n      { id, name: nextName, grade: \"RELIC\", minThreshold: undefined, enforceMin: false },\r\n      ...cs\r\n    ];\r\n  });\r\n  const removeCore = (id) => {\r\n    setCores(cs => cs.length <= 0 ? cs : cs.filter(c => c.id !== id));\r\n    if (highlightCoreId === id) setHighlightCoreId(null);\r\n  };\r\n  const updateCore = (id, patch) => setCores(cs => {\r\n    if ('name' in patch) {\r\n      const dup = cs.some(c => c.id !== id && c.name === patch.name);\r\n      if (dup) {\r\n        push(`${patch.name}   `);\r\n        return cs; //  \r\n      }\r\n    }\r\n    return cs.map(c => c.id === id ? { ...c, ...patch } : c);\r\n  });\r\n  // Drag state (for backdrop blur toggle)\r\n  const [dragging, setDragging] = useState(false);\r\n  // DnD:    (  )\r\n  const onDragStart = () => {\r\n    requestAnimationFrame(() => setDragging(true));\r\n    //       \r\n    const evt = new Event('close-all-dropdowns');\r\n    window.dispatchEvent(evt);\r\n  };\r\n  const onDragEnd = (result) => {\r\n    requestAnimationFrame(() => setDragging(false));\r\n    if (!result.destination) return;\r\n    setCores(prev => {\r\n      const next = Array.from(prev);\r\n      const [moved] = next.splice(result.source.index, 1);\r\n      next.splice(result.destination.index, 0, moved);\r\n      return next;\r\n    });\r\n  };\r\n  // UI tokens (  )\r\n  const smallFieldBase = \"h-10 px-3 rounded-xl border focus:outline-none focus:ring-2 focus:ring-[#a399f2]/50 bg-white\";\r\n  const sectionTitle = \"text-base font-semibold whitespace-nowrap\";\r\n  const card = \"bg-white rounded-2xl shadow-sm\";\r\n  const chip = \"px-2.5 py-1.5 rounded-xl bg-gray-100 text-xs lg:text-[13px]\";\r\n  const labelCls = \"block text-xs text-gray-500 mb-1\";\r\n  //  : (1), (1)\r\n  const displayIndexCore = (idx) => idx + 1;\r\n  const displayIndexGem = (idx, total) => total - idx;\r\n  // ===== Self-tests (non-blocking) =====\r\n  useEffect(() => {\r\n    function runSelfTests() {\r\n      try {\r\n        const w = sanitizeWeights({ atk: 2, add: \"3\", boss: -1 });\r\n        console.assert(w.atk === 2 && w.add === 3 && w.boss === 1, \"sanitizeWeights failed\");\r\n        const gem = { id: \"t1\", will: 1, point: 1, o1k: \"atk\", o1v: 2, o2k: \"brand\", o2v: 3 };\r\n        console.assert(scoreGemForRole(gem, \"dealer\", w) === 2 * w.atk, \"scoreGemForRole dealer failed\");\r\n        console.assert(scoreGemForRole(gem, \"support\", w) === 3 * (w.brand ?? 1), \"scoreGemForRole support failed\");\r\n        console.assert(thresholdsHit(\"RELIC\", 20).includes(20) && thresholdsHit(\"RELIC\", 9).length === 0, \"thresholdsHit failed\");\r\n        const cA = scoreCombo([gem], \"RELIC\", \"dealer\", w);\r\n        const cB = scoreCombo([gem, { ...gem, id: \"t2\", will: 0, point: 10 }], \"RELIC\", \"dealer\", w);\r\n        console.assert(cB.score >= cA.score, \"scoreCombo monotonicity failed\");\r\n        console.log(\" Self-tests passed\");\r\n      } catch (e) {\r\n        console.warn(\" Self-tests encountered an error\", e);\r\n      }\r\n    }\r\n    runSelfTests();\r\n  }, []);\r\n  useEffect(() => {\r\n    saveToStorage({\r\n      category,\r\n      coresByCat,\r\n      gemsByCat,\r\n      //     /   \r\n      role,\r\n      weights,\r\n    });\r\n  }, [category, coresByCat, gemsByCat, role, weights]);\r\n  return (\r\n    <div className=\"min-h-screen text-gray-900 p-4 lg:p-6\" style={{\r\n      backgroundImage: \"linear-gradient(125deg, #85d8ea, #a399f2)\",\r\n      backgroundAttachment: 'fixed'\r\n    }}>\r\n      {/*     &  */}\r\n      <style>{`\r\n        :root{ --primary:#a399f2; --grad:linear-gradient(125deg,#85d8ea,#a399f2); }\r\n        .btn-primary{ background: #000000; color:#fff; border:none; }\r\n        .text-primary{ color:#a399f2; }\r\n        .accent-primary{ accent-color:#a399f2; }\r\n        .ring-primary:focus{ outline:none; box-shadow:0 0 0 2px rgba(163,153,242,.35); }\r\n      `}</style>\r\n      {/*     */}\r\n      <style>{`button{cursor:pointer}`}</style>\r\n      <div className=\"max-w-6xl mx-auto space-y-4 lg:space-y-6\">\r\n        {/*  + () */}\r\n        <section className=\"py-2 lg:py-3\">\r\n          <div className=\"flex items-center justify-between gap-3 flex-wrap\">\r\n            <h1 className=\"text-xl lg:text-2xl font-bold leading-tight text-white drop-shadow text-center lg:text-left w-full lg:w-auto\">\r\n                  \r\n            </h1>\r\n            {/*   ( ) */}\r\n            <div className=\"flex gap-2 w-auto ml-auto lg:ml-0\">\r\n              {/** /  */}\r\n              <button\r\n                onClick={() => setCategory(\"order\")}\r\n                className={`min-w-[84px] h-10 inline-flex items-center justify-center px-3 rounded-xl ${category === 'order' ? 'bg-white' : 'bg-white/70'}`}\r\n                title=\" \"\r\n              >\r\n                {CATEGORY_LABEL.order}\r\n              </button>\r\n              <button\r\n                onClick={() => setCategory(\"chaos\")}\r\n                className={`min-w-[84px] h-10 inline-flex items-center justify-center px-3 rounded-xl ${category === 'chaos' ? 'bg-white' : 'bg-white/70'}`}\r\n                title=\" \"\r\n              >\r\n                {CATEGORY_LABEL.chaos}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        {/*   (DnD ) */}\r\n        <section className={`${card} p-4 lg:p-6 !mt-2 ${dragging ? '' : 'backdrop-blur'}`}>\r\n          <div className=\"flex items-center gap-2 lg:gap-3\">\r\n            <h2 className={sectionTitle}>{CATEGORY_LABEL[category]}  </h2>\r\n            <div className=\"flex items-center gap-2 ml-auto whitespace-nowrap\">\r\n              <button className=\"h-10 w-10 lg:w-auto px-0 lg:px-3 rounded-xl border inline-flex items-center justify-center gap-2 bg-white hover:bg-white/90 ring-primary\" onClick={addCore} aria-label=\" \"><Plus size={16} /><span className=\"hidden lg:inline\">  </span></button>\r\n            </div>\r\n          </div>\r\n          <p className=\"hidden lg:block text-xs text-gray-600\">    . <b>   1( ) .</b></p>\r\n          <p className=\"block lg:hidden text-xs text-gray-600\">  . <b>   1( ) .</b></p>\r\n          <div className=\"mt-3\">\r\n            <DragDropContext onDragStart={onDragStart} onDragEnd={onDragEnd}>\r\n              <Droppable droppableId=\"cores-droppable\" ignoreContainerClipping={true}>\r\n                {(provided) => (\r\n                  <div ref={provided.innerRef} {...provided.droppableProps} className=\"flex flex-col gap-3\">\r\n                    {cores.map((c, idx) => {\r\n                      const supply = CORE_SUPPLY[c.grade];\r\n                      const targetItems = [{ value: '', label: '(  )' }].concat(\r\n                        CORE_THRESHOLDS[c.grade].map(v => ({ value: String(v), label: `${v}P ` }))\r\n                      );\r\n                      const takenNames = new Set(cores.filter(x => x.id !== c.id).map(x => x.name));\r\n                      const coreNameItems = CORE_NAME_ITEMS.map(it => ({\r\n                        ...it,\r\n                        disabled: takenNames.has(it.value)\r\n                      }));\r\n                      const minOfGrade = Math.min(...CORE_THRESHOLDS[c.grade]);\r\n                      return (\r\n                        <PortalAwareDraggable key={c.id} draggableId={c.id} index={idx}>\r\n                          {(prov) => (\r\n                            <div ref={prov.innerRef} {...prov.draggableProps} {...prov.dragHandleProps} className={`relative flex flex-col lg:flex-row lg:flex-nowrap gap-2 lg:gap-3 items-stretch lg:items-end border rounded-xl p-3 bg-white overflow-visible ${c.id === highlightCoreId ? 'LoA-highlight' : ''}`} style={prov.draggableProps.style}>\r\n                              {/* Index badge -   ,    */}\r\n                              <div className=\"h-10 w-10 flex items-center justify-center text-base font-semibold text-gray-800 bg-gray-100 rounded-xl self-start lg:self-center\">#{displayIndexCore(idx)}</div>\r\n                              <div className=\"flex flex-col min-w-[120px] w-full lg:w-40\">\r\n                                <label className={labelCls}> </label>\r\n                                <Dropdown className=\"w-full lg:w-40\" value={c.name} onChange={(val) => updateCore(c.id, { name: val })} items={coreNameItems} placeholder=\"\" />\r\n                              </div>\r\n                              <div className=\"flex flex-col min-w-[160px] w-full lg:w-auto\">\r\n                                <label className={labelCls}> </label>\r\n                                <Dropdown className=\"w-full lg:w-40\" value={c.grade} onChange={(val) => updateCore(c.id, { grade: /** @type {CoreGrade} */(val) })} items={GRADES.map(g => ({ value: g, label: CORE_LABEL[g] }))} placeholder=\" \" />\r\n                              </div>\r\n                              <div className=\"flex flex-col w-full lg:w-auto\">\r\n                                <label className={labelCls}> </label>\r\n                                <div className=\"h-10 px-3 rounded-xl border bg-gray-50 inline-flex items-center\"><span className=\"text-primary font-semibold\">{supply}</span></div>\r\n                              </div>\r\n                              <div className=\"flex flex-col w-full lg:w-auto\">\r\n                                <label className={labelCls}> </label>\r\n                                <Dropdown className=\"w-full lg:w-40\" value={String(c.minThreshold ?? '')} onChange={(val) => { if (val) updateCore(c.id, { minThreshold: Number(val), enforceMin: true }); else updateCore(c.id, { minThreshold: undefined, enforceMin: false }); }} items={targetItems} placeholder=\"\" />\r\n                              </div>\r\n                              <div className=\"flex flex-col w-full lg:w-auto\">\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <input id={`enf-${c.id}`} type=\"checkbox\" className=\"accent-primary\" checked={c.enforceMin} onChange={(e) => updateCore(c.id, { enforceMin: e.target.checked })} />\r\n                                  <label htmlFor={`enf-${c.id}`} className=\"text-sm\">  </label>\r\n                                </div>\r\n                                <p className=\"text-xs text-gray-500 mt-1\">    <br className=\"hidden lg:block\" />  <b className=\"text-primary\">{minOfGrade}P</b>   .</p>\r\n                              </div>\r\n                              {/* :   +    */}\r\n                              <div className=\"lg:ml-auto lg:static absolute top-2 right-2 flex items-center gap-1\">\r\n                                <div className=\"hidden lg:hidden\" />\r\n                                <div className=\"flex lg:hidden flex-row gap-1 mr-1\">\r\n                                  <button className=\"h-8 w-8 rounded-lg border inline-flex items-center justify-center bg-white\" onClick={() => moveCoreUp(idx)} aria-label=\"\"><ChevronUp size={16} /></button>\r\n                                  <button className=\"h-8 w-8 rounded-lg border inline-flex items-center justify-center bg-white\" onClick={() => moveCoreDown(idx)} aria-label=\"\"><ChevronDown size={16} /></button>\r\n                                </div>\r\n                                <button className=\"h-10 w-10 lg:w-auto px-0 lg:px-3 rounded-xl border-0 lg:border text-red-600 inline-flex items-center justify-center gap-2\" onClick={() => removeCore(c.id)} disabled={cores.length <= 0} aria-label=\" \"><Trash2 size={16} /><span className=\"hidden lg:inline\"> </span></button>\r\n                              </div>\r\n                            </div>\r\n                          )}\r\n                        </PortalAwareDraggable>\r\n                      );\r\n                    })}\r\n                    {provided.placeholder}\r\n                  </div>\r\n                )}\r\n              </Droppable>\r\n            </DragDropContext>\r\n            {cores.length === 0 && <div className=\"text-sm text-gray-700 p-2 text-center\"> . ( 3    )</div>}\r\n          </div>\r\n        </section>\r\n        {/*   */}\r\n        <section className={`${card} p-4 lg:p-6 ${dragging ? '' : 'backdrop-blur'}`}>\r\n          <div className=\"flex items-center gap-2 lg:gap-3 mb-3\">\r\n            <h2 className={sectionTitle}>{CATEGORY_LABEL[category]}  </h2>\r\n            <div className=\"flex gap-2 ml-auto whitespace-nowrap\">\r\n              <button className=\"h-10 w-10 lg:w-auto px-0 lg:px-3 rounded-xl border inline-flex items-center justify-center gap-2 bg-white hover:bg-white/90\" onClick={addGem} aria-label=\" \"><Plus size={16} /><span className=\"hidden lg:inline\">  </span></button>\r\n              <button className=\"h-10 w-10 lg:w-auto px-0 lg:px-3 rounded-xl border inline-flex items-center justify-center gap-2 bg-white hover:bg-white/90\" onClick={() => setGems([])} aria-label=\" \"><Trash2 size={16} /><span className=\"hidden lg:inline\">  </span></button>\r\n            </div>\r\n          </div>\r\n          <div className=\"flex flex-col gap-3\">\r\n            {gems.map((g, idx) => (\r\n              <div key={g.id} className={`relative flex flex-col lg:flex-row lg:flex-nowrap gap-2 lg:gap-3 items-stretch lg:items-center border rounded-xl p-3 overflow-visible min-w-0 bg-white ${g.id === highlightGemId ? 'LoA-highlight' : ''}`}>\r\n                <div className=\"h-10 w-10 flex items-center justify-center text-base font-semibold text-gray-800 bg-gray-100 rounded-xl flex-none\">#{displayIndexGem(idx, gems.length)}</div>\r\n                {/*   +  */}\r\n                <div className=\"w-full lg:w-auto flex flex-row gap-2 lg:gap-3 flex-1 lg:flex-none\">\r\n                  <div className=\"flex flex-col flex-1 min-w-0 lg:w-auto lg:flex-none\">\r\n                    <label className={labelCls}> </label>\r\n                    <NumberInput\r\n                      value={g.will}\r\n                      onChange={(v) => updateGem(g.id, { will: v })}\r\n                      min={0}\r\n                      max={9}\r\n                      step={1}\r\n                      allowFloat={false}\r\n                      className={`${smallFieldBase} w-full lg:w-24`}\r\n                      inputProps={{ title: \"\", placeholder: \"\" }}\r\n                    />\r\n                  </div>\r\n                  <div className=\"flex flex-col flex-1 min-w-0 lg:w-auto lg:flex-none\">\r\n                    <label className={labelCls}>(/)</label>\r\n                    <NumberInput\r\n                      value={g.point}\r\n                      onChange={(v) => updateGem(g.id, { point: v })}\r\n                      min={0}\r\n                      max={9}\r\n                      step={1}\r\n                      allowFloat={false}\r\n                      className={`${smallFieldBase} w-full lg:w-24`}\r\n                      inputProps={{ title: \"\", placeholder: \"\" }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                {/*  1 */}\r\n                <div className=\"flex items-end gap-2 w-full lg:w-auto lg:flex-none min-w-0\">\r\n                  <div className=\"flex-1 lg:flex-none min-w-0\">\r\n                    <label className={labelCls}> 1</label>\r\n                    <Dropdown className=\"w-full lg:w-44\" value={g.o1k} onChange={(val) => updateGem(g.id, { o1k: /** @type {OptionKey} */(val) })} items={OPTIONS.map(k => ({ value: k, label: OPTION_LABELS[k] }))} placeholder=\" \" />\r\n                  </div>\r\n                  <div className=\"flex-1 lg:flex-none\">\r\n                    <label className={labelCls}></label>\r\n                    <NumberInput\r\n                      value={g.o1v}\r\n                      onChange={(v) => updateGem(g.id, { o1v: v })}\r\n                      min={0}\r\n                      max={9}\r\n                      step={1}\r\n                      allowFloat={false}\r\n                      className=\"h-10 px-3 rounded-xl border focus:outline-none focus:ring-2 focus:ring-[#a399f2]/50 bg-white w-full lg:w-20\"\r\n                      inputProps={{ placeholder: \"0\" }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                {/*  2 */}\r\n                <div className=\"flex items-end gap-2 w-full lg:w-auto lg:flex-none min-w-0\">\r\n                  <div className=\"flex-1 lg:flex-none min-w-0\">\r\n                    <label className={labelCls}> 2</label>\r\n                    <Dropdown className=\"w-full lg:w-44\" value={g.o2k} onChange={(val) => updateGem(g.id, { o2k: /** @type {OptionKey} */(val) })} items={OPTIONS.map(k => ({ value: k, label: OPTION_LABELS[k] }))} placeholder=\" \" />\r\n                  </div>\r\n                  <div className=\"flex-1 lg:flex-none\">\r\n                    <label className={labelCls}></label>\r\n                    <NumberInput\r\n                      value={g.o2v}\r\n                      onChange={(v) => updateGem(g.id, { o2v: v })}\r\n                      min={0}\r\n                      max={9}\r\n                      step={1}\r\n                      allowFloat={false}\r\n                      className=\"h-10 px-3 rounded-xl border focus:outline-none focus:ring-2 focus:ring-[#a399f2]/50 bg-white w-full lg:w-20\"\r\n                      inputProps={{ placeholder: \"0\" }}\r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"lg:static absolute top-2 right-2 lg:top-auto lg:right-auto lg:ml-auto w-auto lg:flex-none\">\r\n                  <button className=\"h-10 w-10 lg:w-auto px-0 lg:px-3 rounded-xl border-0 lg:border text-red-600 inline-flex items-center justify-center gap-2\" onClick={() => removeGem(g.id)} aria-label=\" \"><Trash2 size={16} /><span className=\"hidden lg:inline\"> </span></button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n            {gems.length === 0 && <div className=\"text-sm text-gray-700 p-2 text-center\"> .</div>}\r\n          </div>\r\n        </section>\r\n        {/*   */}\r\n        <section className={`${card} p-4 lg:p-6 ${dragging ? '' : 'backdrop-blur'}`}>\r\n          <div className=\"flex items-center gap-2 lg:gap-3\">\r\n            <h2 className={sectionTitle}> </h2>\r\n            <button className=\"h-10 w-10 lg:w-auto px-0 lg:px-3 rounded-xl border ml-auto whitespace-nowrap inline-flex items-center justify-center gap-2 bg-white hover:bg-white/90\" onClick={resetWeights} aria-label=\" \"><RotateCcw size={16} /><span className=\"hidden lg:inline\">  </span></button>\r\n          </div>\r\n          <div className={`mb-1 flex items-center gap-4 text-sm`}>\r\n            <span className=\"text-xs text-gray-500\"> </span>\r\n            <label className=\"inline-flex items-center gap-2\">\r\n              <input\r\n                type=\"radio\"\r\n                name=\"role\"\r\n                checked={role === \"dealer\"}\r\n                onChange={() => {\r\n                  setRole(\"dealer\");\r\n                  setWeights((w) => maskWeightsForRole(w, \"dealer\"));\r\n                }}\r\n                className=\"accent-primary\"\r\n              />\r\n              \r\n            </label>\r\n            <label className=\"inline-flex items-center gap-2\">\r\n              <input\r\n                type=\"radio\"\r\n                name=\"role\"\r\n                checked={role === \"support\"}\r\n                onChange={() => {\r\n                  setRole(\"support\");\r\n                  setWeights((w) => maskWeightsForRole(w, \"support\"));\r\n                }}\r\n                className=\"accent-primary\"\r\n              />\r\n              \r\n            </label>\r\n          </div>\r\n          <div className=\"mt-3\">\r\n            <div className=\"grid grid-cols-2 gap-2 lg:flex lg:flex-nowrap text-sm min-w-0\">\r\n              {OPTIONS.map((k) => (\r\n                <div key={k} className=\"bg-gray-50 border rounded-xl px-2 py-2 w-full lg:w-1/6 min-w-[120px]\">\r\n                  <label className={labelCls}>{OPTION_LABELS[k]}</label>\r\n                  <NumberInput\r\n                    value={weights[k]}\r\n                    onChange={(v) => setWeights((w) => ({ ...w, [k]: (v) }))}\r\n                    min={0}\r\n                    max={5}\r\n                    step={0.0001}\r\n                    allowFloat={true}\r\n                    className=\"h-10 w-full px-2 rounded-md border bg-white focus:outline-none focus:ring-2 focus:ring-[#a399f2]/50\"\r\n                  />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </section>\r\n{/*   :   */}\r\n<div className=\"flex flex-col lg:flex-row lg:items-center gap-2\">\r\n  {/*     */}\r\n  {!stale && (\r\n  <p className=\"text-xs text-white hidden lg:block\">\r\n        <b></b>    .\r\n  </p>\r\n)}\r\n{stale && !computing && (\r\n  <span className=\"inline-block text-[11px] px-3 py-1.5 rounded-lg bg-red-100 text-red-800 border border-red-200 text-center lg:text-left\">\r\n     . <b></b>     .\r\n  </span>\r\n)}\r\n\r\n  <div className=\"flex items-center gap-2 lg:ml-auto w-full lg:w-auto\">\r\n\r\n    {/*      */}\r\n    <button\r\n      type=\"button\"\r\n      onClick={() => setCalcVersion(v => v + 1)}\r\n      disabled={computing}\r\n      className=\"h-10 w-full lg:w-[120px] px-0 lg:px-3 rounded-xl ml-auto whitespace-nowrap inline-flex items-center justify-center gap-2 bg-white hover:bg-white/90\"\r\n    >\r\n      {computing ? \" \" : \"\"}\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n        {/*  */}\r\n        <section className={`${card} p-4 lg:p-6 ${dragging ? '' : 'backdrop-blur'}`}>\r\n          <h2 className={sectionTitle}></h2>\r\n<p className=\"text-xs text-gray-600 mt-2\"> 1  <b> 4</b>   .</p>\r\n  {computing && <p className=\"text-xs text-gray-600 mt-1\">   </p>}\r\n  {!computing && calcVersion === 0 && (\r\n    <p className=\"text-xs text-gray-600 mt-1\">  .  <b></b>   .</p>\r\n  )}\r\n  {!computing && stale && calcVersion > 0 && (\r\n    <p className=\"text-xs text-red-700 mt-1\"> .  <b></b>     .</p>\r\n  )}\r\n          <div className=\"space-y-4 mt-2\">\r\n            {cores.map((c, i) => {\r\n              const supply = CORE_SUPPLY[c.grade];\r\n              const pick = priorityPicks?.[i];\r\n              const hasResult = !!(pick && pick.list && pick.list.length > 0);\r\n              const minOfGrade = Math.min(...CORE_THRESHOLDS[c.grade]);\r\n              return (\r\n                <div key={c.id} className=\"border rounded-xl p-3 bg-white\">\r\n                  <div className=\"flex items-center justify-between flex-wrap gap-2\">\r\n                    <div className=\"text-base font-semibold\">\r\n                      {c.name} <span className=\"text-sm text-gray-500\">({CORE_LABEL[c.grade]})</span>\r\n                    </div>\r\n                    {hasResult && (\r\n                      <div className=\"flex flex-wrap gap-2 items-center text-[12px] lg:text-[13px]\">\r\n                        <div className={chip}>  <span className=\"font-semibold\">{String(pick.totalWill)}</span> /  <span>{String(supply)}</span> (<span> {String(supply - pick.totalWill)}</span>)</div>\r\n                        <div className={chip}>  <span className=\"font-semibold\">{String(pick.totalPoint)}</span></div>\r\n                        {(() => {\r\n                          const maxThr = pick.thr.length ? Math.max(...pick.thr) : null;\r\n                          return (\r\n                            <div className={chip}>\r\n                                <span className=\"font-semibold\">{maxThr != null ? String(maxThr) : \"\"}</span>\r\n                            </div>\r\n                          );\r\n                        })()}\r\n                        <div className={chip}>  (\r\n                          <span className=\"font-semibold\">\r\n                            {role === 'dealer' ? \"\" : role === 'support' ? \"\" : \" \"}\r\n                          </span>\r\n                          <span className=\"font-semibold text-primary\">{String(pick.roleSum.toFixed(4))}</span></div>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                  {!hasResult ? (\r\n                    <div className=\"text-sm text-gray-700 mt-2\">\r\n                       . (     ,    .{c.minThreshold == null ? ` /  ${minOfGrade}P  ` : \"\"})\r\n                    </div>\r\n                  ) : (\r\n                    <>\r\n                      {/* Desktop table */}\r\n                      <div className=\"hidden lg:block overflow-x-auto mt-2\">\r\n                        <table className=\"min-w-full text-sm\">\r\n                          <thead>\r\n                            <tr className=\"text-left text-gray-500\">\r\n                              <th className=\"px-2 py-2\"></th>\r\n                              <th className=\"px-2 py-2\"></th>\r\n                              <th className=\"px-2 py-2\"></th>\r\n                              <th className=\"px-2 py-2\">1</th>\r\n                              <th className=\"px-2 py-2\">2</th>\r\n                              <th className=\"px-2 py-2\"></th>\r\n                            </tr>\r\n                          </thead>\r\n                          <tbody>\r\n                            {pick.list.map(g => {\r\n                              const gi = gems.findIndex(x => x.id === g.id);\r\n                              const disp = displayIndexGem(gi, gems.length);\r\n                              return (\r\n                                <tr key={g.id} className=\"border-t\">\r\n                                  <td className=\"px-2 py-2\">#{String(disp)}</td>\r\n                                  <td className=\"px-2 py-2\">{String(g.will ?? 0)}</td>\r\n                                  <td className=\"px-2 py-2\">{String(g.point ?? 0)}</td>\r\n                                  <td className=\"px-2 py-2\">{OPTION_LABELS[g.o1k]} {String(g.o1v)}</td>\r\n                                  <td className=\"px-2 py-2\">{OPTION_LABELS[g.o2k]} {String(g.o2v)}</td>\r\n                                  <td className=\"px-2 py-2 text-primary\">{String(scoreGemForRole(g, role, sanitizeWeights(weights)).toFixed(4))}</td>\r\n                                </tr>\r\n                              );\r\n                            })}\r\n                          </tbody>\r\n                        </table>\r\n                      </div>\r\n                      {/* Mobile cards */}\r\n                      <div className=\"lg:hidden mt-2 space-y-2\">\r\n                        {pick.list.map(g => {\r\n                          const gi = gems.findIndex(x => x.id === g.id);\r\n                          const disp = displayIndexGem(gi, gems.length);\r\n                          return (\r\n                            <div key={g.id} className=\"rounded-xl border p-3 bg-white\">\r\n                              <div className=\"flex items-center justify-between text-sm\">\r\n                                <div className=\"font-medium\">#{String(disp)}</div>\r\n                                <div className=\"text-xs text-primary\"> {String(scoreGemForRole(g, role, sanitizeWeights(weights)).toFixed(2))}</div>\r\n                              </div>\r\n                              <div className=\"mt-2 grid grid-cols-2 gap-x-3 gap-y-1 text-sm\">\r\n                                <div className=\"text-gray-500\"></div>\r\n                                <div>{String(g.will)}</div>\r\n                                <div className=\"text-gray-500\"></div>\r\n                                <div className=\"text-primary\">{String(g.point)}</div>\r\n                                <div className=\"text-gray-500\">1</div>\r\n                                <div>{OPTION_LABELS[g.o1k]} {String(g.o1v)}</div>\r\n                                <div className=\"text-gray-500\">2</div>\r\n                                <div>{OPTION_LABELS[g.o2k]} {String(g.o2v)}</div>\r\n                              </div>\r\n                            </div>\r\n                          );\r\n                        })}\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </section>\r\n      </div>\r\n      <ToastStack toasts={toasts} onClose={remove} />\r\n      <div className=\"mt-6\">\r\n        <KakaoAdfit />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useMemo, useRef, useState, useLayoutEffect, useCallback } from \"react\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\nimport { Edit3, Save, RotateCcw, RefreshCcw, ChevronDown, ChevronUp, Undo2, Redo2 } from \"lucide-react\";\r\nimport KakaoAdfit from \"./KakaoAdfit\";\r\nimport './LoACoreOptimizer.css';\r\nconst USE_ANTITHETIC = true;   //   ON\r\nconst AUTO_SCALE_RARE = true;  //    ON\r\n/* =========================\r\n    RNG  ( )\r\n   ========================= */\r\nfunction hash32(str) {\r\n  let h = 2166136261 >>> 0;\r\n  for (let i = 0; i < str.length; i++) {\r\n    h ^= str.charCodeAt(i);\r\n    h = Math.imul(h, 16777619);\r\n  }\r\n  return h >>> 0;\r\n}\r\nfunction makeDeterministicSeed(obj) {\r\n  const json = JSON.stringify(obj);\r\n  return hash32(json) || 1;\r\n}\r\nfunction makeRNG(seed) {\r\n  let s = seed >>> 0;\r\n  return function rand() {\r\n    s ^= s << 13;\r\n    s >>>= 0;\r\n    s ^= s >>> 17;\r\n    s >>>= 0;\r\n    s ^= s << 5;\r\n    s >>>= 0;\r\n    return (s >>> 0) / 4294967296;\r\n  };\r\n}\r\n// ===    ===\r\nconst isZeroProb = (p) => !(Number(p) > 0);\r\nconst isOneProb = (p) => Number(p) >= 1;\r\n/* =========================\r\n   // ( )\r\n   ========================= */\r\nconst GRADE = { LEGEND_MIN: 4, LEGEND_MAX: 15, RELIC_MIN: 16, RELIC_MAX: 18, ANCIENT_MIN: 19 };\r\nconst GEM_TYPES = {\r\n  \"-\": { baseNeed: 8, attack: [\"\", \" \"], support: [\"\", \"  \"] },\r\n  \"-\": { baseNeed: 9, attack: [\"\", \" \"], support: [\"  \", \"  \"] },\r\n  \"-\": { baseNeed: 10, attack: [\" \", \" \"], support: [\"\", \"  \"] },\r\n  \"-\": { baseNeed: 8, attack: [\"\", \" \"], support: [\"\", \"  \"] },\r\n  \"-\": { baseNeed: 9, attack: [\"\", \" \"], support: [\"  \", \"  \"] },\r\n  \"-\": { baseNeed: 10, attack: [\" \", \" \"], support: [\"\", \"  \"] },\r\n};\r\nconst RARITY_ATTEMPTS = { : 5, : 7, : 9 };\r\nconst RARITY_BASE_REROLLS = { : 0, : 1, : 2 };\r\nconst MIN_STAT = 1;\r\nconst MAX_STAT = 5;\r\nconst GOLD_PER_ATTEMPT = 900;\r\n//  TRIALS  opts  (  )\r\n// maxTrials:   , epsilon: 95% CI (), batch:  \r\n// note: successProb      \r\nconst clamp = (v, lo, hi) => Math.max(lo, Math.min(hi, v));\r\n// % :   ,  5 \r\nfunction fmtProbSmart(p) {\r\n  const x = Number(p);\r\n  if (!Number.isFinite(x) || x <= 0) return \"0%\";           //  0% 0\r\n  if (x >= 1) return \"100.00000%\";                          //   100.00000%\r\n  return (x * 100).toFixed(5) + \"%\";                        //   5 \r\n}\r\n//  \r\nconst fmtProb = (p) => fmtProbSmart(p);\r\nconst fmtNum = (n) => n.toLocaleString();\r\n// :  1      (  )\r\nfunction goldPerSuccess(expectedGold, p) {\r\n  if (!Number.isFinite(expectedGold) || expectedGold <= 0) return 0;\r\n  if (!Number.isFinite(p) || p <= 0) return Infinity; //  0%  \r\n  return expectedGold / p;\r\n}\r\n//  : width \r\nconst pct = (p) => `${Math.max(0, Math.min(100, Math.round((Number(p) || 0) * 100)))}%`;\r\n//  ():   \" \"\r\nfunction burdenBadge(p) {\r\n  if (p >= 0.20) return { label: \"\", tone: \"bg-emerald-50 border-emerald-200 text-emerald-800\" };\r\n  if (p >= 0.05) return { label: \"\", tone: \"bg-amber-50 border-amber-200 text-amber-800\" };\r\n  if (p >= 0.01) return { label: \"\", tone: \"bg-orange-50 border-orange-200 text-orange-800\" };\r\n  return { label: \" \", tone: \"bg-rose-50 border-rose-200 text-rose-800\" };\r\n}\r\n//  : mle(), laplace, jeffreys\r\nfunction estimateRate(successes, n, method = \"mle\") {\r\n  if (n <= 0) return 0;\r\n  //   :   1(=100%) \r\n  if (successes === 0) return 0;\r\n  if (successes === n) return 1;\r\n  switch (method) {\r\n    case \"laplace\":   // Beta(1,1)   (s+1)/(n+2)\r\n      return (successes + 1) / (n + 2);\r\n    case \"jeffreys\":  // Beta(0.5,0.5)   (s+0.5)/(n+1)\r\n      return (successes + 0.5) / (n + 1);\r\n    case \"mle\":\r\n    default:\r\n      return successes / n;\r\n  }\r\n}\r\nconst OFFICIAL_RNG = true;\r\n/* =====   / ===== */\r\nconst SIM_OPTIONS = [\r\n  { value: 1000, label: \"1,000 ()\" },\r\n  { value: 5000, label: \"5,000 ()\" },\r\n  { value: 10000, label: \"10,000 ()\" },\r\n  { value: 50000, label: \"50,000 ()\" },\r\n];\r\nfunction wilsonCI(p, n, z = 1.96) {\r\n  const denom = 1 + (z * z) / n;\r\n  const center = (p + (z * z) / (2 * n)) / denom;\r\n  const margin = (z / denom) * Math.sqrt((p * (1 - p) / n) + (z * z) / (4 * n * n));\r\n  return { low: Math.max(0, center - margin), high: Math.min(1, center + margin) };\r\n}\r\n// 0 successes  95%  (ClopperPearson )\r\nfunction zeroSuccessUpperBound(n, alpha = 0.05) {\r\n  return 1 - Math.pow(alpha, 1 / n); // ~= 3/n\r\n}\r\n//     (95% CI )  \r\nconst epsilonByTrials = (n) => {\r\n  if (n >= 200000) return 0.0001; // 0.01%p\r\n  if (n >= 100000) return 0.0002; // 0.02%p\r\n  if (n >= 50000) return 0.0003; // 0.03%p\r\n  if (n >= 10000) return 0.0005; // 0.05%p\r\n  if (n >= 5000) return 0.0007; // 0.07%p\r\n  return 0.001;                   // 0.10%p\r\n};\r\nconst batchByTrials = (n) => {\r\n  if (n >= 50000) return 1000;\r\n  if (n >= 10000) return 800;\r\n  if (n >= 5000) return 600;\r\n  return 400;\r\n};\r\n/* =========================\r\n   /// ( )\r\n   ========================= */\r\nfunction allowedEffectNames(gemKey, pos) {\r\n  const g = GEM_TYPES[gemKey];\r\n  if (!g) return [];\r\n  if (pos === \"\") return g.attack;\r\n  if (pos === \"\") return g.support;\r\n  return [...g.attack, ...g.support];\r\n}\r\nconst totalScore = (s) => s.eff + s.pts + s.aLvl + s.bLvl;\r\nfunction gradeOf(score) {\r\n  if (score >= GRADE.ANCIENT_MIN) return \"\";\r\n  if (score >= GRADE.RELIC_MIN && score <= GRADE.RELIC_MAX) return \"\";\r\n  if (score >= GRADE.LEGEND_MIN && score <= GRADE.LEGEND_MAX) return \"\";\r\n  return \" \";\r\n}\r\nfunction meetsTargetByMode(pos, abMode, s, t, gemKey, tgtNames) {\r\n  const base = s.eff >= t.eff && s.pts >= t.pts;\r\n  if (pos === \" \") return base;\r\n  //   : (/)    UI ,\r\n  //     \r\n  const pool = allowedEffectNames(gemKey, pos);\r\n  const isAny = (nm) => nm === \"\";\r\n  const TA = isAny(tgtNames?.aName) ? \"\" : (pool.includes(tgtNames?.aName) ? tgtNames?.aName : null);\r\n  const TB = isAny(tgtNames?.bName) ? \"\" : (pool.includes(tgtNames?.bName) ? tgtNames?.bName : null);\r\n  const match = (lineName, lineLvl, targetName, lvlReq) =>\r\n    isAny(targetName) ? (pool.includes(lineName) && lineLvl >= lvlReq)\r\n      : (lineName === targetName && lineLvl >= lvlReq);\r\n  if (abMode === \"ANY_ONE\") {\r\n    //    : (A  or B ) \"  A\" + t.aLvl\r\n    const okA = TA && (match(s.aName, s.aLvl, TA, t.aLvl) || match(s.bName, s.bLvl, TA, t.aLvl));\r\n    return base && !!okA;\r\n  } else {\r\n    // BOTH:      (  A/B   )\r\n    if (!TA || !TB) return false;\r\n    return base && (\r\n      (match(s.aName, s.aLvl, TA, t.aLvl) && match(s.bName, s.bLvl, TB, t.bLvl)) ||\r\n      (match(s.aName, s.aLvl, TB, t.bLvl) && match(s.bName, s.bLvl, TA, t.aLvl))\r\n    );\r\n  }\r\n}\r\nfunction needDistanceByMode(pos, abMode, s, t, gemKey, tgtNames) {\r\n  // ( /) \r\n  let sum = Math.max(0, t.eff - s.eff) + Math.max(0, t.pts - s.pts);\r\n  if (pos === \" \") return sum;\r\n  const pool = allowedEffectNames(gemKey, pos);\r\n  const isAny = (nm) => nm === \"\";\r\n  const TA = isAny(tgtNames?.aName) ? \"\" : (pool.includes(tgtNames?.aName) ? tgtNames?.aName : null);\r\n  const TB = isAny(tgtNames?.bName) ? \"\" : (pool.includes(tgtNames?.bName) ? tgtNames?.bName : null);\r\n  const levelCostTo = (curName, curLvl, targetName, targetLvl) => {\r\n    if (isAny(targetName)) {\r\n      const renameCost = pool.includes(curName) ? 0 : 1;\r\n      return renameCost + Math.max(0, targetLvl - curLvl);\r\n    }\r\n    return (curName === targetName ? 0 : 1) + Math.max(0, targetLvl - curLvl);\r\n  };\r\n  if (abMode === \"ANY_ONE\") {\r\n    if (!TA) return Number.POSITIVE_INFINITY;\r\n    // A TA  vs B TA \r\n    const c1 = levelCostTo(s.aName, s.aLvl, TA, t.aLvl);\r\n    const c2 = levelCostTo(s.bName, s.bLvl, TA, t.aLvl);\r\n    sum += Math.min(c1, c2);\r\n  } else {\r\n    if (!TA || !TB) return Number.POSITIVE_INFINITY;\r\n    // (ATA + BTB) vs (ATB + BTA)    \r\n    const c11 = levelCostTo(s.aName, s.aLvl, TA, t.aLvl) + levelCostTo(s.bName, s.bLvl, TB, t.bLvl);\r\n    const c22 = levelCostTo(s.aName, s.aLvl, TB, t.bLvl) + levelCostTo(s.bName, s.bLvl, TA, t.aLvl);\r\n    sum += Math.min(c11, c22);\r\n  }\r\n  return sum;\r\n}\r\n/* =========================\r\n   /// ( )\r\n   ========================= */\r\nfunction minusAppears_TABLE(v) { return v !== 1; }\r\nfunction buildWeightedItems(state, attemptsLeft, pos, gemKey, costAddRate) {\r\n  const s = state;\r\n  const items = [];\r\n  if (s.eff < 5) items.push({ slot: { kind: \"EFF\", delta: 1 }, w: 11.65 });\r\n  if (s.eff <= 3) items.push({ slot: { kind: \"EFF\", delta: 2 }, w: 4.4 });\r\n  if (s.eff <= 2) items.push({ slot: { kind: \"EFF\", delta: 3 }, w: 1.75 });\r\n  if (s.eff <= 1) items.push({ slot: { kind: \"EFF\", delta: 4 }, w: 0.45 });\r\n  if (minusAppears_TABLE(s.eff)) items.push({ slot: { kind: \"EFF\", delta: -1 }, w: 3.0 });\r\n  if (s.pts < 5) items.push({ slot: { kind: \"PTS\", delta: 1 }, w: 11.65 });\r\n  if (s.pts <= 3) items.push({ slot: { kind: \"PTS\", delta: 2 }, w: 4.4 });\r\n  if (s.pts <= 2) items.push({ slot: { kind: \"PTS\", delta: 3 }, w: 1.75 });\r\n  if (s.pts <= 1) items.push({ slot: { kind: \"PTS\", delta: 4 }, w: 0.45 });\r\n  if (minusAppears_TABLE(s.pts)) items.push({ slot: { kind: \"PTS\", delta: -1 }, w: 3.0 });\r\n  if (s.aLvl < 5) items.push({ slot: { kind: \"A_LVL\", delta: 1 }, w: 11.65 });\r\n  if (s.aLvl <= 3) items.push({ slot: { kind: \"A_LVL\", delta: 2 }, w: 4.4 });\r\n  if (s.aLvl <= 2) items.push({ slot: { kind: \"A_LVL\", delta: 3 }, w: 1.75 });\r\n  if (s.aLvl <= 1) items.push({ slot: { kind: \"A_LVL\", delta: 4 }, w: 0.45 });\r\n  if (minusAppears_TABLE(s.aLvl)) items.push({ slot: { kind: \"A_LVL\", delta: -1 }, w: 3.0 });\r\n  if (s.bLvl < 5) items.push({ slot: { kind: \"B_LVL\", delta: 1 }, w: 11.65 });\r\n  if (s.bLvl <= 3) items.push({ slot: { kind: \"B_LVL\", delta: 2 }, w: 4.4 });\r\n  if (s.bLvl <= 2) items.push({ slot: { kind: \"B_LVL\", delta: 3 }, w: 1.75 });\r\n  if (s.bLvl <= 1) items.push({ slot: { kind: \"B_LVL\", delta: 4 }, w: 0.45 });\r\n  if (minusAppears_TABLE(s.bLvl)) items.push({ slot: { kind: \"B_LVL\", delta: -1 }, w: 3.0 });\r\n  const names = allowedEffectNames(gemKey, \" \"); //    pos,   \" \"\r\n  const canAChange = names.filter((n) => n !== s.bName && n !== s.aName).length > 0;\r\n  const canBChange = names.filter((n) => n !== s.aName && n !== s.bName).length > 0;\r\n  if (canAChange) items.push({ slot: { kind: \"A_CHANGE\" }, w: 3.25 });\r\n  if (canBChange) items.push({ slot: { kind: \"B_CHANGE\" }, w: 3.25 });\r\n  if (attemptsLeft > 1) {\r\n    if (costAddRate !== 1) items.push({ slot: { kind: \"COST\", mod: 1 }, w: 1.75 });\r\n    if (costAddRate !== -1) items.push({ slot: { kind: \"COST\", mod: -1 }, w: 1.75 });\r\n    items.push({ slot: { kind: \"REROLL_PLUS\", amount: 1 }, w: 2.5 });\r\n    items.push({ slot: { kind: \"REROLL_PLUS\", amount: 2 }, w: 0.75 });\r\n  }\r\n  items.push({ slot: { kind: \"HOLD\" }, w: 1.75 });\r\n  return items;\r\n}\r\nfunction slotToPrettyLabel(slot, s) {\r\n  switch (slot.kind) {\r\n    case \"EFF\": return `  ${slot.delta > 0 ? \"+\" + slot.delta : \"-1\"}`;\r\n    case \"PTS\": return ` ${slot.delta > 0 ? \"+\" + slot.delta : \"-1\"}`;\r\n    case \"A_LVL\": return `${s.aName} Lv. ${slot.delta > 0 ? \"+\" + slot.delta : \"-1\"}`;\r\n    case \"B_LVL\": return `${s.bName} Lv. ${slot.delta > 0 ? \"+\" + slot.delta : \"-1\"}`;\r\n    case \"A_CHANGE\": return `${s.aName}  `;\r\n    case \"B_CHANGE\": return `${s.bName}  `;\r\n    case \"COST\": return slot.mod === 1 ? \"  +100% \" : \"  -100% \";\r\n    case \"HOLD\": return \"  \";\r\n    case \"REROLL_PLUS\": return `   ${slot.amount === 2 ? \"+2\" : \"+1\"}`;\r\n    default: return \"\";\r\n  }\r\n}\r\nfunction labelToSlot(label, s) {\r\n  label = label.trim();\r\n  const num = (t) => (t.includes(\"-1\") ? -1 : parseInt(t.replace(/[^0-9]/g, \"\"), 10) || 1);\r\n  if (label.startsWith(\" \")) return { kind: \"EFF\", delta: num(label) };\r\n  if (label.startsWith(\"\")) return { kind: \"PTS\", delta: num(label) };\r\n  if (label.startsWith(s.aName + \" \")) return label.includes(\"\") ? { kind: \"A_CHANGE\" } : { kind: \"A_LVL\", delta: num(label) };\r\n  if (label.startsWith(s.bName + \" \")) return label.includes(\"\") ? { kind: \"B_CHANGE\" } : { kind: \"B_LVL\", delta: num(label) };\r\n  if (label.startsWith(\" \")) return { kind: \"COST\", mod: label.includes(\"+100%\") ? 1 : -1 };\r\n  if (label.startsWith(\"  \")) return { kind: \"HOLD\" };\r\n  if (label.startsWith(\"  \")) return { kind: \"REROLL_PLUS\", amount: label.includes(\"+2\") ? 2 : 1 };\r\n  return null;\r\n}\r\nfunction applySlot(gemKey, pos, s, slot, costAddRate, rngFn) {\r\n  const rng = typeof rngFn === \"function\" ? rngFn : Math.random;\r\n  let next = { ...s };\r\n  const goldThisAttempt = GOLD_PER_ATTEMPT * (costAddRate === -1 ? 0 : costAddRate === 1 ? 2 : 1);\r\n  let nextRate = 0;\r\n  let rerollDelta = 0;\r\n  const names = allowedEffectNames(gemKey, \" \");\r\n  switch (slot.kind) {\r\n    case \"EFF\": next.eff = clamp(next.eff + slot.delta, 0, MAX_STAT); break;\r\n    case \"PTS\": next.pts = clamp(next.pts + slot.delta, 0, MAX_STAT); break;\r\n    case \"A_LVL\": next.aLvl = clamp(next.aLvl + slot.delta, 0, MAX_STAT); break;\r\n    case \"B_LVL\": next.bLvl = clamp(next.bLvl + slot.delta, 0, MAX_STAT); break;\r\n    case \"A_CHANGE\": {\r\n      const pool = names.filter((n) => n !== next.bName && n !== next.aName);\r\n      if (pool.length) {\r\n        const pick = pool[Math.floor(rng() * pool.length)];\r\n        next.aName = pick;\r\n      }\r\n      break;\r\n    }\r\n    case \"B_CHANGE\": {\r\n      const pool = names.filter((n) => n !== next.aName && n !== next.bName);\r\n      if (pool.length) {\r\n        const pick = pool[Math.floor(rng() * pool.length)];\r\n        next.bName = pick;\r\n      }\r\n      break;\r\n    }\r\n    case \"COST\": nextRate = slot.mod; break;\r\n    case \"HOLD\": break;\r\n    case \"REROLL_PLUS\": rerollDelta += slot.amount; break;\r\n    default: break;\r\n  }\r\n  return { next, goldThisAttempt, nextRate, rerollDelta };\r\n}\r\n/* =========================\r\n    ( )\r\n   ========================= */\r\nconst ZERO_VALUE = { successProb: 0, legendProb: 0, relicProb: 0, ancientProb: 0, expectedGold: 0 };\r\n//  () +   (rare-guard) \r\nfunction evaluateFromSimulation(\r\n  gemKey, pos, abMode, start, target, policy, attemptsLeft, rerolls, costAddRate, unlockedReroll, selectedFirstFour, seed, tgtNames, opts = {}\r\n) {\r\n  const {\r\n    maxTrials = 50000,\r\n    epsilon = 0.002,\r\n    batch = 1000,\r\n    minTrials = Math.min(10000, maxTrials),\r\n    estimator = \"jeffreys\",\r\n    //   \r\n    useAntithetic = true,          // ():   \r\n    autoScaleRare = true,          //  \r\n    rareTargetSuccesses = 100,      //       \r\n    rareMaxTrials = 200000,            // ( )\r\n    rareTiers = [200000], //    \r\n  } = opts;\r\n  //   ()\r\n  const desirability = (s) => needDistanceByMode(pos, abMode, s, target, gemKey, tgtNames);\r\n  //     (   rand )\r\n  const simOnce = (rand) => {\r\n    const weightedPickIndex = (arr) => {\r\n      const sum = arr.reduce((a, b) => a + b.w, 0);\r\n      let r = rand() * sum;\r\n      for (let i = 0; i < arr.length; i++) { r -= arr[i].w; if (r <= 0) return i; }\r\n      return arr.length - 1;\r\n    };\r\n    let s = { ...start };\r\n    let gold = 0;\r\n    let left = attemptsLeft;\r\n    let rrs = rerolls;\r\n    let unlocked = unlockedReroll;\r\n    let rate = costAddRate;\r\n    let first = true;\r\n    if (policy === \"STOP_ON_SUCCESS\" &&\r\n      meetsTargetByMode(pos, abMode, s, target, gemKey, tgtNames)) {\r\n      const score = totalScore(s);\r\n      const g = gradeOf(score);\r\n      return {\r\n        successProb: 1,\r\n        legendProb: g === \"\" ? 1 : 0,\r\n        relicProb: g === \"\" ? 1 : 0,\r\n        ancientProb: g === \"\" ? 1 : 0,\r\n        expectedGold: 0,\r\n      };\r\n    }\r\n    while (left > 0) {\r\n      let cand = [];\r\n      if (first && selectedFirstFour.length > 0) {\r\n        cand = selectedFirstFour.slice(0, 4);\r\n      } else {\r\n        const pool = buildWeightedItems(s, left, pos, gemKey, rate);\r\n        if (!pool.length) break;\r\n        const temp = [...pool];\r\n        const n = Math.min(4, temp.length);\r\n        for (let i = 0; i < n; i++) {\r\n          const idx = weightedPickIndex(temp);\r\n          cand.push(temp[idx].slot);\r\n          temp.splice(idx, 1);\r\n        }\r\n      }\r\n      if (OFFICIAL_RNG) {\r\n        const pick = cand[Math.floor(rand() * cand.length)];\r\n        const res = applySlot(gemKey, pos, s, pick, rate, rand);\r\n        s = res.next; gold += res.goldThisAttempt; rate = res.nextRate; rrs += res.rerollDelta; unlocked = true;\r\n      } else {\r\n        const namesList = allowedEffectNames(gemKey, pos);\r\n        const aName = s.aName, bName = s.bName;\r\n        const canAChange = namesList.some((n) => n !== bName && n !== aName);\r\n        const canBChange = namesList.some((n) => n !== aName && n !== bName);\r\n        const before = desirability(s);\r\n        let best = null;\r\n        for (const sl of cand) {\r\n          if (sl.kind === \"A_CHANGE\" && !canAChange) continue;\r\n          if (sl.kind === \"B_CHANGE\" && !canBChange) continue;\r\n          const res = applySlot(gemKey, pos, s, sl, rate, rand);\r\n          const gain = before - desirability(res.next);\r\n          if (!best || gain > best.gain) {\r\n            best = { next: res.next, gold: res.goldThisAttempt, nextRate: res.nextRate, rrd: res.rerollDelta, gain };\r\n          }\r\n        }\r\n        if (best && best.gain <= 0 && unlocked && rrs > 0) { rrs -= 1; first = false; continue; }\r\n        if (best) { s = best.next; gold += best.gold; rate = best.nextRate; rrs += best.rrd; unlocked = true; }\r\n      }\r\n      left -= 1; first = false;\r\n      if (policy === \"STOP_ON_SUCCESS\" && meetsTargetByMode(pos, abMode, s, target, gemKey, tgtNames)) break;\r\n    }\r\n    const score = totalScore(s);\r\n    const g = gradeOf(score);\r\n    return {\r\n      successProb: meetsTargetByMode(pos, abMode, s, target, gemKey, tgtNames) ? 1 : 0,\r\n      legendProb: g === \"\" ? 1 : 0,\r\n      relicProb: g === \"\" ? 1 : 0,\r\n      ancientProb: g === \"\" ? 1 : 0,\r\n      expectedGold: gold,\r\n    };\r\n  };\r\n  //  \r\n  let n = 0;\r\n  let succSum = 0, legendSum = 0, relicSum = 0, ancientSum = 0, goldSum = 0;\r\n  let agg = { ...ZERO_VALUE, trialsUsed: 0, ci: { low: 0, high: 0, halfWidth: 0 } };\r\n  //     \r\n  let localMaxTrials = maxTrials;\r\n  // :   (0%     )\r\n  let forceRare = false;\r\n  //   \r\n  const tiers = Array.isArray(rareTiers) && rareTiers.length\r\n    ? [...rareTiers].sort((a, b) => a - b)\r\n    : [rareMaxTrials];\r\n  const hardCap = tiers[tiers.length - 1];\r\n  const nextTier = (cur) => tiers.find(t => t > cur) || cur;\r\n  const firstTier = tiers[0];\r\n  const seedForTrial = (baseSeed, idx) => {\r\n    // 32-bit   \r\n    const mixed = (baseSeed >>> 0) ^ (Math.imul((idx + 1) >>> 0, 2654435761) >>> 0);\r\n    return mixed >>> 0;\r\n  };\r\n  const updateCI = () => {\r\n    const p = succSum / Math.max(1, n);\r\n    let ci;\r\n    if (p === 0) {\r\n      const up = zeroSuccessUpperBound(n);\r\n      ci = { low: 0, high: up, halfWidth: up / 2 };\r\n    } else if (p === 1) {\r\n      const up = zeroSuccessUpperBound(n);\r\n      const low = 1 - up;\r\n      ci = { low, high: 1, halfWidth: (1 - low) / 2 };\r\n    } else {\r\n      const w = wilsonCI(p, n);\r\n      ci = { low: w.low, high: w.high, halfWidth: (w.high - w.low) / 2 };\r\n    }\r\n    agg.ci = ci;\r\n    return ci;\r\n  };\r\n  while (n < localMaxTrials) {\r\n    //    \"\"  (   trial   2)\r\n    const steps = batch;\r\n    for (let i = 0; i < steps; i++) {\r\n      //   \r\n      if (n >= localMaxTrials) break;\r\n      const trialSeed = seedForTrial(seed >>> 0, n + i);\r\n      //  \r\n      const r1 = makeRNG(trialSeed);\r\n      const one = simOnce(r1);\r\n      succSum += one.successProb;\r\n      legendSum += one.legendProb;\r\n      relicSum += one.relicProb;\r\n      ancientSum += one.ancientProb;\r\n      goldSum += one.expectedGold;\r\n      n += 1;\r\n      //   (  1-u )\r\n      if (useAntithetic && n < localMaxTrials) {\r\n        const r2base = makeRNG(trialSeed);\r\n        const r2 = () => 1 - r2base();\r\n        const two = simOnce(r2);\r\n        succSum += two.successProb;\r\n        legendSum += two.legendProb;\r\n        relicSum += two.relicProb;\r\n        ancientSum += two.ancientProb;\r\n        goldSum += two.expectedGold;\r\n        n += 1;\r\n      }\r\n    }\r\n    const ci = updateCI();\r\n    const hw = ci.halfWidth || 0;\r\n    // 0%       ' ' \r\n    if (autoScaleRare && n >= minTrials && succSum === 0 && localMaxTrials < hardCap) {\r\n      //   ,    \r\n      localMaxTrials = localMaxTrials < firstTier ? firstTier : nextTier(localMaxTrials);\r\n      forceRare = true;   //      \r\n      continue;\r\n    }\r\n    //  :       ( )\r\n    const rareGuardActive =\r\n      autoScaleRare &&\r\n      n >= minTrials &&\r\n      succSum < rareTargetSuccesses &&\r\n      localMaxTrials < hardCap;\r\n    if (rareGuardActive) {\r\n      //   : 20  50  100 (      )\r\n      const next = localMaxTrials < firstTier ? firstTier : nextTier(localMaxTrials);\r\n      localMaxTrials = Math.min(hardCap, next);\r\n      continue; //  \r\n    }\r\n    //   \r\n    if (!forceRare && hw <= epsilon && n >= minTrials) break;\r\n  }\r\n  agg.trialsUsed = n;\r\n  agg.successProb = estimateRate(succSum, n, estimator);\r\n  agg.legendProb = estimateRate(legendSum, n, estimator);\r\n  agg.relicProb = estimateRate(relicSum, n, estimator);\r\n  agg.ancientProb = estimateRate(ancientSum, n, estimator);\r\n  agg.expectedGold = goldSum / Math.max(1, n);\r\n  // UI:   ()\r\n  agg.successes = succSum | 0;\r\n  return agg;\r\n}\r\n// =====    (start   ) =====\r\nconst GRADE_GRADIENTS = {\r\n  legend: \"linear-gradient(90deg, #7A3E00, #B16800)\",  // :    \r\n  relic: \"linear-gradient(90deg, #8C2F06, #AB4102)\",  // :    \r\n  ancient: \"linear-gradient(90deg, #A67C37, #F5DFAB)\",  // :    \r\n};\r\n//    + (>=)  \r\nfunction rankGradeOrder(run, eps = 0.0005) {\r\n  if (!run) return { order: [], comps: [] };\r\n  let arr = [\r\n    { key: \"legendProb\", label: \"\", p: Number(run.legendProb || 0), grad: GRADE_GRADIENTS.legend },\r\n    { key: \"relicProb\", label: \"\", p: Number(run.relicProb || 0), grad: GRADE_GRADIENTS.relic },\r\n    { key: \"ancientProb\", label: \"\", p: Number(run.ancientProb || 0), grad: GRADE_GRADIENTS.ancient },\r\n  ];\r\n  // 0%   \r\n  arr = arr.filter(it => !isZeroProb(it.p));\r\n  if (!arr.length) return { order: [], comps: [] };\r\n  arr.sort((a, b) => b.p - a.p);\r\n  const comps = [];\r\n  for (let i = 0; i < arr.length - 1; i++) {\r\n    const diff = arr[i].p - arr[i + 1].p;\r\n    comps.push(Math.abs(diff) <= eps ? \"=\" : \">\");\r\n  }\r\n  return { order: arr, comps };\r\n}\r\n/* ===============================\r\n    UI(LoACore ): Dropdown + Toast + NumberInput\r\n   =============================== */\r\nfunction useOnClickOutside(refs, handler) {\r\n  const refsArray = useMemo(() => (Array.isArray(refs) ? refs : [refs]), [refs]);\r\n  const handlerRef = useRef(handler);\r\n  useEffect(() => { handlerRef.current = handler; }, [handler]);\r\n  useEffect(() => {\r\n    const listener = (e) => {\r\n      if (refsArray.some(r => r?.current && r.current.contains(e.target))) return;\r\n      handlerRef.current?.(e);\r\n    };\r\n    document.addEventListener('click', listener, true);\r\n    return () => document.removeEventListener('click', listener, true);\r\n  }, [refsArray]);\r\n}\r\nfunction Dropdown({ \r\n  value, \r\n  items, \r\n  onChange, \r\n  placeholder, \r\n  className, \r\n  disabled, \r\n  bordered = true // : border \r\n}) {\r\n  const [open, setOpen] = useState(false);\r\n  const btnRef = useRef(null);\r\n  const menuRef = useRef(null);\r\n  const menuPos = useRef({ top: 0, left: 0, width: 0 });\r\n  const [, forceTick] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const h = () => setOpen(false);\r\n    window.addEventListener('close-all-dropdowns', h);\r\n    return () => window.removeEventListener('close-all-dropdowns', h);\r\n  }, []);\r\n\r\n  useOnClickOutside([btnRef, menuRef], () => setOpen(false));\r\n\r\n  useLayoutEffect(() => {\r\n    if (!open || !btnRef.current) return;\r\n    const rect = btnRef.current.getBoundingClientRect();\r\n    menuPos.current = { top: rect.bottom + 4, left: rect.left, width: rect.width };\r\n    forceTick((v) => v + 1);\r\n    const onScroll = () => {\r\n      const r = btnRef.current?.getBoundingClientRect(); if (!r) return;\r\n      menuPos.current = { top: r.bottom + 4, left: r.left, width: r.width };\r\n      forceTick((v) => v + 1);\r\n    };\r\n    window.addEventListener(\"scroll\", onScroll, { passive: true });\r\n    window.addEventListener(\"resize\", onScroll);\r\n    return () => { \r\n      window.removeEventListener(\"scroll\", onScroll); \r\n      window.removeEventListener(\"resize\", onScroll); \r\n    };\r\n  }, [open]);\r\n\r\n  const selected = items.find((i) => i.value === value);\r\n\r\n  const menu = open && !disabled ? (\r\n    <AnimatePresence>\r\n      <motion.ul\r\n        ref={menuRef}\r\n        key=\"menu\"\r\n        initial={{ opacity: 0, y: -4, scale: 0.98 }}\r\n        animate={{ opacity: 1, y: 0, scale: 1 }}\r\n        exit={{ opacity: 0, y: -4, scale: 0.98 }}\r\n        transition={{ duration: 0.12 }}\r\n        style={{ position: \"fixed\", top: menuPos.current.top, left: menuPos.current.left, width: menuPos.current.width, zIndex: 9999 }}\r\n        className={`rounded-xl bg-white shadow-lg overflow-auto max-h-60 ${bordered ? \"border\" : \"\"}`}\r\n      >\r\n        {items.map((it) => (\r\n          <li key={String(it.value)}>\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => { if (it.disabled) return; onChange(it.value); setOpen(false); }}\r\n              aria-disabled={it.disabled ? true : undefined}\r\n              className={`w-full text-left px-3 py-2 text-sm ${it.disabled ? \"cursor-not-allowed\" : \"hover:bg-gray-50\"} ${it.value === value ? \"bg-gray-100\" : \"\"}`}\r\n            >\r\n              <span className=\"block truncate\">{it.label}</span>\r\n            </button>\r\n          </li>\r\n        ))}\r\n      </motion.ul>\r\n    </AnimatePresence>\r\n  ) : null;\r\n\r\n  return (\r\n    <div ref={btnRef} className={`relative min-w-0 ${className || \"\"}`}>\r\n      <button\r\n        type=\"button\"\r\n        onClick={() => !disabled && setOpen((v) => !v)}\r\n        disabled={disabled}\r\n        className={`min-w-0 h-10 w-full inline-flex items-center justify-between rounded-xl px-3 bg-white hover:bg-gray-50 transition focus:outline-none focus:ring-2 focus:ring-[#a399f2]/50 ${bordered ? \"border\" : \"\"} ${disabled ? \"cursor-not-allowed\" : \"\"}`}\r\n      >\r\n        <span className=\"truncate text-sm\">{selected ? selected.label : placeholder || \"\"}</span>\r\n        <span className=\"text-gray-500 text-sm select-none\">{open ? <ChevronUp size={16} /> : <ChevronDown size={16} />}</span>\r\n      </button>\r\n      {open && menu}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction useToasts() {\r\n  const [toasts, setToasts] = useState([]);\r\n  const push = (msg, tone = \"info\") => {\r\n    const id = Math.random().toString(36).slice(2, 9);\r\n    setToasts((t) => [...t, { id, msg, tone }]);\r\n    setTimeout(() => setToasts((t) => t.filter((x) => x.id !== id)), 2600);\r\n  };\r\n  const remove = (id) => setToasts((t) => t.filter((x) => x.id !== id));\r\n  return { toasts, push, remove };\r\n}\r\nfunction ToastStack({ toasts, onClose }) {\r\n  const toneBg = (tone) => ({\r\n    success: \"bg-emerald-50/95 border-emerald-200 text-emerald-900\",\r\n    info: \"bg-sky-50/95 border-sky-200 text-sky-900\",\r\n    warning: \"bg-amber-50/95 border-amber-200 text-amber-900\",\r\n    error: \"bg-rose-50/95 border-rose-200 text-rose-900\",\r\n  }[tone] || \"bg-amber-50/95 border-amber-200 text-amber-900\");\r\n  const toneBtn = (tone) => ({\r\n    success: \"text-emerald-900/80 hover:text-emerald-900\",\r\n    info: \"text-sky-900/80 hover:text-sky-900\",\r\n    warning: \"text-amber-900/80 hover:text-amber-900\",\r\n    error: \"text-rose-900/80 hover:text-rose-900\",\r\n  }[tone] || \"text-amber-900/80 hover:text-amber-900\");\r\n  return (\r\n    <div className=\"fixed inset-0 z-[9999] flex space-y-2 flex-col items-center justify-center pointer-events-none px-4\">\r\n      <AnimatePresence>\r\n        {toasts.map((t) => (\r\n          <motion.div\r\n            key={t.id}\r\n            initial={{ opacity: 0, scale: 0.98 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            exit={{ opacity: 0, scale: 0.98 }}\r\n            transition={{ type: \"spring\", stiffness: 380, damping: 28 }}\r\n            className={`pointer-events-auto overflow-hidden rounded-2xl border shadow-lg backdrop-blur px-4 py-3 flex items-center gap-3 min-w-[320px] max-w-[90vw] ${toneBg(t.tone)}`}\r\n          >\r\n            <div className=\"text-sm flex-1\">{t.msg}</div>\r\n            <button\r\n              className={`text-sm font-medium self-center ${toneBtn(t.tone)}`}\r\n              onClick={() => onClose(t.id)}\r\n              aria-label=\"\"\r\n            >\r\n              \r\n            </button>\r\n          </motion.div>\r\n        ))}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\nfunction NumberInput({\r\n  value,\r\n  set,                 // (old) (number)=>void\r\n  onChange,            // (new) (number|null)=>void\r\n  min = MIN_STAT,\r\n  max = 99,\r\n  step = 1,\r\n  allowFloat = false,\r\n  zeroOnBlur = true,\r\n  className = \"\",\r\n  inputProps = {},\r\n  disabled,\r\n}) {\r\n  const toStr = (v) => (v === null || v === undefined ? \"\" : String(v));\r\n  const [inner, setInner] = React.useState(toStr(value));\r\n  React.useEffect(() => { setInner(toStr(value)); }, [value]);\r\n  const clampLocal = (n) => {\r\n    let x = n;\r\n    if (min != null && x < min) x = min;\r\n    if (max != null && x > max) x = max;\r\n    return x;\r\n  };\r\n  const normalizeOnBlur = (s) => {\r\n    if (s === \"\") return zeroOnBlur ? (min ?? 0) : null;\r\n    let n = Number(s);\r\n    if (!Number.isFinite(n)) return zeroOnBlur ? (min ?? 0) : null;\r\n    n = allowFloat ? n : Math.trunc(n);\r\n    return clampLocal(n);\r\n  };\r\n  // wheel   (  /)\r\n  const handleWheel = (e) => e.currentTarget.blur();\r\n  // /  \r\n  const hasNewApi = typeof onChange === \"function\";\r\n  const callOld = typeof set === \"function\";\r\n  return (\r\n    <input\r\n      type=\"number\"\r\n      inputMode={allowFloat ? \"decimal\" : \"numeric\"}\r\n      step={step}\r\n      min={min}\r\n      max={max}\r\n      disabled={disabled}\r\n      value={inner}\r\n      onChange={(e) => {\r\n        const v = e.target.value;\r\n        //     \r\n        if (v === \"\") {\r\n          setInner(\"\");\r\n          if (hasNewApi) onChange(null);\r\n          // (set)   null   (  )\r\n          return;\r\n        }\r\n        setInner(v);\r\n        const num = Number(v);\r\n        if (!Number.isFinite(num)) {\r\n          if (hasNewApi) onChange(null);\r\n          return;\r\n        }\r\n        const n = allowFloat ? num : Math.trunc(num);\r\n        if (hasNewApi) {\r\n          //  API:    ( blur  )\r\n          onChange(n);\r\n        } else if (callOld) {\r\n          //  API:   +  (  )\r\n          set(clampLocal(n));\r\n        }\r\n      }}\r\n      onBlur={() => {\r\n        const n = normalizeOnBlur(inner);\r\n        setInner(n == null ? \"\" : String(n));\r\n        if (hasNewApi) {\r\n          onChange(n);\r\n        } else if (callOld) {\r\n          //  API: null   ( min/0) \r\n          set(n == null ? (min ?? 0) : n);\r\n        }\r\n      }}\r\n      onWheel={handleWheel}\r\n      className={`h-10 px-3 rounded-xl border focus:outline-none focus:ring-2 focus:ring-[#a399f2]/50 bg-white ${className}`}\r\n      {...inputProps}\r\n    />\r\n  );\r\n}\r\n/* ===============================\r\n    Select API   Dropdown \r\n   =============================== */\r\nconst Select = ({ value, set, options, disabled, placeholder }) => {\r\n  const items = (options || []).map((o) =>\r\n    typeof o === \"string\"\r\n      ? { value: o, label: o }\r\n      : { value: o.value ?? o, label: o.label ?? String(o) }\r\n  );\r\n  return (\r\n    <Dropdown\r\n      value={value}\r\n      onChange={set}\r\n      items={items}\r\n      disabled={!!disabled}\r\n      className=\"w-full lg:w-full\"\r\n      placeholder={placeholder || \"\"}\r\n    />\r\n  );\r\n};\r\n/* =========================\r\n      ( )\r\n   ========================= */\r\nfunction hasDuplicateLabels(labels) {\r\n  const arr = labels.filter(Boolean);\r\n  return new Set(arr).size !== arr.length;\r\n}\r\n/* =========================\r\n    \r\n   ========================= */\r\nexport default function GemSimulator() {\r\n  const { toasts, push, remove } = useToasts();\r\n  const [gemKey, setGemKey] = useState(\"-\");\r\n  const [pos, setPos] = useState(\" \");\r\n  const [rarity, setRarity] = useState(\"\");\r\n  const [abModePrimary, setAbModePrimary] = useState(\"ANY_ONE\");\r\n  const effectPoolAny = useMemo(() => allowedEffectNames(gemKey, \" \"), [gemKey]);\r\n  const effectPoolByPos = useMemo(() => allowedEffectNames(gemKey, \" \"), [gemKey]);\r\n  const [cur, setCur] = useState({ eff: MIN_STAT, pts: MIN_STAT, aName: effectPoolAny[0], aLvl: MIN_STAT, bName: effectPoolAny[1] || effectPoolAny[0], bLvl: MIN_STAT });\r\n  const [tgt, setTgt] = useState({ eff: MIN_STAT, pts: MIN_STAT, aLvl: MIN_STAT, bLvl: MIN_STAT });\r\n  const [tgtNames, setTgtNames] = useState({\r\n    aName: allowedEffectNames(gemKey, pos)[0],   //  \r\n    bName: allowedEffectNames(gemKey, pos)[1] || allowedEffectNames(gemKey, pos)[0],\r\n  });\r\n  const [basicLocked, setBasicLocked] = useState(false);\r\n  const [curLocked, setCurLocked] = useState(false);\r\n  const [tgtLocked, setTgtLocked] = useState(false);\r\n  //         (   )\r\n  const curValid = cur.aName !== cur.bName;\r\n  //    (Monte Carlo maxTrials)\r\n  const [simTrials, setSimTrials] = useState(10000);\r\n  const migratedRef = useRef(false); // StrictMode   ()\r\n  useEffect(() => {\r\n    if (migratedRef.current) return;\r\n    migratedRef.current = true;\r\n    setCur(s => ({\r\n      ...s,\r\n      eff: Math.max(s.eff, MIN_STAT),\r\n      pts: Math.max(s.pts, MIN_STAT),\r\n      aLvl: Math.max(s.aLvl, MIN_STAT),\r\n      bLvl: Math.max(s.bLvl, MIN_STAT),\r\n    }));\r\n    setTgt(t => ({\r\n      ...t,\r\n      eff: Math.max(t.eff, MIN_STAT),\r\n      pts: Math.max(t.pts, MIN_STAT),\r\n      aLvl: Math.max(t.aLvl, MIN_STAT),\r\n      bLvl: Math.max(t.bLvl, MIN_STAT),\r\n    }));\r\n  }, []);\r\n  const [manual, setManual] = useState(() => ({\r\n    attemptsLeft: RARITY_ATTEMPTS[rarity],\r\n    rerolls: RARITY_BASE_REROLLS[rarity],\r\n    unlocked: false,\r\n    costAddRate: 0,\r\n    gold: 0,\r\n    state: { ...cur },\r\n  }));\r\n  useEffect(() => {\r\n    setManual((m) => ({\r\n      ...m,\r\n      attemptsLeft: RARITY_ATTEMPTS[rarity],\r\n      rerolls: RARITY_BASE_REROLLS[rarity],\r\n      state: { ...cur },\r\n      unlocked: false,\r\n      costAddRate: 0,\r\n      gold: 0,\r\n    }));\r\n  }, [rarity, cur]);\r\n  const [changeMode, setChangeMode] = useState(null); // { who: 'A'|'B', options: string[] }\r\n  const [changePick, setChangePick] = useState(\"\");\r\n  // ==== Undo/Redo  ====\r\n  const HISTORY_LIMIT = 50;\r\n  const [history, setHistory] = useState({ past: [], future: [] });\r\n  // manual, changeMode, changePick    \r\n  const takeSnapshot = useCallback(() => ({\r\n    manual: JSON.parse(JSON.stringify(manual)),\r\n    changeMode: changeMode ? { ...changeMode, options: [...changeMode.options] } : null,\r\n    changePick\r\n  }), [manual, changeMode, changePick]);\r\n  const restoreSnapshot = useCallback((snap) => {\r\n    setManual(snap.manual);\r\n    setChangeMode(snap.changeMode);\r\n    setChangePick(snap.changePick);\r\n  }, []);\r\n  const pushHistory = useCallback(() => {\r\n    setHistory(h => {\r\n      const nextPast = [...h.past, takeSnapshot()];\r\n      //  \r\n      while (nextPast.length > HISTORY_LIMIT) nextPast.shift();\r\n      return { past: nextPast, future: [] };\r\n    });\r\n  }, [takeSnapshot]);\r\n  const canUndo = history.past.length > 0;\r\n  const canRedo = history.future.length > 0;\r\n  // ====  (Log) ====\r\n  const LOG_LIMIT = 200;\r\n  const [logs, setLogs] = useState([]); //    \r\n  const nowStr = () => {\r\n    const d = new Date();\r\n    const pad = (n) => String(n).padStart(2, '0');\r\n    return `${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;\r\n  };\r\n  const addLog = useCallback((entry) => {\r\n    // entry: { type, title, detail?, meta? }\r\n    setLogs((prev) => [\r\n      { id: Math.random().toString(36).slice(2), time: nowStr(), ...entry },\r\n      ...prev\r\n    ].slice(0, LOG_LIMIT));\r\n  }, []);\r\n  const undo = useCallback(() => {\r\n    setHistory(h => {\r\n      if (h.past.length === 0) return h;\r\n      const prev = h.past[h.past.length - 1];\r\n      const newPast = h.past.slice(0, -1);\r\n      const current = takeSnapshot();\r\n      //  \r\n      restoreSnapshot(prev);\r\n      addLog({ type: 'undo', title: '', detail: '  ' });\r\n      return { past: newPast, future: [current, ...h.future] };\r\n    });\r\n  }, [restoreSnapshot, takeSnapshot, addLog]);\r\n  const redo = useCallback(() => {\r\n    setHistory(h => {\r\n      if (h.future.length === 0) return h;\r\n      const next = h.future[0];\r\n      const restFuture = h.future.slice(1);\r\n      const current = takeSnapshot();\r\n      //  \r\n      restoreSnapshot(next);\r\n      addLog({ type: 'redo', title: '', detail: ' ' });\r\n      return { past: [...h.past, current], future: restFuture };\r\n    });\r\n  }, [restoreSnapshot, takeSnapshot, addLog]);\r\n  //  : Ctrl/Cmd+Z = Undo, Ctrl/Cmd+Shift+Z = Redo\r\n  useEffect(() => {\r\n    const onKey = (e) => {\r\n      const isMod = e.ctrlKey || e.metaKey;\r\n      if (!isMod) return;\r\n      if (e.key.toLowerCase() === 'z') {\r\n        e.preventDefault();\r\n        if (e.shiftKey) { if (canRedo) redo(); }\r\n        else { if (canUndo) undo(); }\r\n      }\r\n    };\r\n    window.addEventListener('keydown', onKey);\r\n    return () => window.removeEventListener('keydown', onKey);\r\n  }, [canUndo, canRedo, undo, redo]);\r\n  //     diff  \r\n  const diffStats = (before, after) => {\r\n    const parts = [];\r\n    const pushIf = (k, label = k) => {\r\n      if (before[k] !== after[k]) parts.push(`${label} ${before[k]}${after[k]}`);\r\n    };\r\n    pushIf('eff', '');\r\n    pushIf('pts', '');\r\n    if (before.aName !== after.aName || before.aLvl !== after.aLvl) {\r\n      const name = before.aName === after.aName ? after.aName : `${before.aName}${after.aName}`;\r\n      parts.push(`A ${name} Lv.${before.aLvl}${after.aLvl}`);\r\n    }\r\n    if (before.bName !== after.bName || before.bLvl !== after.bLvl) {\r\n      const name = before.bName === after.bName ? after.bName : `${before.bName}${after.bName}`;\r\n      parts.push(`B ${name} Lv.${before.bLvl}${after.bLvl}`);\r\n    }\r\n    return parts.join('  ');\r\n  };\r\n  // /      \r\n  useEffect(() => {\r\n    const pool = allowedEffectNames(gemKey, pos);\r\n    setTgtNames((old) => {\r\n      const a = pool.includes(old.aName) ? old.aName : pool[0];\r\n      const bCand = pool[1] || pool[0];\r\n      const b = pool.includes(old.bName) ? old.bName : (a === bCand ? pool.find(n => n !== a) || a : bCand);\r\n      return { aName: a, bName: b };\r\n    });\r\n  }, [gemKey, pos]);\r\n  const allOptionLabels = useMemo(() => {\r\n    const items = buildWeightedItems(manual.state, manual.attemptsLeft, pos, gemKey, manual.costAddRate);\r\n    const labels = items.map((it) => slotToPrettyLabel(it.slot, manual.state));\r\n    return Array.from(new Set(labels));\r\n  }, [manual.state, manual.attemptsLeft, manual.costAddRate, pos, gemKey]);\r\n  const defaultLabels = useMemo(() => {\r\n    const want = [`  +1`, ` +1`, `${manual.state.aName} Lv. +1`, `${manual.state.bName} Lv. +1`];\r\n    const out = [];\r\n    let cursor = 0;\r\n    for (const w of want) {\r\n      if (allOptionLabels.includes(w) && !out.includes(w)) out.push(w);\r\n      else {\r\n        while (cursor < allOptionLabels.length && out.includes(allOptionLabels[cursor])) cursor++;\r\n        out.push(allOptionLabels[cursor] ?? w);\r\n        cursor++;\r\n      }\r\n    }\r\n    while (out.length < 4) {\r\n      while (cursor < allOptionLabels.length && out.includes(allOptionLabels[cursor])) cursor++;\r\n      out.push(allOptionLabels[cursor++] ?? allOptionLabels[0] ?? \"  \");\r\n    }\r\n    return out.slice(0, 4);\r\n  }, [allOptionLabels, manual.state.aName, manual.state.bName]);\r\n  const [manLabels, setManLabels] = useState(defaultLabels);\r\n  useEffect(() => {\r\n    setManLabels((prev) => {\r\n      const next = prev.map((v, i) => (allOptionLabels.includes(v) ? v : allOptionLabels[i] ?? allOptionLabels[0] ?? v));\r\n      const used = new Set();\r\n      for (let i = 0; i < next.length; i++) {\r\n        if (!used.has(next[i])) { used.add(next[i]); continue; }\r\n        const replacement = allOptionLabels.find((l) => !used.has(l));\r\n        if (replacement) { next[i] = replacement; used.add(replacement); }\r\n      }\r\n      return next;\r\n    });\r\n  }, [allOptionLabels]);\r\n  const [resultStop, setResultStop] = useState(null);\r\n  const [resultRun, setResultRun] = useState(null);\r\n  const [isComputing, setIsComputing] = useState(false);\r\n  const tokenRef = useRef(0);\r\n  const timerRef = useRef(null);\r\n  //   refs & \r\n  const simRef = useRef(null);       // ( ) \r\n  const [logsMax, setLogsMax] = useState(null); //   max-height(px)\r\n  useLayoutEffect(() => {\r\n    const recalc = () => {\r\n      if (simRef.current) {\r\n        setLogsMax(simRef.current.offsetHeight);\r\n      }\r\n    };\r\n    recalc();\r\n    window.addEventListener('resize', recalc);\r\n    return () => window.removeEventListener('resize', recalc);\r\n    //         \r\n  }, [manual, manLabels, resultRun, resultStop, changeMode, tgtLocked, basicLocked, curLocked]);\r\n  /*    EV ( ) */\r\n  const REROLL_SAMPLES = 16;\r\n  const TAU = 0.0025;\r\n  const expectedSuccessProbForLabels = useCallback((labels, gemKeyIn, posIn, abForEval, manualIn, tgtIn, seed) => {\r\n    let acc = 0, cnt = 0;\r\n    for (const lb of labels) {\r\n      const sl = labelToSlot(lb, manualIn.state); if (!sl) continue;\r\n      if (sl.kind === \"A_CHANGE\") {\r\n        const ok = allowedEffectNames(gemKeyIn, \" \").filter((n) => n !== manualIn.state.bName && n !== manualIn.state.aName).length > 0;\r\n        if (!ok) continue;\r\n      }\r\n      if (sl.kind === \"B_CHANGE\") {\r\n        const ok = allowedEffectNames(gemKeyIn, \" \").filter((n) => n !== manualIn.state.aName && n !== manualIn.state.bName).length > 0;\r\n        if (!ok) continue;\r\n      }\r\n      const res = applySlot(gemKeyIn, posIn, manualIn.state, sl, manualIn.costAddRate, () => {\r\n        //     seed  rand  \r\n        return (makeRNG(seed + hash32(lb))());\r\n      });\r\n      const nextManual = {\r\n        attemptsLeft: manualIn.attemptsLeft - 1,\r\n        rerolls: manualIn.rerolls + res.rerollDelta,\r\n        unlocked: true,\r\n        costAddRate: res.nextRate,\r\n        gold: manualIn.gold + res.goldThisAttempt,\r\n        state: res.next,\r\n      };\r\n      const v = evaluateFromSimulation(\r\n        gemKeyIn, posIn, abForEval, nextManual.state, tgtIn, \"RUN_TO_END\",\r\n        nextManual.attemptsLeft, nextManual.rerolls, nextManual.costAddRate, nextManual.unlocked, [],\r\n        seed + hash32(lb), tgtNames,\r\n        {\r\n          maxTrials: Math.min(8000, simTrials),\r\n          minTrials: Math.min(8000, simTrials),\r\n          epsilon: 0.006,\r\n          batch: 500,\r\n          estimator: \"jeffreys\",\r\n          useAntithetic: USE_ANTITHETIC,\r\n          autoScaleRare: false\r\n        }\r\n      );\r\n      acc += v.successProb; cnt += 1;\r\n    }\r\n    return cnt ? acc / cnt : 0;\r\n  }, [tgtNames, simTrials]);\r\n  function sampleNewFourSlots(seed, gemKeyIn, posIn, manualIn) {\r\n    const rng = makeRNG(seed);\r\n    const pool = buildWeightedItems(manualIn.state, manualIn.attemptsLeft, posIn, gemKeyIn, manualIn.costAddRate);\r\n    const temp = [...pool];\r\n    const out = [];\r\n    const weightedPickIndex = (arr) => {\r\n      const sum = arr.reduce((a, b) => a + b.w, 0);\r\n      let r = rng() * sum;\r\n      for (let i = 0; i < arr.length; i++) { r -= arr[i].w; if (r <= 0) return i; }\r\n      return arr.length - 1;\r\n    };\r\n    const n = Math.min(4, temp.length);\r\n    for (let i = 0; i < n; i++) { const idx = weightedPickIndex(temp); out.push(temp[idx].slot); temp.splice(idx, 1); }\r\n    return out;\r\n  }\r\n  function slotsToLabels(slots, s) { return slots.map((sl) => slotToPrettyLabel(sl, s)); }\r\n  const rerollAdvice = useMemo(() => {\r\n    if (!manual.unlocked) return { shouldReroll: false, reason: \"        .\" };\r\n    if (manual.rerolls <= 0) return { shouldReroll: false, reason: \"   .\" };\r\n    if (manual.attemptsLeft <= 0) return { shouldReroll: false, reason: \"      .\" };\r\n    const abForEval = pos === \" \" ? \"ANY_ONE\" : abModePrimary;\r\n    const seedBase = makeDeterministicSeed({ gemKey, pos, rarity, manual, tgt, manLabels, abForEval, salt: \"REROLL_EV\" });\r\n    const nowProb = expectedSuccessProbForLabels(manLabels, gemKey, pos, abForEval, manual, tgt, seedBase + 7);\r\n    let acc = 0;\r\n    for (let i = 0; i < REROLL_SAMPLES; i++) {\r\n      const seed = seedBase + 1000 + i * 31;\r\n      const afterRerollManual = { ...manual, rerolls: manual.rerolls - 1 };\r\n      const newSlots = sampleNewFourSlots(seed, gemKey, pos, afterRerollManual);\r\n      const newLabels = slotsToLabels(newSlots, afterRerollManual.state);\r\n      const prob = expectedSuccessProbForLabels(newLabels, gemKey, pos, abForEval, afterRerollManual, tgt, seed + 17);\r\n      acc += prob;\r\n    }\r\n    const rerollProb = acc / REROLL_SAMPLES;\r\n    const delta = rerollProb - nowProb;\r\n    const pct = (x) => (x * 100).toFixed(2) + \"%\";\r\n    if (delta > TAU) {\r\n      return { shouldReroll: true, reason: `     :   ${pct(nowProb)}      ${pct(rerollProb)} (${pct(delta)}).` };\r\n    } else if (delta < -TAU) {\r\n      return { shouldReroll: false, reason: `     :   ${pct(nowProb)}     ${pct(rerollProb)}  (${pct(-delta)}).` };\r\n    } else {\r\n      return { shouldReroll: false, reason: `   :  ${pct(nowProb)} vs    ${pct(rerollProb)} (|| < ${(TAU * 100).toFixed(2)}%).` };\r\n    }\r\n  }, [gemKey, pos, rarity, manual, tgt, manLabels, abModePrimary, expectedSuccessProbForLabels]);\r\n  // BOTH  ,   ''      \r\n  useEffect(() => {\r\n    if (abModePrimary !== \"BOTH\" || pos === \" \") return;\r\n    const base = allowedEffectNames(gemKey, pos);\r\n    setTgtNames((prev) => {\r\n      const a = base.includes(prev.aName) && prev.aName !== \"\" ? prev.aName : base[0];\r\n      const bCandidate = base.find((n) => n !== a) || base[0];\r\n      const b = base.includes(prev.bName) && prev.bName !== \"\" && prev.bName !== a ? prev.bName : bCandidate;\r\n      return { aName: a, bName: b };\r\n    });\r\n  }, [abModePrimary, gemKey, pos]);\r\n  /*    */\r\n  useEffect(() => {\r\n    if (!tgtLocked || !curValid) { setResultStop(null); setResultRun(null); return; }\r\n    if (hasDuplicateLabels(manLabels)) {\r\n      setResultStop(null); setResultRun(null);\r\n      return;\r\n    }\r\n    const selectedFirstFour = manLabels.map((lb) => labelToSlot(lb, manual.state)).filter((x) => !!x);\r\n    const calcMode = pos === \" \" ? \"IGNORE_AB\" : abModePrimary;\r\n    const abForEval = pos === \" \" ? \"ANY_ONE\" : abModePrimary;\r\n    const seedBase = makeDeterministicSeed({ gemKey, pos, rarity, manual, tgt, selectedFirstFour, calcMode });\r\n    const token = ++tokenRef.current;\r\n    setIsComputing(true);\r\n    //   \r\n    if (timerRef.current) clearTimeout(timerRef.current);\r\n    timerRef.current = setTimeout(() => {\r\n      const commonOpts = {\r\n        maxTrials: simTrials,\r\n        minTrials: simTrials,\r\n        epsilon: epsilonByTrials(simTrials),\r\n        batch: batchByTrials(simTrials),\r\n        estimator: \"jeffreys\",\r\n        useAntithetic: USE_ANTITHETIC,\r\n        autoScaleRare: AUTO_SCALE_RARE,\r\n        rareTargetSuccesses: 100,\r\n        rareTiers: [200000],\r\n      };\r\n      const stop = evaluateFromSimulation(\r\n        gemKey, pos, abForEval, manual.state, tgt, \"STOP_ON_SUCCESS\",\r\n        manual.attemptsLeft, manual.rerolls, manual.costAddRate, manual.unlocked, selectedFirstFour, seedBase + 101, tgtNames,\r\n        commonOpts\r\n      );\r\n      const run = evaluateFromSimulation(\r\n        gemKey, pos, abForEval, manual.state, tgt, \"RUN_TO_END\",\r\n        manual.attemptsLeft, manual.rerolls, manual.costAddRate, manual.unlocked, selectedFirstFour, seedBase + 103, tgtNames,\r\n        commonOpts\r\n      );\r\n      if (token === tokenRef.current) { setResultStop(stop); setResultRun(run); setIsComputing(false); }\r\n    }, 0);\r\n    // clean up:   /   +  \r\n    return () => {\r\n      if (timerRef.current) {\r\n        clearTimeout(timerRef.current);\r\n        timerRef.current = null;\r\n      }\r\n    };\r\n  }, [gemKey, pos, rarity, curValid, manual, tgt, tgtLocked, manLabels, abModePrimary, tgtNames, simTrials]);\r\n  /*  :   */\r\n  function applyManual(slotIdx) {\r\n    if (!allLocked) { push(\"  ' / / '  ().\", \"warning\"); return; }\r\n    pushHistory();\r\n    if (!tgtLocked) { push(\"    .\"); return; }\r\n    if (manual.attemptsLeft <= 0) return;\r\n    if (hasDuplicateLabels(manLabels)) { push(\"  . .\"); return; }\r\n    const label = manLabels[slotIdx];\r\n    if (!allOptionLabels.includes(label)) { push(\"      .\"); return; }\r\n    const action = labelToSlot(label, manual.state);\r\n    if (!action) { push(\"   .\"); return; }\r\n    //     ' '      \r\n    if (action.kind === \"A_CHANGE\" || action.kind === \"B_CHANGE\") {\r\n      const names = allowedEffectNames(gemKey, \" \");\r\n      const pool = names.filter((n) => n !== manual.state.aName && n !== manual.state.bName);\r\n      if (pool.length <= 0) { push(\"  /   .\"); return; }\r\n      setChangeMode({ who: action.kind === \"A_CHANGE\" ? \"A\" : \"B\", options: pool });\r\n      setChangePick(pool[0]);\r\n      push(\"   .       .\", \"info\");\r\n      return; //    ( /  )\r\n    }\r\n    if (manual.attemptsLeft <= 0) {\r\n      push(\"      .\", \"warning\");\r\n      return;\r\n    }\r\n    const before = { ...manual.state };\r\n    const res = applySlot(gemKey, pos, manual.state, action, manual.costAddRate);\r\n    const nextAttemptsLeft = manual.attemptsLeft - 1;\r\n    setManual((m) => ({\r\n      attemptsLeft: nextAttemptsLeft,\r\n      rerolls: m.rerolls + res.rerollDelta,\r\n      unlocked: true,\r\n      costAddRate: res.nextRate,\r\n      gold: m.gold + res.goldThisAttempt,\r\n      state: res.next,\r\n    }));\r\n    addLog({\r\n      type: 'apply',\r\n      title: ` ${slotIdx + 1} : ${label}`,\r\n      detail: diffStats(before, res.next),\r\n      meta: { cost: res.goldThisAttempt, attemptsLeft: nextAttemptsLeft, rerollDelta: res.rerollDelta }\r\n    });\r\n    if (nextAttemptsLeft > 0) {\r\n      push(\"  .  4   .\", \"success\");\r\n    }\r\n  }\r\n  function doReroll() {\r\n    if (!allLocked) { push(\"       .\", \"warning\"); return; }\r\n    if (manual.attemptsLeft <= 0) { push(\"       .\"); return; }\r\n    if (!manual.unlocked) { push(\" 1       .\"); return; }\r\n    if (manual.rerolls <= 0) { push(\"    .\"); return; }\r\n    pushHistory(); //    \r\n    setManual((m) => ({ ...m, rerolls: m.rerolls - 1 }));\r\n    addLog({\r\n      type: 'reroll',\r\n      title: '   ',\r\n      detail: `    ${manual.rerolls - 1}`,\r\n    });\r\n  }\r\n  function manualReset() {\r\n    setLogs([]);   //   \r\n    setHistory({ past: [], future: [] }); //    \r\n    setManual({ attemptsLeft: RARITY_ATTEMPTS[rarity], rerolls: RARITY_BASE_REROLLS[rarity], unlocked: false, costAddRate: 0, gold: 0, state: { ...cur } });\r\n  }\r\n  function confirmEffectChange() {\r\n    if (!changeMode) return;\r\n    if (!allLocked) { push(\"       .\", \"warning\"); return; }\r\n    pushHistory(); //    \r\n    const goldThisAttempt =\r\n      GOLD_PER_ATTEMPT * (manual.costAddRate === -1 ? 0 : manual.costAddRate === 1 ? 2 : 1);\r\n    const before = { ...manual.state };\r\n    setManual((m) => {\r\n      const next = { ...m.state };\r\n      if (changeMode.who === \"A\") next.aName = changePick;\r\n      else next.bName = changePick;\r\n      return {\r\n        attemptsLeft: m.attemptsLeft - 1, //   \r\n        rerolls: m.rerolls,\r\n        unlocked: true,\r\n        costAddRate: m.costAddRate,\r\n        gold: m.gold + goldThisAttempt,\r\n        state: next,\r\n      };\r\n    });\r\n    const after = { ...manual.state, ...(changeMode.who === \"A\" ? { aName: changePick } : { bName: changePick }) };\r\n    addLog({\r\n      type: 'change',\r\n      title: `   (${changeMode.who})  ${changePick}`,\r\n      detail: diffStats(before, after),\r\n      meta: { cost: goldThisAttempt }\r\n    });\r\n    setChangeMode(null);\r\n    push(\"  .\", \"success\");\r\n  }\r\n  function cancelEffectChange() {\r\n    setChangeMode(null);\r\n    push(\"  .\", \"warning\");\r\n  }\r\n  /* ====== UI  ====== */\r\n  useEffect(() => { document.title = \"    \"; }, []);\r\n  const card = \"bg-white rounded-2xl shadow-sm p-4 lg:p-6\";\r\n  const labelCls = \"block text-xs text-gray-500 mb-1\";\r\n  const sectionTitle = \"text-base font-semibold whitespace-nowrap\";\r\n  const calcMode = pos === \" \" ? \"IGNORE_AB\" : abModePrimary;\r\n  const tgtALabel = `  A  `;\r\n  const tgtBLabel = `  B  `;\r\n  const rateText = manual.costAddRate === 1 ? \"+100%\" : manual.costAddRate === -1 ? \"-100%\" : \"0%\";\r\n  const allLocked = basicLocked && curLocked && tgtLocked;\r\n  const hasDup = hasDuplicateLabels(manLabels);\r\n  const showEffectsUI = true;\r\n  const showSkeleton = useMemo(\r\n    () => curValid && (isComputing || !(resultRun && resultStop)),\r\n    [curValid, isComputing, resultRun, resultStop]\r\n  );\r\n  const actionDisabled = !allLocked || hasDup || !!changeMode || manual.attemptsLeft <= 0;\r\n  const rerollDisabled = !allLocked || !!changeMode || manual.attemptsLeft <= 0 || manual.rerolls <= 0;\r\n  const dupWarnShown = useRef(false);\r\n  // allLocked false  logs \r\n  useEffect(() => {\r\n    if (!allLocked) {\r\n      setLogs([]);   //   \r\n      setHistory({ past: [], future: [] }); //    \r\n    }\r\n  }, [allLocked]);\r\n  useEffect(() => {\r\n    if (hasDup) {\r\n      if (!dupWarnShown.current) {\r\n        push(\"  . .\");\r\n        dupWarnShown.current = true;\r\n      }\r\n    } else {\r\n      dupWarnShown.current = false;\r\n    }\r\n  }, [hasDup, push]);\r\n  const targetPool = useMemo(() => {\r\n    const base = allowedEffectNames(gemKey, pos);\r\n    if (pos === \" \") return base;\r\n    return abModePrimary === \"ANY_ONE\" ? [\"\", ...base] : base; // BOTH '' \r\n  }, [gemKey, pos, abModePrimary]);\r\n  return (\r\n    <div className=\"min-h-screen text-gray-900 p-4 lg:p-6\" style={{ backgroundImage: \"linear-gradient(125deg, #85d8ea, #a399f2)\", backgroundAttachment: \"fixed\" }}>\r\n      <style>{`\r\n        :root{ --primary:#a399f2; --grad:linear-gradient(125deg,#85d8ea,#a399f2); }\r\n        .text-primary{ color:#a399f2; }\r\n        .accent-primary{ accent-color:#a399f2; }\r\n      `}</style>\r\n      <div className=\"max-w-6xl mx-auto space-y-4 lg:space-y-6\">\r\n        <section className=\"py-2 lg:py-3\">\r\n          <div className=\"flex items-center justify-between gap-3 flex-wrap\">\r\n            <h1 className=\"text-xl lg:text-2xl font-bold leading-tight text-white drop-shadow text-center lg:text-left w-full lg:w-auto\">\r\n                   \r\n            </h1>\r\n            <div className=\"flex gap-2 w-auto ml-auto lg:ml-0 items-center\">\r\n              <span className=\"hidden sm:inline text-white/90 text-sm\"> </span>\r\n              <div className=\"min-w-[170px]\">\r\n                <Dropdown\r\n                  value={simTrials}\r\n                  onChange={setSimTrials}\r\n                  items={SIM_OPTIONS}\r\n                  placeholder=\"  \"\r\n                  bordered={false}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        {/* 1)   */}\r\n        {/* 1)   */}\r\n        <section className={`${card} !mt-2`}>\r\n          <div className=\"flex items-center gap-2\">\r\n            <h2 className={sectionTitle}> </h2>\r\n            {/*  : /  (LoACoreOptimizer ) */}\r\n            <div className=\"ml-auto flex items-center gap-2\">\r\n              {basicLocked ? (\r\n                <>\r\n                  <span className=\"text-xs text-gray-500 hidden sm:inline\"> ( )</span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setBasicLocked(false)}\r\n                    className=\"h-10 px-3 rounded-xl border bg-white hover:bg-white/90 inline-flex items-center gap-2 text-sm\"\r\n                  >\r\n                    <Edit3 size={16} />\r\n                    \r\n                  </button>\r\n                </>\r\n              ) : (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setBasicLocked(true)}\r\n                  className=\"h-10 px-3 rounded-xl border bg-white hover:bg-white/90 inline-flex items-center gap-2 text-sm\"\r\n                >\r\n                  <Save size={16} />\r\n                  \r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n          {/*    // */}\r\n          <div className=\"mt-3\">\r\n            <div\r\n              className=\"\r\n    relative \r\n    grid grid-cols-2 gap-2 \r\n    lg:flex lg:flex-row lg:flex-nowrap lg:gap-3 \r\n    items-stretch lg:items-end \r\n    border rounded-xl p-3 bg-white overflow-visible\r\n  \"\r\n            >\r\n              {/*   */}\r\n              <div className={`flex flex-col w-full lg:w-[160px] w-full lg:w-56 ${basicLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> </label>\r\n                <Dropdown\r\n                  className=\"w-full\"\r\n                  value={gemKey}\r\n                  onChange={(v) => setGemKey(v)}\r\n                  items={Object.keys(GEM_TYPES).map((k) => ({ value: k, label: k }))}\r\n                  placeholder=\" \"\r\n                  disabled={basicLocked}\r\n                />\r\n              </div>\r\n              {/*  */}\r\n              <div className={`flex flex-col w-full lg:w-[120px] w-full lg:w-40 ${basicLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}></label>\r\n                <Dropdown\r\n                  className=\"w-full\"\r\n                  value={rarity}\r\n                  onChange={(v) => setRarity(v)}\r\n                  items={[\"\", \"\", \"\"].map((k) => ({ value: k, label: k }))}\r\n                  placeholder=\"\"\r\n                  disabled={basicLocked}\r\n                />\r\n              </div>\r\n              {/* /   */}\r\n              <div className=\"flex flex-col w-full col-span-2 lg:col-span-1 lg:w-auto\">\r\n                <label className={labelCls}> /  </label>\r\n                <div className=\"h-10 px-3 rounded-xl border bg-gray-50 inline-flex items-center text-sm\">\r\n                    <b className=\"mx-1\">{RARITY_ATTEMPTS[rarity]}</b>    {\" \"}\r\n                  <b className=\"ml-1\">{RARITY_BASE_REROLLS[rarity]}</b>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        {/* 2)   */}\r\n        <section className={card}>\r\n          <div className=\"flex items-center gap-2\">\r\n            <h2 className={sectionTitle}>  </h2>\r\n            <div className=\"ml-auto flex items-center gap-2\">\r\n              {curLocked ? (\r\n                <>\r\n                  <span className=\"text-xs text-gray-500 hidden sm:inline\">\r\n                     ( )\r\n                  </span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setCurLocked(false)}\r\n                    className=\"h-10 px-3 rounded-xl border bg-white hover:bg-white/90 inline-flex items-center gap-2 text-sm\"\r\n                  >\r\n                    <Edit3 size={16} />\r\n                    \r\n                  </button>\r\n                </>\r\n              ) : (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setCurLocked(true)}\r\n                  className=\"h-10 px-3 rounded-xl border bg-white hover:bg-white/90 inline-flex items-center gap-2 text-sm\"\r\n                >\r\n                  <Save size={16} />\r\n                  \r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n          {/* 2)       (/   ) */}\r\n          <div className=\"mt-3\">\r\n            <div className=\"\r\n  relative \r\n  grid grid-cols-2 gap-2 \r\n  lg:flex lg:flex-row lg:flex-nowrap lg:gap-3 \r\n  items-stretch lg:items-end \r\n  border rounded-xl p-3 bg-white overflow-visible\r\n\">\r\n              {/*   */}\r\n              <div className={`flex flex-col w-full lg:w-[120px] ${curLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> </label>\r\n                <NumberInput\r\n                  value={cur.eff}\r\n                  set={(v) => setCur({ ...cur, eff: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                  min={MIN_STAT}\r\n                  max={MAX_STAT}\r\n                  disabled={curLocked}\r\n                />\r\n              </div>\r\n              {/*  */}\r\n              <div className={`flex flex-col w-full lg:w-[120px] ${curLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}></label>\r\n                <NumberInput\r\n                  value={cur.pts}\r\n                  set={(v) => setCur({ ...cur, pts: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                  min={MIN_STAT}\r\n                  max={MAX_STAT}\r\n                  disabled={curLocked}\r\n                />\r\n              </div>\r\n              {/*  A */}\r\n              <div className={`flex flex-col w-full lg:w-[160px] ${curLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> A</label>\r\n                <Select\r\n                  value={cur.aName}\r\n                  set={(v) => setCur({ ...cur, aName: v })}\r\n                  options={effectPoolByPos}\r\n                  disabled={curLocked}\r\n                  placeholder={curLocked ? \"\" : undefined}\r\n                />\r\n              </div>\r\n              {/* A  */}\r\n              <div className={`flex flex-col w-full lg:w-[120px] ${curLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> A </label>\r\n                <NumberInput\r\n                  value={cur.aLvl}\r\n                  set={(v) => setCur({ ...cur, aLvl: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                  min={MIN_STAT}\r\n                  max={MAX_STAT}\r\n                  disabled={curLocked}\r\n                />\r\n              </div>\r\n              {/*  B */}\r\n              <div className={`flex flex-col w-full lg:w-[160px] ${curLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> B</label>\r\n                <Select\r\n                  value={cur.bName}\r\n                  set={(v) => setCur({ ...cur, bName: v })}\r\n                  options={effectPoolByPos.filter((n) => n !== cur.aName)}\r\n                  disabled={curLocked}\r\n                  placeholder={curLocked ? \"\" : undefined}\r\n                />\r\n              </div>\r\n              {/* B  */}\r\n              <div className={`flex flex-col w-full lg:w-[120px] ${curLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> B </label>\r\n                <NumberInput\r\n                  value={cur.bLvl}\r\n                  set={(v) => setCur({ ...cur, bLvl: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                  min={MIN_STAT}\r\n                  max={MAX_STAT}\r\n                  disabled={curLocked}\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </section>\r\n        {/* 3)       (/ LoACore ) */}\r\n        <section className={card}>\r\n          <div className=\"flex items-center gap-2\">\r\n            <h2 className={sectionTitle}>  </h2>\r\n            {/*   : '  ' /    */}\r\n            <div className=\"ml-auto flex items-center gap-3 flex-wrap\">\r\n              {/* /   () */}\r\n              {tgtLocked ? (\r\n                <>\r\n                  <span className=\"text-xs text-gray-500 hidden sm:inline\"> ( )</span>\r\n                  <button\r\n                    type=\"button\"\r\n                    onClick={() => setTgtLocked(false)}\r\n                    className=\"h-10 px-3 rounded-xl border bg-white hover:bg-white/90 inline-flex items-center gap-2 text-sm\"\r\n                  >\r\n                    <Edit3 size={16} />\r\n                    \r\n                  </button>\r\n                </>\r\n              ) : (\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setTgtLocked(true)}\r\n                  className=\"h-10 px-3 rounded-xl border bg-white hover:bg-white/90 inline-flex items-center gap-2 text-sm\"\r\n                >\r\n                  <Save size={16} />\r\n                  \r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div className={`mb-1 flex items-center gap-4 text-sm ${tgtLocked || pos === \" \" ? \"opacity-50\" : \"\"}`}>\r\n            <span className=\"text-xs text-gray-500\">  </span>\r\n            <label className=\"inline-flex items-center gap-2\">\r\n              <input\r\n                type=\"radio\"\r\n                checked={abModePrimary === \"ANY_ONE\"}\r\n                onChange={() => setAbModePrimary(\"ANY_ONE\")}\r\n                disabled={tgtLocked || pos === \" \"}\r\n                className=\"accent-primary\"\r\n              />\r\n              1 \r\n            </label>\r\n            <label className=\"inline-flex items-center gap-2\">\r\n              <input\r\n                type=\"radio\"\r\n                checked={abModePrimary === \"BOTH\"}\r\n                onChange={() => setAbModePrimary(\"BOTH\")}\r\n                disabled={tgtLocked || pos === \" \"}\r\n                className=\"accent-primary\"\r\n              />\r\n              2\r\n            </label>\r\n          </div>\r\n          {/* LoACore       */}\r\n          <div className=\"mt-3\">\r\n            <div className=\"\r\n  relative\r\n  grid grid-cols-2 gap-2\r\n  lg:flex lg:flex-row lg:flex-nowrap lg:gap-3\r\n  items-stretch lg:items-end\r\n  border rounded-xl p-3 bg-white overflow-visible\r\n\">\r\n              {/*    */}\r\n              <div className={`flex flex-col w-full lg:w-[120px] lg:flex-none ${tgtLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}>  </label>\r\n                <NumberInput\r\n                  value={tgt.eff}\r\n                  set={(v) => setTgt({ ...tgt, eff: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                  min={MIN_STAT}\r\n                  max={MAX_STAT}\r\n                  disabled={tgtLocked}\r\n                />\r\n              </div>\r\n              {/*   */}\r\n              <div className={`flex flex-col w-full lg:w-[120px] lg:flex-none ${tgtLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> </label>\r\n                <NumberInput\r\n                  value={tgt.pts}\r\n                  set={(v) => setTgt({ ...tgt, pts: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                  min={MIN_STAT}\r\n                  max={MAX_STAT}\r\n                  disabled={tgtLocked}\r\n                />\r\n              </div>\r\n              {/*     col-span-2 */}\r\n              <div className={`flex flex-col w-full col-span-2 lg:col-span-1 lg:w-[100px] ${tgtLocked ? \"opacity-50\" : \"\"}`}>\r\n                <label className={labelCls}> </label>\r\n                <Dropdown\r\n                  className=\"w-full lg:w-[100px]\"\r\n                  value={pos}\r\n                  onChange={(v) => setPos(v)}\r\n                  items={[\" \", \"\", \"\"].map(k => ({ value: k, label: k }))}\r\n                  placeholder=\" \"\r\n                  disabled={tgtLocked}\r\n                />\r\n              </div>\r\n              {(() => {\r\n                const effectsDisabled = tgtLocked || pos === \" \";\r\n                const bLevelDisabled = effectsDisabled || abModePrimary !== \"BOTH\";\r\n                const effCls = effectsDisabled ? \"opacity-50\" : \"\";\r\n                const effClsB = bLevelDisabled ? \"opacity-50\" : \"\";\r\n                return (\r\n                  <>\r\n                    {/*   A */}\r\n                    <div className={`w-full lg:w-[160px] flex flex-col ${tgtLocked || pos === \" \" ? \"opacity-50\" : \"\"}`}>\r\n                      <label className={labelCls}>  A</label>\r\n                      <Select\r\n                        value={tgtNames.aName}\r\n                        set={(v) => setTgtNames((t) => ({ ...t, aName: v }))}\r\n                        options={abModePrimary === \"BOTH\"\r\n                          ? targetPool.filter((n) => n !== tgtNames.bName)\r\n                          : targetPool}\r\n                        disabled={tgtLocked || pos === \" \"}\r\n                      />\r\n                    </div>\r\n                    {/* A   */}\r\n                    <div className={`flex flex-col w-full lg:w-[120px] lg:flex-none ${effCls}`}>\r\n                      <label className={labelCls}>{tgtALabel}</label>\r\n                      <NumberInput\r\n                        value={tgt.aLvl}\r\n                        set={(v) => setTgt({ ...tgt, aLvl: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                        min={MIN_STAT}\r\n                        max={MAX_STAT}\r\n                        disabled={effectsDisabled}\r\n                      />\r\n                    </div>\r\n                    {/*   B (BOTH  ) */}\r\n                    <div className={`w-full lg:w-[160px] flex flex-col ${(tgtLocked || pos === \" \" || abModePrimary !== \"BOTH\") ? \"opacity-50\" : \"\"}`}>\r\n                      <label className={labelCls}>  B</label>\r\n                      <Select\r\n                        value={tgtNames.bName}\r\n                        set={(v) => setTgtNames((t) => ({ ...t, bName: v }))}\r\n                        options={abModePrimary === \"BOTH\"\r\n                          ? targetPool.filter((n) => n !== tgtNames.aName)\r\n                          : targetPool}\r\n                        disabled={tgtLocked || pos === \" \" || abModePrimary !== \"BOTH\"}\r\n                      />\r\n                    </div>\r\n                    {/* B   */}\r\n                    <div className={`flex flex-col w-full lg:w-[120px] lg:flex-none ${effClsB}`}>\r\n                      <label className={labelCls}>{tgtBLabel}</label>\r\n                      <NumberInput\r\n                        value={tgt.bLvl}\r\n                        set={(v) => setTgt({ ...tgt, bLvl: clamp(v, MIN_STAT, MAX_STAT) })}\r\n                        min={MIN_STAT}\r\n                        max={MAX_STAT}\r\n                        disabled={bLevelDisabled}\r\n                      />\r\n                    </div>\r\n                  </>\r\n                );\r\n              })()}\r\n            </div>\r\n          </div>\r\n        </section>\r\n        <div className=\"mt-3 grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6\">\r\n          {/* 4)   */}\r\n          <section ref={simRef} className={`lg:col-span-2 ` + card}>\r\n            {/*  +   */}\r\n            <div className=\"flex items-center gap-2\">\r\n              <h2 className={sectionTitle}> </h2>\r\n              <div className=\"ml-auto flex items-center gap-2\">\r\n                <button\r\n                  onClick={manualReset}\r\n                  className=\"h-10 px-3 rounded-xl border bg-white hover:bg-white/90 inline-flex items-center gap-2 text-sm\"\r\n                >\r\n                  <RotateCcw size={16} />\r\n                   \r\n                </button>\r\n              </div>\r\n            </div>\r\n            {/*    */}\r\n            <div className=\"mt-1 text-xs text-gray-500\">\r\n                /    <b>  ()</b>  .\r\n            </div>\r\n            <div className=\"mt-3 gap-4\">\r\n              {/* : /( ) */}\r\n              <div className=\"rounded-xl border p-3 bg-white\">\r\n                <div className=\"text-sm font-semibold mb-2\">  </div>\r\n                {/*    4 */}\r\n                <div className=\"grid grid-cols-4 gap-2 text-sm\">\r\n                  <div className=\"rounded-xl border p-2 text-center flex flex-col items-center justify-center col-span-2\">\r\n                    <div className=\"text-xs text-gray-500\"> </div>\r\n                    <div className=\"text-lg font-semibold\">{manual.state.eff}</div>\r\n                  </div>\r\n                  <div className=\"rounded-xl border p-2 text-center flex flex-col items-center justify-center col-span-2\">\r\n                    <div className=\"text-xs text-gray-500\"> </div>\r\n                    <div className=\"text-lg font-semibold\">{manual.state.pts}</div>\r\n                  </div>\r\n                  {showEffectsUI && (\r\n                    <div className=\"rounded-xl border p-2 text-center flex flex-col items-center justify-center col-span-2\">\r\n                      {changeMode?.who === \"A\" ? (\r\n                        <>\r\n                          <div className=\"w-full\">\r\n                            <Select\r\n                              value={changePick}\r\n                              set={setChangePick}\r\n                              options={changeMode.options}\r\n                            />\r\n                          </div>\r\n                          <div className=\"mt-2 flex gap-2 w-full\">\r\n                            <button onClick={confirmEffectChange}\r\n                              className=\"h-9 px-3 rounded-xl bg-[#a399f2] text-white hover:bg-[#a399f2] w-[50%]\">\r\n                              \r\n                            </button>\r\n                            <button onClick={cancelEffectChange}\r\n                              className=\"h-9 px-3 rounded-xl border bg-white hover:bg-gray-50 w-[50%]\">\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <div className=\"text-xs text-gray-500\">{manual.state.aName}</div>\r\n                          <div className=\"text-lg font-semibold\">Lv. {manual.state.aLvl}</div>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                  {showEffectsUI && (\r\n                    <div className=\"rounded-xl border p-2 text-center flex flex-col items-center justify-center col-span-2\">\r\n                      {changeMode?.who === \"B\" ? (\r\n                        <>\r\n                          <div className=\"w-full\">\r\n                            <Select\r\n                              value={changePick}\r\n                              set={setChangePick}\r\n                              options={changeMode.options}\r\n                            />\r\n                          </div>\r\n                          <div className=\"mt-2 flex gap-2 w-full\">\r\n                            <button onClick={confirmEffectChange}\r\n                              className=\"h-9 px-3 rounded-xl bg-[#a399f2] text-white hover:bg-[#a399f2] w-[50%]\">\r\n                              \r\n                            </button>\r\n                            <button onClick={cancelEffectChange}\r\n                              className=\"h-9 px-3 rounded-xl border bg-white hover:bg-gray-50 w-[50%]\">\r\n                              \r\n                            </button>\r\n                          </div>\r\n                        </>\r\n                      ) : (\r\n                        <>\r\n                          <div className=\"text-xs text-gray-500\">{manual.state.bName}</div>\r\n                          <div className=\"text-lg font-semibold\">Lv. {manual.state.bLvl}</div>\r\n                        </>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                {/*   */}\r\n                <div className=\"mt-3 flex flex-wrap gap-2 text-[12px] lg:text-[13px]\">\r\n                  {manual.attemptsLeft <= 0 ? (\r\n                    <div className=\"inline-flex items-center px-2.5 py-1.5 rounded-xl bg-violet-50 border border-violet-200 text-violet-900 text-[12px] lg:text-[13px]\">\r\n                       .\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"flex flex-wrap gap-2 text-[12px] lg:text-[13px]\">\r\n                      <div className=\"px-2.5 py-1.5 rounded-xl bg-gray-100 border\">\r\n                           <b className=\"ml-1\">{manual.attemptsLeft}</b>\r\n                      </div>\r\n                      <div className=\"px-2.5 py-1.5 rounded-xl bg-gray-100 border\">\r\n                           <b className=\"ml-1\">{manual.rerolls}</b>\r\n                      </div>\r\n                      <div className=\"px-2.5 py-1.5 rounded-xl bg-gray-100 border\">\r\n                            <b className=\"ml-1\">{rateText}</b>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"px-2.5 py-1.5 rounded-xl bg-gray-100 border\">\r\n                      <b className=\"ml-1\">{fmtNum(manual.gold)}</b> G\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              {/* :  +  */}\r\n              <div className=\"rounded-xl border p-3 bg-white mt-4\">\r\n                <div className=\"text-sm font-semibold mb-2\">  4 </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\r\n                  {manLabels.map((label, idx) => (\r\n                    <div key={idx} className=\"slot-card rounded-xl border p-2 transition-all\">\r\n                      <div className=\"text-xs text-gray-500 mb-1\"> {idx + 1}</div>\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <Select\r\n                          value={label}\r\n                          set={(v) => {\r\n                            const ns = [...manLabels];\r\n                            ns[idx] = v;\r\n                            setManLabels(ns);\r\n                          }}\r\n                          options={allOptionLabels}\r\n                        />\r\n                        <button\r\n                          onClick={() => applyManual(idx)}\r\n                          aria-disabled={actionDisabled}\r\n                          className={`apply-btn transition-all justify-center min-w-[60px] h-10 px-3 rounded-xl border bg-white \r\n                          hover:border-[#a399f2] hover:text-white hover:bg-[#a399f2] inline-flex items-center\r\n                          ${actionDisabled ? \"opacity-50 cursor-not-allowed\" : \"\"} \r\n                          ${hasDup ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\r\n                        >\r\n                          \r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n                <div className=\"mt-3 flex items-center gap-2 flex-wrap\">\r\n                  <button onClick={doReroll} disabled={rerollDisabled}\r\n                    className={`h-10 px-3 rounded-xl border ${rerollDisabled ? \"opacity-50 cursor-not-allowed\" : \"bg-white hover:bg-gray-50\"} inline-flex items-center gap-2`}>\r\n                    <RefreshCcw size={16} />\r\n                       {manual.rerolls}\r\n                  </button>\r\n                  <span className=\"text-xs text-gray-600\">\r\n                    {manual.attemptsLeft <= 0\r\n                      ? \" \"\r\n                      : !manual.unlocked\r\n                        ? \"   .\"\r\n                        : manual.rerolls <= 0\r\n                          ? \"   \"\r\n                          : (rerollAdvice.shouldReroll ? \"   \" : \"   \")}\r\n                  </span>\r\n                </div>\r\n                {manual.unlocked && manual.rerolls > 0 && (\r\n                  <div className=\"mt-2 text-xs text-gray-700\">{rerollAdvice.reason}</div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </section>\r\n          {/* 6)   */}\r\n          <section\r\n            className={`${card} h-full flex flex-col`}\r\n            style={logsMax ? { maxHeight: logsMax } : undefined}\r\n          >\r\n            <div className=\"flex items-center gap-2\">\r\n              <h2 className={sectionTitle}> </h2>\r\n              <div className=\"ml-auto flex items-center gap-2\">\r\n                <button\r\n                  onClick={undo}\r\n                  disabled={!canUndo}\r\n                  className={`ml-auto h-10 px-3 rounded-xl border ${!canUndo ? \"opacity-50 cursor-not-allowed\" : \"bg-white hover:bg-gray-50\"} inline-flex items-center gap-2 text-sm`}\r\n                  title=\" (Ctrl/Cmd+Z)\"\r\n                >\r\n                  <Undo2 size={16} />\r\n                </button>\r\n                <button\r\n                  onClick={redo}\r\n                  disabled={!canRedo}\r\n                  className={`h-10 px-3 rounded-xl border ${!canRedo ? \"opacity-50 cursor-not-allowed\" : \"bg-white hover:bg-gray-50\"} inline-flex items-center gap-2 text-sm`}\r\n                  title=\" (Ctrl/Cmd+Shift+Z)\"\r\n                >\r\n                  <Redo2 size={16} />\r\n                </button>\r\n              </div>\r\n            </div>\r\n            {logs.length === 0 ? (\r\n              <div className=\"mt-3 text-sm text-gray-500\"> .</div>\r\n            ) : (\r\n              <div className=\"mt-3 flex-1 min-h-0 space-y-2 overflow-auto\">\r\n                {logs.map((l) => (\r\n                  <div key={l.id} className=\"rounded-xl border p-2 bg-white\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"text-sm font-medium\">\r\n                        {l.title}\r\n                      </div>\r\n                      <span className=\"text-[11px] text-gray-500\">{l.time}</span>\r\n                    </div>\r\n                    {l.detail && (\r\n                      <div className=\"mt-1 text-xs text-gray-700\">{l.detail}</div>\r\n                    )}\r\n                    {l.meta && (\r\n                      <div className=\"mt-1 flex flex-wrap gap-1.5 text-[11px] text-gray-600\">\r\n                        {'cost' in l.meta && (\r\n                          <span className=\"px-1.5 py-0.5 rounded-lg border bg-gray-50\">\r\n                             {fmtNum(l.meta.cost)} G\r\n                          </span>\r\n                        )}\r\n                        {'attemptsLeft' in l.meta && (\r\n                          <span className=\"px-1.5 py-0.5 rounded-lg border bg-gray-50\">\r\n                              {l.meta.attemptsLeft}\r\n                          </span>\r\n                        )}\r\n                        {'rerollDelta' in l.meta && l.meta.rerollDelta !== 0 && (\r\n                          <span className=\"px-1.5 py-0.5 rounded-lg border bg-gray-50\">\r\n                               {l.meta.rerollDelta > 0 ? `+${l.meta.rerollDelta}` : l.meta.rerollDelta}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </section>\r\n        </div>\r\n        {/* 5)   */}\r\n        <section className={card}>\r\n          <div className=\"flex items-center gap-2\">\r\n            <h2 className={sectionTitle}> </h2>\r\n            <div className=\"ml-auto flex items-center gap-2\">\r\n              <span className=\"px-2.5 py-1.5 rounded-xl bg-gray-100 text-[10px] lg:text-xs text-gray-600\">\r\n                Monte Carlo {fmtNum(Math.max(resultRun?.trialsUsed || 0, resultStop?.trialsUsed || 0))}\r\n                {resultRun?.ci?.halfWidth\r\n                  ? ` (${(resultRun.ci.halfWidth * 100).toFixed(2)}%p @95%)`\r\n                  : \"\"}\r\n              </span>\r\n            </div>\r\n          </div>\r\n          {/*    :  /    */}\r\n          {showSkeleton ? (\r\n            <div className=\"mt-3 space-y-3\">\r\n              {/*   */}\r\n              <div className=\"text-xs text-gray-500 mb-1\">   1 </div>\r\n              <div className=\"flex flex-wrap gap-1.5\">\r\n                {[...Array(4)].map((_, i) => (\r\n                  <div\r\n                    key={i}\r\n                    className=\"h-6 w-28 rounded-lg bg-gray-100 animate-pulse\"\r\n                  />\r\n                ))}\r\n              </div>\r\n              {/*   (2) */}\r\n              <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-3 mt-2\">\r\n                {[0, 1].map((k) => (\r\n                  <div key={k} className=\"rounded-xl border p-3 bg-white\">\r\n                    <div className=\"h-4 w-32 bg-gray-100 rounded animate-pulse\" />\r\n                    <div className=\"mt-3 h-8 w-2/3 bg-gray-100 rounded animate-pulse\" />\r\n                    <div className=\"mt-2 h-2 w-full bg-gray-100 rounded animate-pulse\" />\r\n                    <div className=\"mt-4 h-4 w-40 bg-gray-100 rounded animate-pulse\" />\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {/*    UI:       */}\r\n              <div className=\"mt-2 text-sm text-gray-700\">\r\n                <div className=\"text-xs text-gray-500 mb-1\">   1 </div>\r\n                <div className=\"flex flex-wrap gap-1.5\">\r\n                  {manLabels.map((l, i) => (\r\n                    <span\r\n                      key={i}\r\n                      className=\"inline-flex items-center gap-1 px-2.5 py-1 rounded-lg border bg-white text-[12px]\"\r\n                    >\r\n                      {l}\r\n                    </span>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n              {resultRun && resultStop && (\r\n                <div className=\"mt-3 grid grid-cols-1 lg:grid-cols-2 gap-3\">\r\n                  {/*    */}\r\n                  <motion.div\r\n                    initial={{ opacity: 0, y: 6 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ duration: .18 }}\r\n                    className=\"rounded-xl border p-3 bg-white\"\r\n                  >\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"text-sm font-semibold flex items-center gap-2\">\r\n                          \r\n                      </div>\r\n                      <span className=\"px-2 py-1 rounded-lg bg-gray-50 text-[11px] text-gray-600\">\r\n                        {calcMode === \"IGNORE_AB\"\r\n                          ? \"   \"\r\n                          : calcMode === \"ANY_ONE\"\r\n                            ? \"    1 \"\r\n                            : \"    2 \"}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2\">\r\n                      {/* STOP_ON_SUCCESS */}\r\n                      <div className=\"rounded-xl border p-3 bg-white/60 backdrop-blur-sm\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"text-xs text-gray-500\">\r\n                                ( {fmtNum(resultStop.successes)} / {fmtNum(resultStop.trialsUsed)} )\r\n                          </div>                        </div>\r\n                        <div className=\"mt-1 text-2xl font-bold\">\r\n                          {fmtProbSmart(resultStop.successProb, resultStop.ci)}\r\n                        </div>\r\n                        <div className=\"mt-2 w-full h-2 rounded-full bg-gray-100 overflow-hidden\">\r\n                          <motion.div\r\n                            initial={{ width: 0 }}\r\n                            animate={{ width: `${Math.round(resultStop.successProb * 100)}%` }}\r\n                            transition={{ type: \"spring\", stiffness: 260, damping: 28 }}\r\n                            className=\"h-full bg-gradient-to-r from-[#85d8ea] to-[#a399f2]\"\r\n                          />\r\n                        </div>\r\n                        {(() => {\r\n                          const gps = goldPerSuccess(resultStop.expectedGold, resultStop.successProb);\r\n                          const badge = burdenBadge(resultStop.successProb);\r\n                          return (\r\n                            <div className=\"mt-2 text-xs text-gray-700 flex items-center gap-2 flex-wrap\">\r\n                              <span>\r\n                                 1 <b></b>: <b>{Number.isFinite(gps) ? fmtNum(Math.round(gps)) : \"\"}</b> G\r\n                              </span>\r\n                              <span className={`px-2 py-0.5 rounded-lg border ${badge.tone}`}>\r\n                                : {badge.label}\r\n                              </span>\r\n                              <span className=\"text-[11px] text-gray-500\">\r\n                                (   )\r\n                              </span>\r\n                            </div>\r\n                          );\r\n                        })()}\r\n                      </div>\r\n                      {/* RUN_TO_END */}\r\n                      <div className=\"rounded-xl border p-3 bg-white/60 backdrop-blur-sm\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div className=\"text-xs text-gray-500\">\r\n                                ( {fmtNum(resultRun.successes)} / {fmtNum(resultRun.trialsUsed)} )\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"mt-1 text-2xl font-bold\">{fmtProb(resultRun.successProb)}</div>\r\n                        <div className=\"mt-2 w-full h-2 rounded-full bg-gray-100 overflow-hidden\">\r\n                          <motion.div\r\n                            initial={{ width: 0 }}\r\n                            animate={{ width: `${Math.round(resultRun.successProb * 100)}%` }}\r\n                            transition={{ type: \"spring\", stiffness: 260, damping: 28 }}\r\n                            className=\"h-full bg-gradient-to-r from-[#85d8ea] to-[#a399f2]\"\r\n                          />\r\n                        </div>\r\n                        {(() => {\r\n                          const gps = goldPerSuccess(resultRun.expectedGold, resultRun.successProb);\r\n                          const badge = burdenBadge(resultRun.successProb);\r\n                          return (\r\n                            <div className=\"mt-2 text-xs text-gray-700 flex items-center gap-2 flex-wrap\">\r\n                              <span>\r\n                                 1 <b></b>: <b>{Number.isFinite(gps) ? fmtNum(Math.round(gps)) : \"\"}</b> G\r\n                              </span>\r\n                              <span className={`px-2 py-0.5 rounded-lg border ${badge.tone}`}>\r\n                                : {badge.label}\r\n                              </span>\r\n                              <span className=\"text-[11px] text-gray-500\">\r\n                                (   )\r\n                              </span>\r\n                            </div>\r\n                          );\r\n                        })()}\r\n                      </div>\r\n                    </div>\r\n                  </motion.div>\r\n                  {/*   */}\r\n                  <motion.div\r\n                    initial={{ opacity: 0, y: 6 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ duration: .18, delay: .05 }}\r\n                    className=\"rounded-xl border p-3 bg-white\"\r\n                  >\r\n                    <div className=\"text-sm font-semibold flex items-center gap-2\">\r\n                       \r\n                    </div>\r\n                    {(() => {\r\n                      if (!resultRun) return null;\r\n                      //  0%   \r\n                      const grades = [\r\n                        { key: \"legendProb\", name: \" (4~15)\", p: Number(resultRun.legendProb || 0), grad: GRADE_GRADIENTS.legend },\r\n                        { key: \"relicProb\", name: \" (16~18)\", p: Number(resultRun.relicProb || 0), grad: GRADE_GRADIENTS.relic },\r\n                        { key: \"ancientProb\", name: \" (19+)\", p: Number(resultRun.ancientProb || 0), grad: GRADE_GRADIENTS.ancient },\r\n                      ];\r\n                      return (\r\n                        <div className=\"mt-3 space-y-3 text-sm\">\r\n                          {grades.map(g => (\r\n                            <div key={g.key}>\r\n                              <div className=\"flex items-center justify-between\">\r\n                                <span className=\"text-gray-700\">{g.name}</span>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  {/*  100%    */}\r\n                                  {isOneProb(g.p) && (\r\n                                    <span className=\"px-2 py-0.5 rounded-lg border bg-emerald-50 border-emerald-200 text-emerald-800 text-[11px]\">\r\n                                      \r\n                                    </span>\r\n                                  )}\r\n                                  <b>{fmtProb(g.p)}</b>\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"mt-1 w-full h-2 rounded-full bg-gray-100 overflow-hidden\">\r\n                                <motion.div\r\n                                  initial={{ width: 0 }}\r\n                                  animate={{ width: isOneProb(g.p) ? \"100%\" : pct(g.p) /* 0%  0% */ }}\r\n                                  transition={{ type: \"spring\", stiffness: 260, damping: 28 }}\r\n                                  className=\"h-full bg-gradient-to-r\"\r\n                                  style={{ backgroundImage: g.grad }}\r\n                                />\r\n                              </div>\r\n                            </div>\r\n                          ))}\r\n                        </div>\r\n                      );\r\n                    })()}\r\n                    {/*   : 0% , 100% ()   */}\r\n                    {(() => {\r\n                      const { order, comps } = rankGradeOrder(resultRun); //     0%  \r\n                      if (!order.length) return null;\r\n                      return (\r\n                        <div className=\"mt-2 rounded-xl bg-white/70\">\r\n                          <div className=\"text-xs text-gray-500 mb-1\">  </div>\r\n                          <div className=\"flex flex-wrap items-center gap-1.5\">\r\n                            {order.map((it, idx) => (\r\n                              <React.Fragment key={it.key}>\r\n                                <span className=\"inline-flex items-center gap-1 px-2.5 py-1 rounded-lg border bg-white shadow-sm\">\r\n                                  <span\r\n                                    className=\"inline-block w-2 h-2 rounded-full bg-gradient-to-r\"\r\n                                    style={{ backgroundImage: it.grad }}\r\n                                  />\r\n                                  <span className=\"text-sm\">\r\n                                    {it.label}{isOneProb(it.p) ? \" ()\" : \"\"}\r\n                                  </span>\r\n                                </span>\r\n                                {idx < order.length - 1 && (\r\n                                  <span className=\"mx-0.5 text-gray-400 select-none\">\r\n                                    {comps[idx] === \"=\" ? \"\" : \"\"}\r\n                                  </span>\r\n                                )}\r\n                              </React.Fragment>\r\n                            ))}\r\n                          </div>\r\n                        </div>\r\n                      );\r\n                    })()}\r\n                  </motion.div>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </section>\r\n      </div>\r\n      <ToastStack toasts={toasts} onClose={remove} />\r\n      <div className=\"mt-6\">\r\n        <KakaoAdfit />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport { HashRouter, Routes, Route, Navigate, NavLink } from \"react-router-dom\";\r\nimport LoACoreOptimizer from \"./components/LoACoreOptimizer\";\r\nimport GemSimulator from \"./components/GemSimulator\";\r\nimport { ChevronUp } from \"lucide-react\";\r\n/**\r\n * CoreOnly as pages via HashRouter\r\n * -  URL: #/core/gem, #/core/optimizer\r\n * -  : #/core/optimizer\r\n * -   NavLink ( role=\"navigation\")\r\n */\r\nfunction useNearBottom(offset = 520) {\r\n  const [near, setNear] = React.useState(false);\r\n  React.useEffect(() => {\r\n    const onScroll = () => {\r\n      const doc = document.documentElement;\r\n      const scrollBottom = doc.scrollHeight - (doc.scrollTop + window.innerHeight);\r\n      setNear(scrollBottom <= offset);\r\n    };\r\n    onScroll(); //   \r\n    window.addEventListener(\"scroll\", onScroll, { passive: true });\r\n    window.addEventListener(\"resize\", onScroll);\r\n    return () => {\r\n      window.removeEventListener(\"scroll\", onScroll);\r\n      window.removeEventListener(\"resize\", onScroll);\r\n    };\r\n  }, [offset]);\r\n  return near;\r\n}\r\nfunction TopFab() {\r\n  const visible = useNearBottom(520); //   520px  \r\n  return (\r\n    <div className=\"fixed z-50 right-4 bottom-4 sm:right-6 sm:bottom-6 pr-[env(safe-area-inset-right)] pb-[env(safe-area-inset-bottom)]\">\r\n      <button\r\n        type=\"button\"\r\n        aria-label=\" \"\r\n        onClick={() => window.scrollTo({ top: 0, behavior: \"smooth\" })}\r\n        className={[\r\n          \"inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white/90 px-4 py-3 shadow-lg backdrop-blur\",\r\n          \"text-gray-700 hover:bg-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#a399f2]/40\",\r\n          \"transition transform duration-200\",\r\n          visible ? \"opacity-100 translate-y-0\" : \"opacity-0 translate-y-2 pointer-events-none\",\r\n        ].join(\" \")}\r\n      >\r\n        <ChevronUp size={18} />\r\n        <span className=\"hidden sm:inline text-sm font-medium\">TOP</span>\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\nexport default function CoreOnly() {\r\n  return (\r\n    <HashRouter basename=\"/core\">\r\n      <div className=\"min-h-screen bg-gray-50 text-gray-900\">\r\n<header className=\"sticky top-0 z-40 border-b border-gray-200/60 bg-white/70 backdrop-blur\">\r\n  <div className=\"mx-auto max-w-6xl px-4 sm:px-6 py-3\">\r\n    <nav aria-label=\"Core pages\">\r\n      <ul className=\"mx-auto flex w-full flex-wrap justify-center gap-1 rounded-xl\">\r\n        <li>\r\n          <NavLink\r\n            to=\"/gem\"\r\n            className={({ isActive }) =>\r\n              [\r\n                \"px-4 py-2 text-sm font-medium rounded-lg transition\",\r\n                \"outline-none focus-visible:ring-2 focus-visible:ring-[#a399f2]/30\",\r\n                isActive\r\n                  ? \"bg-[#a399f2]/10 text-[#5b54c6]\" //   \r\n                  : \"text-gray-700 hover:bg-gray-50\"\r\n              ].join(\" \")\r\n            }\r\n          >\r\n              \r\n          </NavLink>\r\n        </li>\r\n        <li>\r\n          <NavLink\r\n            to=\"/optimizer\"\r\n            className={({ isActive }) =>\r\n              [\r\n                \"px-4 py-2 text-sm font-medium rounded-lg transition\",\r\n                \"outline-none focus-visible:ring-2 focus-visible:ring-[#a399f2]/30\",\r\n                isActive\r\n                  ? \"bg-[#a399f2]/10 text-[#5b54c6]\"\r\n                  : \"text-gray-700 hover:bg-gray-50\"\r\n              ].join(\" \")\r\n            }\r\n          >\r\n              \r\n          </NavLink>\r\n        </li>\r\n      </ul>\r\n    </nav>\r\n  </div>\r\n</header>\r\n        {/*   */}\r\n        <main>\r\n          <Routes>\r\n            <Route path=\"/gem\" element={<GemSimulator />} />\r\n            <Route path=\"/optimizer\" element={<LoACoreOptimizer />} />\r\n            {/*   : /core  /core/optimizer */}\r\n            <Route path=\"*\" element={<Navigate to=\"/gem\" replace />} />\r\n          </Routes>\r\n        </main>\r\n      </div>\r\n      <TopFab /> \r\n    </HashRouter>\r\n  );\r\n}\r\n","import React, { useEffect, useRef } from 'react';\r\nfunction KakaoAdfit() {\r\n  const adRef = useRef(null);\r\n  useEffect(() => {\r\n    const ins = document.createElement('ins');\r\n    ins.className = 'kakao_ad_area';\r\n    ins.style.display = 'none';\r\n    ins.setAttribute('data-ad-unit', 'DAN-V4UQDzJ7BdEKoWll');\r\n    ins.setAttribute('data-ad-width', '320');\r\n    ins.setAttribute('data-ad-height', '50');\r\n    const script = document.createElement('script');\r\n    script.type = 'text/javascript';\r\n    script.async = true;\r\n    script.src = '//t1.daumcdn.net/kas/static/ba.min.js';\r\n    if (adRef.current) {\r\n      adRef.current.innerHTML = ''; //  \r\n      adRef.current.appendChild(ins);\r\n      adRef.current.appendChild(script);\r\n    }\r\n  }, []);\r\n  return <div ref={adRef} className=\"kakao-adfit-container\" />;\r\n}\r\nexport default KakaoAdfit;"],"names":["CORE_SUPPLY","HERO","LEGEND","RELIC","ANCIENT","CORE_THRESHOLDS","CORE_LABEL","GRADES","OPTION_LABELS","atk","add","boss","brand","allyDmg","allyAtk","OPTIONS","ROLE_KEYS","dealer","Set","support","DEFAULT_WEIGHTS","CORE_NAME_ITEMS","value","label","CATEGORY_LABEL","order","chaos","LS_KEY","CORE_ORDER","uid","Math","random","toString","slice","sanitizeWeights","w","base","Object","keys","forEach","k","raw","num","Number","isFinite","scoreGemForRole","g","role","_w$g$o1k","_w$g$o2k","has","o1k","o1v","o2k","o2v","combinations","arr","n","length","idx","Array","from","_","i","map","p","j","thresholdsHit","grade","totalPoint","filter","t","scoreCombo","combo","weights","totalWill","reduce","s","_g$will","will","_g$point","point","thr","roleSum","score","optimizeRoundRobinTargets","cores","pool","perCoreLimit","arguments","undefined","W","minOf","min","thresholdsOf","thrMax","ci","_ci$thr","max","emptyPick","list","enforcedIdx","c","enforceMin","candidatesFor","core","gemPool","minThreshold","supply","minOfGrade","effMin","effEnforce","all","maxPick","push","filtered","sort","a","b","maxThr","enumerateCoreCombos","ta","tb","allCandidates","trySolve","enforceSet","blockedSet","best","used","backtrack","pos","picksAcc","sumThrAcc","sumPointAcc","sumWillAcc","roleSumAcc","thrVec","ptVec","_cores$coreIdx$minThr","_cores$idx$minThresho","cand","picks","x","sumThr","sumPoint","sumWill","A","B","betterThan","coreIdx","isEnf","Infinity","candList","pick","clash","id","prev","delete","fill","enforcedSetFull","bestFull","lowestIdx","bestDropLowest","infeasibleEnforced","_cores$idx$minThresho2","indexOf","some","bestReduced","maskWeightsForRole","next","loadFromStorage","localStorage","getItem","JSON","parse","e","console","warn","dragPortal","document","body","PortalAwareDraggable","_ref","draggableId","index","children","_jsx","Draggable","provided","snapshot","rendered","isDragging","createPortal","Dropdown","_ref2","items","onChange","placeholder","className","open","setOpen","useState","btnRef","useRef","menuRef","menuPos","top","left","width","forceTick","useEffect","h","window","addEventListener","removeEventListener","refs","handler","refsArray","React","isArray","handlerRef","current","listener","_handlerRef$current","r","contains","target","call","useOnClickOutside","useLayoutEffect","rect","getBoundingClientRect","bottom","v","onScroll","_btnRef$current","passive","selected","find","menu","AnimatePresence","motion","ul","ref","initial","opacity","y","animate","exit","transition","duration","style","position","zIndex","it","type","onClick","disabled","String","_jsxs","ChevronUp","size","ChevronDown","ToastStack","_ref3","toasts","onClose","div","scale","stiffness","damping","msg","NumberInput","_ref4","step","allowFloat","zeroOnBlur","inputProps","toStr","inner","setInner","normalizeOnBlur","trunc","clamp","inputMode","onBlur","onWheel","currentTarget","blur","LoACoreOptimizer","title","category","setCategory","_loadFromStorage$cate","_loadFromStorage","coresByCat","setCoresByCat","_loaded$coresByCat","loaded","gemsByCat","setGemsByCat","_loaded$gemsByCat","setRole","setWeights","highlightCoreId","setHighlightCoreId","highlightGemId","setHighlightGemId","remove","setToasts","setTimeout","useToasts","calcVersion","setCalcVersion","computing","setComputing","stale","setStale","priorityPicks","setPriorityPicks","gems","setCores","updater","setGems","cancelled","clearTimeout","updateGem","patch","updateCore","cs","name","dragging","setDragging","smallFieldBase","sectionTitle","card","chip","labelCls","displayIndexCore","displayIndexGem","total","_w$brand","assert","gem","includes","cA","cB","log","runSelfTests","data","setItem","stringify","saveToStorage","backgroundImage","backgroundAttachment","addCore","nextName","existingNames","nextAvailableCoreName","Plus","DragDropContext","onDragStart","requestAnimationFrame","evt","Event","dispatchEvent","onDragEnd","result","destination","moved","splice","source","Droppable","droppableId","ignoreContainerClipping","innerRef","droppableProps","targetItems","concat","takenNames","coreNameItems","prov","_c$minThreshold","draggableProps","dragHandleProps","val","checked","htmlFor","moveCoreUp","moveCoreDown","removeCore","Trash2","addGem","removeGem","resetWeights","RotateCcw","hasResult","toFixed","_Fragment","_g$will2","_g$point2","gi","findIndex","disp","KakaoAdfit","USE_ANTITHETIC","AUTO_SCALE_RARE","hash32","str","charCodeAt","imul","makeDeterministicSeed","obj","makeRNG","seed","isZeroProb","isOneProb","GRADE","LEGEND_MIN","LEGEND_MAX","RELIC_MIN","RELIC_MAX","ANCIENT_MIN","GEM_TYPES","baseNeed","attack","RARITY_ATTEMPTS","","","","RARITY_BASE_REROLLS","MIN_STAT","MAX_STAT","GOLD_PER_ATTEMPT","lo","hi","fmtProbSmart","fmtProb","fmtNum","toLocaleString","goldPerSuccess","expectedGold","pct","round","burdenBadge","tone","estimateRate","successes","OFFICIAL_RNG","SIM_OPTIONS","zeroSuccessUpperBound","alpha","pow","epsilonByTrials","batchByTrials","allowedEffectNames","gemKey","totalScore","eff","pts","aLvl","bLvl","gradeOf","meetsTargetByMode","abMode","tgtNames","isAny","nm","TA","aName","TB","bName","match","lineName","lineLvl","targetName","lvlReq","okA","minusAppears_TABLE","buildWeightedItems","state","attemptsLeft","costAddRate","slot","kind","delta","names","canAChange","canBChange","mod","amount","slotToPrettyLabel","labelToSlot","parseInt","replace","trim","startsWith","applySlot","rngFn","rng","goldThisAttempt","nextRate","rerollDelta","floor","ZERO_VALUE","successProb","legendProb","relicProb","ancientProb","evaluateFromSimulation","start","policy","rerolls","unlockedReroll","selectedFirstFour","opts","maxTrials","epsilon","batch","minTrials","estimator","useAntithetic","autoScaleRare","rareTargetSuccesses","rareMaxTrials","rareTiers","desirability","sum","levelCostTo","curName","curLvl","targetLvl","POSITIVE_INFINITY","c1","c2","c11","c22","needDistanceByMode","simOnce","rand","weightedPickIndex","gold","rrs","unlocked","rate","first","temp","res","namesList","before","sl","gain","rrd","succSum","legendSum","relicSum","ancientSum","goldSum","agg","trialsUsed","low","high","halfWidth","localMaxTrials","forceRare","tiers","hardCap","nextTier","cur","firstTier","seedForTrial","baseSeed","updateCI","up","z","denom","center","margin","sqrt","wilsonCI","steps","trialSeed","one","r2base","two","r2","hw","GRADE_GRADIENTS","legend","relic","ancient","bordered","useMemo","toneBtn","success","info","warning","error","set","clampLocal","hasNewApi","callOld","Select","options","o","_o$value","_o$label","hasDuplicateLabels","labels","Boolean","GemSimulator","_resultRun$ci","setGemKey","setPos","rarity","setRarity","abModePrimary","setAbModePrimary","effectPoolAny","effectPoolByPos","setCur","tgt","setTgt","setTgtNames","basicLocked","setBasicLocked","curLocked","setCurLocked","tgtLocked","setTgtLocked","curValid","simTrials","setSimTrials","migratedRef","manual","setManual","m","changeMode","setChangeMode","changePick","setChangePick","history","setHistory","past","future","takeSnapshot","useCallback","restoreSnapshot","snap","pushHistory","nextPast","shift","canUndo","canRedo","logs","setLogs","nowStr","d","Date","pad","padStart","getHours","getMinutes","getSeconds","addLog","entry","time","undo","newPast","detail","redo","restFuture","onKey","ctrlKey","metaKey","key","toLowerCase","preventDefault","shiftKey","diffStats","after","parts","pushIf","join","old","bCand","allOptionLabels","defaultLabels","want","out","cursor","_allOptionLabels$curs","_ref5","_allOptionLabels$curs2","manLabels","setManLabels","_ref6","_allOptionLabels$i","replacement","l","resultStop","setResultStop","resultRun","setResultRun","isComputing","setIsComputing","tokenRef","timerRef","simRef","logsMax","setLogsMax","recalc","offsetHeight","TAU","expectedSuccessProbForLabels","gemKeyIn","posIn","abForEval","manualIn","tgtIn","acc","cnt","lb","nextManual","sampleNewFourSlots","slotsToLabels","slots","rerollAdvice","shouldReroll","reason","seedBase","salt","nowProb","afterRerollManual","newLabels","rerollProb","confirmEffectChange","allLocked","who","meta","cost","cancelEffectChange","bCandidate","calcMode","token","commonOpts","stop","run","rateText","hasDup","showSkeleton","actionDisabled","rerollDisabled","dupWarnShown","targetPool","Edit3","Save","effectsDisabled","bLevelDisabled","effCls","effClsB","ns","slotIdx","action","nextAttemptsLeft","applyManual","RefreshCcw","maxHeight","Undo2","Redo2","gps","badge","delay","grades","grad","comps","eps","diff","abs","rankGradeOrder","TopFab","visible","offset","near","setNear","doc","documentElement","scrollBottom","scrollHeight","scrollTop","innerHeight","useNearBottom","scrollTo","behavior","CoreOnly","HashRouter","basename","NavLink","to","isActive","Routes","Route","path","element","Navigate","adRef","ins","createElement","display","setAttribute","script","async","src","innerHTML","appendChild"],"sourceRoot":""}